{"version":3,"file":"settings.308b09340aaac177fa5f.js","sources":["webpack:///settings.308b09340aaac177fa5f.js"],"sourcesContent":["(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{1975:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();t.default=function(e){for(var t,a,i=arguments.length,l=Array(i>1?i-1:0),c=1;c<i;c++)l[c-1]=arguments[c];return t=function(t){function r(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,r);var t=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e));return a.call(t),t.state=e,t.shouldRender=!1,t}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(r,t),n(r,[{key:\"componentWillReceiveProps\",value:function(e){this.shouldRender=!1,this.updateState(e)}},{key:\"componentWillUnmount\",value:function(){this.updateState.cancel()}},{key:\"shouldComponentUpdate\",value:function(){return this.shouldRender}},{key:\"render\",value:function(){return o.default.createElement(e,this.state)}}]),r}(r.Component),a=function(){var e=this;this.updateState=s.default.apply(void 0,[function(t){e.shouldRender=!0,e.setState(t)}].concat(l))},t};var r=a(0),o=i(r),s=i(a(179));function i(e){return e&&e.__esModule?e:{default:e}}},1989:function(e,t,a){\"use strict\";var n=a(63).a.isFinite;t.a=function(e){return\"number\"==typeof e&&n(e)}},2010:function(e,t,a){\"use strict\";a.d(t,\"b\",function(){return m}),a.d(t,\"a\",function(){return h});var n=a(0),r=a.n(n),o=a(43),s=a(1975),i=a.n(s),l=a(45),c=a(31),u=a(24),p=a(40),d=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var m=function(e){return!!e&&!!e.get(\"id\")},h=function(e){var t,a,n=(a=t=function(t){function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,a),function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e))}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,r.a.Component),d(a,[{key:\"render\",value:function(){return m(this.props.currentAccount)?r.a.createElement(e,this.props):r.a.createElement(p.a,null)}}]),a}(),t.propTypes={currentAccount:o.a.ChainAccount},t.defaultProps={autosubscribe:!0},a);return n=Object(l.a)(n),n=i()(n,100,{leading:!1}),Object(c.a)(n,{listenTo:function(){return[u.a]},getProps:function(){var e=u.a.getState().currentAccount||u.a.getState().passwordAccount||\"please-login\";return{currentAccount:new Map([[\"name\",e]])}}})}},2054:function(e,t,a){\"use strict\";(function(e){var n=a(30),r=(a(14),a(15),a(94)),o=a(19),s=a(5),i=(a(161),a(78),function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}());var l=function(e,t){var a=null;switch(e){case\"sha256\":a=s.hash.sha256(t);break;case\"ripemd160\":a=s.hash.ripemd160(t);break;case\"sha1\":throw new Error(\"sha1 is not considered a secure hashing algorithm, plaase use sha256\");default:throw new Error(\"Wrong cipher name provided when creating htlc op\")}return a},c=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t)}return i(t,[{key:\"create\",value:function(e){var t=e.from_account_id,a=e.to_account_id,n=e.asset_id,s=e.amount,i=e.lock_time,c=e.preimage_cipher,u=e.preimage,p=void 0===u?null:u,d=e.preimage_hash,m=void 0===d?null:d,h=e.preimage_size,f=void 0===h?null:h,_=r.a.new_transaction(),g=function(e){var t=null;switch(e){case\"sha256\":t=2;break;case\"ripemd160\":t=0;break;case\"sha1\":throw new Error(\"sha1 is not considered a secure hashing algorithm, plaase use sha256\");default:throw new Error(\"Wrong cipher name provided when creating htlc op\")}return t}(c);if(p&&!m&&(m=l(c,p)),!f){if(!p)throw Error(\"Preimage must be given if size is empty\");f=p.length}return _.add_type_operation(\"htlc_create\",{from:t,to:a,fee:{amount:0,asset_id:\"1.3.0\"},amount:{amount:s,asset_id:n},preimage_hash:[g,m],preimage_size:f,claim_period_seconds:i}),function(e){return o.a.process_transaction(_,null,!0).then(function(){e(!0)}).catch(function(t){console.log(\"[HtlcActions.js:69] ----- htlc create error -----\\x3e\",t),e(!1)})}}},{key:\"redeem\",value:function(t){var a=t.htlc_id,n=t.user_id,s=t.preimage,i=r.a.new_transaction();return i.add_type_operation(\"htlc_redeem\",{preimage:new e(s).toString(\"hex\"),fee:{amount:0,asset_id:\"1.3.0\"},htlc_id:a,redeemer:n}),function(e){return o.a.process_transaction(i,null,!0).then(function(){e(!0)}).catch(function(t){console.log(\"[HtlcActions.js:98] ----- htlc redeem error -----\\x3e\",t),e(!1)})}}},{key:\"extend\",value:function(e){var t=e.htlc_id,a=e.user_id,n=e.seconds_to_add,s=r.a.new_transaction();return s.add_type_operation(\"htlc_extend\",{fee:{amount:0,asset_id:\"1.3.0\"},htlc_id:t,update_issuer:a,seconds_to_add:n}),function(e){return o.a.process_transaction(s,null,!0).then(function(){e(!0)}).catch(function(t){console.log(\"[HtlcActions.js:127] ----- htlc extend error -----\\x3e\",t),e(!1)})}}},{key:\"calculateHash\",value:function(t,a){var n=l(a,t),r=n.length;return{hash:new e(n).toString(\"hex\"),size:r}}},{key:\"getHTLCs\",value:function(){var e=function(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function n(r,o){try{var s=t[r](o),i=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(i).then(function(e){n(\"next\",e)},function(e){n(\"throw\",e)});e(i)}(\"next\")})}}(regeneratorRuntime.mark(function e(t){var a,n,r,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=[],n=1;case 2:if(!(n<300)){e.next=13;break}for(r=[],o=n;o<n+10;o++)r.push(\"1.16.\"+o);return i={},e.next=8,Object(s.FetchChainObjects)(s.ChainStore.getObject,r,void 0,i);case 8:e.sent.forEach(function(e){e&&((e=e.toJS()).transfer.to!=t&&e.transfer.from!=t||a.push(e))});case 10:n+=10,e.next=2;break;case 13:return e.abrupt(\"return\",a);case 14:case\"end\":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),t}();t.a=n.a.createActions(c)}).call(this,a(126).Buffer)},2220:function(e,t,a){},2222:function(e,t,a){\"use strict\";(function(e){var n=a(574),r=a(327),o=a(0),s=a.n(o),i=a(2),l=a.n(i),c=a(5),u=a(1949),p=a(24),d=a(270),m=a(37),h=a(152),f=a(2223),_=a(15),g=a(4),b=a.n(g),y=a(31),v=a(7),w=(a(29),a(233)),E=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var k=function(t){function a(t){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,a);var n=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t));return n.onSubmit=function(t){t.preventDefault();var a=n.state,r=a.from_account,o=a.to_account,s=a.feeAsset,i=a.permissionId,l=a.amount,c=a.asset,u=a.asset_id,p=a.memo;w.a.claimWithdrawPermission(i,r,o,u,_.a.convert_typed_to_satoshi(l,c),p?new e(p,\"utf-8\"):p,s?s.get(\"id\"):\"1.3.0\").then(function(e){n.props.hideModal()}).catch(function(e){n.setState({errorMessage:e})})},n.setTotalLimit=function(e){return function(){var t=n.state,a=t.asset,r=t.claimedAmount,o=_.a.get_asset_amount(e-r,a);n.setState({maxAmount:!0,amount:o},n.checkLimit)}},n.onAmountChanged=function(e){var t=e.amount,a=e.asset;a&&n.setState({amount:t,asset:a,asset_id:a.get(\"id\"),error:null,maxAmount:!1},n.checkLimit)},n.state=n.getInitialState(t),n._updateFee=Object(r.a)(n._updateFee.bind(n),250),n._checkFeeStatus=n._checkFeeStatus.bind(n),n._checkBalance=n._checkBalance.bind(n),n}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,s.a.Component),E(a,[{key:\"getInitialState\",value:function(){return{to_name:\"\",from_account:null,to_account:null,amount:\"\",asset_id:null,asset:null,memo:\"\",error:null,feeAsset:null,fee_asset_id:\"1.3.0\",feeAmount:new m.a({amount:0}),feeStatus:{},maxAmount:!1,permissionId:\"\",balanceError:!1,limitError:!1,firstPeriodError:!1,payerBalanceWarning:!1,withdrawal_limit:null,current_period_expires:\"\",claimedAmount:\"\",errorMessage:null}}},{key:\"componentDidUpdate\",value:function(e,t){var a=this.props,n=a.operation;if(a.isModalVisible&&n&&t.permissionId!==n.payload.id){var r=new Date(n.payload.period_start_time+\"Z\").getTime(),o=(new Date).getTime()-r,s=\"\",i=1e3*n.payload.withdrawal_period_sec;o<0?console.log(\"first period is not started\"):s=r+i*Math.ceil(o/i);var l=c.ChainStore.getAccount(n.payload.authorized_account,!1),u=c.ChainStore.getAccount(n.payload.withdraw_from_account,!1);this.setState({to_account:l,from_account:u,permissionId:n.payload.id,withdrawal_limit:n.payload.withdrawal_limit,claimedAmount:n.payload.claimed_this_period,current_period_expires_date:s,asset:c.ChainStore.getAsset(n.payload.withdrawal_limit.asset_id)},this._checkFeeStatus)}}},{key:\"_checkBalance\",value:function(){var e=this.state,t=e.feeAmount,a=e.from_account,n=e.asset;if(n&&a){this._updateFee();var r=a.getIn([\"balances\",n.get(\"id\")]),o=a.getIn([\"balances\",t.asset_id]);if(n&&a){if(!r)return this.setState({balanceError:!0});var s=c.ChainStore.getObject(r),i=o?c.ChainStore.getObject(o):null;if(i&&0!==i.get(\"balance\")||this.setState({fee_asset_id:\"1.3.0\"},this._updateFee),s&&t){var l=new m.a({real:s.get(\"balance\"),asset_id:n.get(\"id\"),precision:n.get(\"precision\")});l.minus(t);var u=l.getAmount({real:!0})>0;null!==u&&this.setState({balanceError:!u})}}}}},{key:\"_checkFeeStatus\",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state,a=t.from_account,n=this.props.isModalVisible;if(a&&n){var r=Object.keys(a.get(\"balances\").toJS()).sort(_.a.sortID),o={},s=[];r.forEach(function(e){s.push(Object(h.b)({accountID:a.get(\"id\"),feeID:e,type:\"withdraw_permission_claim\",options:[\"price_per_kbyte\"],data:{type:\"memo\",content:t.memo}}))}),Promise.all(s).then(function(t){r.forEach(function(e,a){o[e]=t[a]}),_.a.are_equal_shallow(e.state.feeStatus,o)||e.setState({feeStatus:o}),e._checkBalance()}).catch(function(e){console.error(e)})}}},{key:\"checkLimit\",value:function(){var e=this.state,t=e.withdrawal_limit,a=e.amount,n=e.limitError,r=e.asset,o=e.claimedAmount,s=_.a.get_asset_amount(t.amount-o,r);a>s&&!n?this.setState({limitError:!0}):a<=s&&n&&this.setState({limitError:!1})}},{key:\"_getAvailableAssets\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state,t=this.state.feeStatus;var a=e.from_account,n=[],r=[];if(!a||!a.get(\"balances\"))return{asset_types:n,fee_asset_types:r};var o=e.from_account.get(\"balances\").toJS();for(var s in n=Object.keys(o).sort(_.a.sortID),r=Object.keys(o).sort(_.a.sortID),o){var i=c.ChainStore.getObject(o[s]);i&&0===i.get(\"balance\")&&(n.splice(n.indexOf(s),1),-1!==r.indexOf(s)&&r.splice(r.indexOf(s),1))}return{asset_types:n,fee_asset_types:r=r.filter(function(e){return function(e){return void 0===t[e]||t[e]&&t[e].hasPoolBalance}(e)&&function(e){return void 0===t[e]||t[e]&&t[e].hasBalance}(e)})}}},{key:\"_updateFee\",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state;if(this.props.isModalVisible){var a=t.fee_asset_id,n=t.from_account,r=t.asset_id,o=this._getAvailableAssets(t).fee_asset_types;if(1===o.length&&o[0]!==a&&(a=o[0]),!n)return null;Object(h.b)({accountID:n.get(\"id\"),feeID:a,type:\"withdraw_permission_claim\",options:[\"price_per_kbyte\"],data:{type:\"memo\",content:t.memo}}).then(function(t){var a=t.fee,o=t.hasBalance,s=t.hasPoolBalance;Object(h.e)(n,a).then(function(t){return t?e.setState({fee_asset_id:r},e._updateFee):e.setState({feeAmount:a,fee_asset_id:a.asset_id,hasBalance:o,hasPoolBalance:s,error:!o||!s})})})}}},{key:\"onFeeChanged\",value:function(e){var t=e.asset;this.setState({feeAsset:t,fee_asset_id:t.get(\"id\"),error:null},this._updateFee)}},{key:\"onMemoChanged\",value:function(e){this.setState({memo:e.target.value},this._checkBalance)}},{key:\"isPayerBalanceWarning\",value:function(){var e=this.state,t=e.withdrawal_limit,a=e.asset,n=e.to_account,r=e.payerBalanceWarning,o=e.claimedAmount,s=_.a.get_asset_amount(t.amount,a),i=n.getIn([\"balances\",t.asset_id]);if(i){var l=c.ChainStore.getObject(i).get(\"balance\");l<s-o&&!r?this.setState({payerBalanceWarning:!0}):l>=s-o&&r&&this.setState({payerBalanceWarning:!1})}else r||this.setState({payerBalanceWarning:!0})}},{key:\"render\",value:function(){var e=this.state,t=e.from_account,a=e.to_account,r=e.asset,o=(e.asset_id,e.feeAmount),i=e.amount,p=(e.error,e.memo),m=e.feeAsset,h=e.fee_asset_id,_=e.balanceError,g=e.limitError,y=e.payerBalanceWarning,w=e.withdrawal_limit,E=e.current_period_expires_date,k=e.claimedAmount,S=this._getAvailableAssets(),C=S.asset_types,O=S.fee_asset_types,x=null,A=null,j=this.state.feeAmount.getAmount({real:!0});if(t&&t.get(\"balances\")){var N=this.state.balanceError?\"has-error\":\"\";if(1===C.length&&(r=c.ChainStore.getAsset(C[0])),C.length>0){var M=r?r.get(\"id\"):C[0],T=m?m.get(\"id\"):\"1.3.0\";this.isPayerBalanceWarning(),x=s.a.createElement(\"span\",null,s.a.createElement(l.a,{component:\"span\",content:\"showcases.direct_debit.limit\"}),\":\",\" \",s.a.createElement(\"span\",{className:g?\"has-error\":\"\",style:{borderBottom:\"#A09F9F 1px dotted\",cursor:\"pointer\"},onClick:this.setTotalLimit(w.amount)},s.a.createElement(f.a,{amount:w.amount-k,assetId:w&&w.asset_id})),\"Â \",y&&s.a.createElement(v.Tooltip,{placement:\"top\",title:\"Limit > payer balance!\"},s.a.createElement(v.Icon,{type:\"exclamation-circle\",theme:\"filled\",style:{color:\"#fe8c00\"}}))),T==M&&this.state.balanceError&&(A=s.a.createElement(\"span\",null,s.a.createElement(\"span\",{className:N},s.a.createElement(l.a,{content:\"transfer.errors.insufficient\"}))))}else x=s.a.createElement(\"span\",null,s.a.createElement(\"span\",{className:N},s.a.createElement(l.a,{content:\"transfer.errors.noFunds\"}))),A=s.a.createElement(\"span\",null,s.a.createElement(\"span\",{className:N},s.a.createElement(l.a,{content:\"transfer.errors.noFunds\"})))}var P=parseFloat(String.prototype.replace.call(i,/,/g,\"\")),B=P&&!Object(n.a)(P),I=!t||!a||!B||!r||_||g||y||!E||t.get(\"id\")==a.get(\"id\");return s.a.createElement(v.Modal,{title:b.a.translate(\"showcases.direct_debit.claim_funds\"),visible:this.props.isModalVisible,overlay:!0,onCancel:this.props.hideModal,footer:[this.state.errorMessage&&s.a.createElement(\"span\",{className:\"red\",style:{marginRight:\"10px\"}},this.state.errorMessage),s.a.createElement(v.Button,{key:\"send\",disabled:I,onClick:I?null:this.onSubmit.bind(this)},b.a.translate(\"showcases.direct_debit.claim\")),s.a.createElement(v.Button,{key:\"Cancel\",onClick:this.props.hideModal},s.a.createElement(l.a,{component:\"span\",content:\"transfer.cancel\"}))]},s.a.createElement(\"div\",{className:\"grid-block vertical no-overflow\"},s.a.createElement(\"form\",{noValidate:!0},s.a.createElement(\"div\",null,s.a.createElement(\"div\",{className:\"content-block\"},s.a.createElement(d.a,{label:\"showcases.direct_debit.authorizing_account\",accountName:t?t.get(\"name\"):\"\",account:t,size:60,hideImage:!0,disabled:!0}))),s.a.createElement(\"div\",{className:\"content-block transfer-input\"},s.a.createElement(\"label\",{className:\"left-label\"},b.a.translate(\"showcases.direct_debit.current_period_expires\")),s.a.createElement(\"input\",{type:\"text\",value:E?b.a.localize(new Date(E),{type:\"date\",format:\"full\"}):b.a.translate(\"showcases.direct_debit.first_period_not_started\"),disabled:!0,className:E?\"\":\"error-area\"})),s.a.createElement(\"div\",{className:\"content-block transfer-input\"},s.a.createElement(u.a,{label:\"showcases.direct_debit.amount_to_withdraw\",amount:i,onChange:this.onAmountChanged,asset:w&&w.asset_id,assets:w&&[w.asset_id],display_balance:x,allowNaN:!0})),s.a.createElement(\"div\",{className:\"content-block transfer-input\"},p&&p.length?s.a.createElement(\"label\",{className:\"right-label\"},p.length):null,s.a.createElement(v.Tooltip,{placement:\"top\",title:b.a.translate(\"tooltip.memo_tip\")},s.a.createElement(l.a,{className:\"left-label tooltip\",component:\"label\",content:\"transfer.memo\"})),s.a.createElement(\"textarea\",{style:{marginBottom:0},rows:\"3\",value:p,onChange:this.onMemoChanged.bind(this)})),s.a.createElement(\"div\",{className:\"content-block transfer-input\"},s.a.createElement(\"div\",{className:\"no-margin no-padding\"},s.a.createElement(\"div\",{id:\"txFeeSelector\",className:\"small-12\"},s.a.createElement(u.a,{label:\"transfer.fee\",disabled:!0,amount:j,onChange:this.onFeeChanged.bind(this),asset:O.length&&o?o.asset_id:1===O.length?O[0]:h||O[0],assets:O,display_balance:A,error:!1===this.state.hasPoolBalance?\"transfer.errors.insufficient\":null,scroll_length:1})))))))}}]),a}();t.a=Object(y.a)(k,{listenTo:function(){return[p.a]},getProps:function(){return{currentAccount:p.a.getState().currentAccount,passwordAccount:p.a.getState().passwordAccount}}})}).call(this,a(126).Buffer)},2223:function(e,t,a){\"use strict\";var n=a(0),r=a.n(n),o=a(33),s=a(1),i=a.n(s),l=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t),function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),l(t,[{key:\"render\",value:function(){return r.a.createElement(o.a,{amount:this.props.amount,asset:this.props.assetId,asPercentage:this.props.asPercentage,assetInfo:this.props.assetInfo,replace:this.props.replace,hide_asset:this.props.hide_asset})}}]),t}();c.propTypes={hide_asset:i.a.bool},c.defaultProps={hide_asset:!1},t.a=c},2226:function(e,t,a){\"use strict\";var n=a(292),r=a(573),o=a(590),s=a(214);var i=function(e,t){var a=-1,n=Object(s.a)(e)?Array(e.length):[];return Object(o.a)(e,function(e,r,o){n[++a]=t(e,r,o)}),n},l=a(73);t.a=function(e,t){return(Object(l.a)(e)?n.a:i)(e,Object(r.a)(t,3))}},2233:function(e,t,a){\"use strict\";a.r(t),function(e){var n=a(2226),r=a(0),o=a.n(r),s=a(2),i=a.n(s),l=a(7),c=a(270),u=a(4),p=a.n(u),d=a(24),m=a(5),h=a(1949),f=a(37),_=a(15),g=a(152),b=a(357),y=a(233),v=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function w(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function E(e,t){if(e)return e/Math.pow(10,t)}var k=function(t){function a(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,a);var e=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return e.onMemoChanged=function(t,a){return function(n){var r=Object.assign({},e.state.memo);if(r[t][a]={message:n.target.value,shown:!0},\"from_barter\"===t){var o=e.state.from_barter;e.setState({memo:r},e._updateFee(o[a].from_fee_asset_id,e.state.from_account,o[a].from_asset_id,a,!0,o))}else if(\"to_barter\"===t){var s=e.state.to_barter;e.setState({memo:r},e._updateFee(s[a].to_fee_asset_id,e.state.to_account,s[a].to_asset_id,a,!1,s))}else e.setState({memo:r})}},e.handleMemoOpen=function(t,a){return function(n){var r=Object.assign({},e.state.memo);r[t][a]={shown:!0},e.setState({memo:r})}},e.state={from_name:\"\",to_name:\"\",from_account:null,to_account:null,from_barter:[{index:0,from_amount:\"\",from_asset_id:null,from_asset:null,from_feeAmount:new f.a({amount:0}),from_feeAsset:null,from_fee_asset_id:null,from_hasPoolBalance:null,from_balanceError:!1,memo:\"\"}],to_barter:[{index:0,to_amount:\"\",to_asset_id:null,to_asset:null,to_feeAmount:new f.a({amount:0}),to_feeAsset:null,to_fee_asset_id:null,to_hasPoolBalance:null,to_balanceError:!1,memo:\"\"}],amount_counter:[],amount_index:0,from_error:null,to_error:null,memo:{from_barter:[{message:\"\",shown:!1}],to_barter:[{message:\"\",shown:!1}],escrow:[{message:\"\",shown:!1}]},proposal_fee:0,showEscrow:!1,escrow_account_name:\"\",escrow_account:null,send_to_escrow:!1,escrow_payment:0,escrow_payment_changed:!1,balanceWarning:{peer1:[],peer2:[]}},e._checkBalance=e._checkBalance.bind(e),e.onTrxIncluded=e.onTrxIncluded.bind(e),e}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,r[\"Component\"]),v(a,[{key:\"componentWillMount\",value:function(){var e=this,t=d.a.getState().currentAccount;this.state.from_name||this.setState({from_name:t}),Object(g.d)(\"proposal_create\").then(function(t){e.setState({proposal_fee:new f.a({amount:t}).getAmount({real:!0})})}),Object(g.d)(\"transfer\").then(function(t){e.setState({transfer_fee:new f.a({amount:t}).getAmount({real:!0})})})}},{key:\"fromChanged\",value:function(e){this.setState({from_name:e})}},{key:\"escrowAccountChanged\",value:function(e){this.setState({escrow_account_name:e})}},{key:\"onFromAccountChanged\",value:function(e){this.setState({from_account:e,from_barter:[{from_amount:\"\",from_asset_id:null,from_asset:null,from_feeAmount:new f.a({amount:0}),from_feeAsset:null,from_fee_asset_id:null,from_hasPoolBalance:null,from_balanceError:!1}]})}},{key:\"onEscrowAccountChanged\",value:function(e){this.setState({escrow_account:e})}},{key:\"toChanged\",value:function(e){this.setState({to_name:e})}},{key:\"onToAccountChanged\",value:function(e){this.setState({to_account:e,to_barter:[{to_amount:\"\",to_asset_id:null,to_asset:null,to_feeAmount:new f.a({amount:0}),to_feeAsset:null,to_fee_asset_id:null,to_hasPoolBalance:null,to_balanceError:!1}]})}},{key:\"onFromAmountChanged\",value:function(e,t){var a=this,n=t.asset,r=t.amount;if(n){var o=[].concat(w(this.state.from_barter));o[e]={index:e,from_amount:r,from_asset:n,from_asset_id:n.get(\"id\"),from_feeAmount:new f.a({amount:0}),from_feeAsset:n,from_fee_asset_id:\"1.3.0\",from_balanceError:!1},this.setState({from_barter:o,from_error:null},function(){a._checkBalance(o[e].from_feeAmount,r,a.state.from_account,n,e,!0,o[e].from_fee_asset_id,o),a.checkAmountsTotal()})}}},{key:\"onToAmountChanged\",value:function(e,t){var a=this,n=t.asset,r=t.amount;if(n){var o=[].concat(w(this.state.to_barter));o[e]={index:e,to_amount:r,to_asset:n,to_asset_id:n.get(\"id\"),to_feeAmount:new f.a({amount:0}),to_feeAsset:n,to_fee_asset_id:\"1.3.0\",to_balanceError:!1},this.setState({to_barter:o,to_error:null},function(){a._checkBalance(o[e].to_feeAmount,r,a.state.to_account,n,e,!1,o[e].to_fee_asset_id,o),a.checkAmountsTotal()})}}},{key:\"_checkBalance\",value:function(e,t,a,n,r,o,s,i){if(n&&a){this._updateFee(s,a,n.get(\"id\"),r,o,i);var l=a.getIn([\"balances\",n.get(\"id\")]),c=a.getIn([\"balances\",e.asset_id]);if(n&&a){if(!l)return o?(i[r].from_balanceError=!0,this.setState({from_barter:i})):(i[r].to_balanceError=!0,this.setState({to_barter:i}));var u=m.ChainStore.getObject(l),p=c?m.ChainStore.getObject(c):null;if(p&&0!==p.get(\"balance\")||(o?(i[r].from_fee_asset_id=\"1.3.0\",this.setState({from_barter:i},this._updateFee(i[r].from_fee_asset_id,a,n.get(\"id\"),r,o,i))):(i[r].to_fee_asset_id=\"1.3.0\",this.setState({to_barter:i},this._updateFee(i[r].to_fee_asset_id,a,n.get(\"id\"),r,o,i)))),u&&e){if(!t)return o?(i[r].from_balanceError=!1,this.setState({from_barter:i})):(i[r].to_balanceError=!1,this.setState({to_barter:i}));var d=Object(g.a)(t,n,e,u);if(null!==d)return o?(i[r].from_balanceError=!d,this.setState({from_barter:i})):(i[r].to_balanceError=!d,this.setState({to_barter:i}))}}}}},{key:\"_updateFee\",value:function(t,a,n,r,o,s){var i=this,l=this._getAvailableAssets(this.state),c=l.from_fee_asset_types,u=l.to_fee_asset_types,p=o?c:u;if(1===p.length&&p[0]!==t&&(t=p[0]),!a)return null;var d=this.state.memo[o?\"from_barter\":\"to_barter\"][r],m=d&&d.shown&&\"\"!==d.message?new e(d.message,\"utf-8\"):\"\";Object(g.b)({accountID:a.get(\"id\"),feeID:t,options:[\"price_per_kbyte\"],data:{type:\"memo\",content:m}}).then(function(e){var t=e.fee,l=e.hasBalance,c=e.hasPoolBalance;return Object(g.e)(a,t).then(function(e){o?e?(s[r].from_fee_asset_id=n,i.setState({from_barter:s})):(s[r].from_feeAmount=t,s[r].from_fee_asset_id=t.asset_id,s[r].from_hasPoolBalance=c,i.setState({from_barter:s,from_error:!l||!c})):e?(s[r].to_fee_asset_id=n,i.setState({to_barter:s})):(s[r].to_feeAmount=t,s[r].to_fee_asset_id=t.asset_id,s[r].to_hasPoolBalance=c,i.setState({to_barter:s,to_error:!l||!c}))})}).catch(function(e){console.error(e)})}},{key:\"_getAvailableAssets\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state,t=e.from_account,a=e.from_error,n=e.to_account,r=e.to_error,o=function(e,t){var a=[],n=[];if(!e||!e.get(\"balances\")||t)return{asset_types:a,fee_asset_types:n};var r=e.get(\"balances\").toJS();for(var o in a=Object.keys(r).sort(_.a.sortID),n=Object.keys(r).sort(_.a.sortID),r){var s=m.ChainStore.getObject(r[o]);s&&0===s.get(\"balance\")&&(a.splice(a.indexOf(o),1),-1!==n.indexOf(o)&&n.splice(n.indexOf(o),1))}return{asset_types:a,fee_asset_types:n}},s=o(t,a),i=o(n,r);return{from_asset_types:s.asset_types||[],to_asset_types:i.asset_types||[],from_fee_asset_types:s.fee_asset_types||[],to_fee_asset_types:i.fee_asset_types||[]}}},{key:\"addFromAmount\",value:function(){this.state.from_barter.push({from_amount:\"\",from_asset_id:null,from_asset:null,from_feeAmount:new f.a({amount:0}),from_feeAsset:null,from_fee_asset_id:null}),this.setState({from_barter:this.state.from_barter})}},{key:\"addToAmount\",value:function(){this.state.to_barter.push({to_amount:\"\",to_asset_id:null,to_asset:null,to_feeAmount:new f.a({amount:0}),to_feeAsset:null,to_fee_asset_id:null}),this.setState({to_barter:this.state.to_barter})}},{key:\"onSubmit\",value:function(t){var a=this;t.preventDefault(),this.setState({from_error:null,to_error:null});var n=void 0,r=[],o=d.a.getState().currentAccount,s=this.state.from_account,i=this.state.memo.escrow[0]&&this.state.memo.escrow[0].message;if(this.state.showEscrow&&this.state.send_to_escrow&&(s=this.state.escrow_account),this.state.showEscrow){var l=this.state.escrow_payment_changed?new f.a({real:this.state.escrow_payment}).getAmount():fee(!0);l>0&&r.push({from_account:this.state.from_account.get(\"id\"),to_account:this.state.escrow_account.get(\"id\"),amount:l,asset:\"1.3.0\",memo:i?new e(i,\"utf-8\"):null,feeAsset:\"1.3.0\",propose_account:o})}this.state.from_barter.forEach(function(t,l){var c=t.from_asset,u=t.from_amount;n=new f.a({real:u,asset_id:c.get(\"id\"),precision:c.get(\"precision\")});var p=a.state.memo.from_barter[l]&&a.state.memo.from_barter[l].message;a.state.showEscrow&&a.state.send_to_escrow&&r.push({from_account:a.state.from_account.get(\"id\"),to_account:a.state.escrow_account.get(\"id\"),amount:n.getAmount(),asset:c.get(\"id\"),memo:i?new e(i,\"utf-8\"):a.state.memo,feeAsset:t.from_feeAsset?t.from_feeAsset.get(\"id\"):\"1.3.0\"}),r.push({from_account:s.get(\"id\"),to_account:a.state.to_account.get(\"id\"),amount:n.getAmount(),asset:c.get(\"id\"),memo:p?new e(p,\"utf-8\"):null,feeAsset:t.from_feeAsset?t.from_feeAsset.get(\"id\"):\"1.3.0\",propose_account:o})}),this.state.showEscrow&&!this.state.send_to_escrow&&r.push({from_account:this.state.escrow_account.get(\"id\"),to_account:this.state.from_account.get(\"id\"),amount:1,asset:\"1.3.0\",memo:null,feeAsset:\"1.3.0\",propose_account:o}),this.state.to_barter.forEach(function(t,s){var i=t.to_asset,l=t.to_amount,c=a.state.memo.to_barter[s]&&a.state.memo.to_barter[s].message;n=new f.a({real:l,asset_id:i.get(\"id\"),precision:i.get(\"precision\")}),r.push({from_account:a.state.to_account.get(\"id\"),to_account:a.state.from_account.get(\"id\"),amount:n.getAmount(),asset:i.get(\"id\"),memo:c?new e(c,\"utf-8\"):null,feeAsset:t.to_feeAsset?t.to_feeAsset.get(\"id\"):\"1.3.0\",propose_account:o})}),y.a.transfer_list(r)}},{key:\"onTrxIncluded\",value:function(e){e.included&&e.broadcasted_transaction?(TransactionConfirmStore.unlisten(this.onTrxIncluded),TransactionConfirmStore.reset()):e.closed&&(TransactionConfirmStore.unlisten(this.onTrxIncluded),TransactionConfirmStore.reset())}},{key:\"renderMemoField\",value:function(e,t){var a=this.state.memo,n=a[e][t]&&a[e][t].message?a[e][t].message:\"\";return o.a.createElement(\"div\",{className:\"content-block transfer-input\"},o.a.createElement(i.a,{className:\"left-label\",component:\"label\",content:\"transfer.memo\"}),o.a.createElement(\"textarea\",{style:{marginBottom:0},rows:\"1\",value:n,onChange:this.onMemoChanged(e,t)}))}},{key:\"getBalance\",value:function(e,t){return m.ChainStore.getAccountBalance(e,t)}},{key:\"checkAmountsTotal\",value:function(){var e=this,t=this.state,a=t.from_barter,r=t.to_barter,o=t.from_account,s=t.to_account,i={},l={};a.forEach(function(e){e.from_amount&&(i.hasOwnProperty(e.from_asset_id)?i[e.from_asset_id]={amount:Number(i[e.from_asset_id].amount)+Number(e.from_amount),precision:e.from_asset.get(\"precision\"),symbol:e.from_asset.get(\"symbol\")}:i[e.from_asset_id]={amount:Number(e.from_amount),precision:e.from_asset.get(\"precision\"),symbol:e.from_asset.get(\"symbol\")})});var c=Object(n.a)(i,function(t,a){var n=e.getBalance(o,a),r=Math.max(0,t.precision),s=n?E(n,r):0;return t.assetId=a,t.amount>s&&(t.warning=!0,t.balance=s),t});r.forEach(function(e){e.to_amount&&(l.hasOwnProperty(e.to_asset_id)?l[e.to_asset_id]={amount:Number(l[e.to_asset_id].amount)+Number(e.to_amount),precision:e.to_asset.get(\"precision\"),symbol:e.to_asset.get(\"symbol\")}:l[e.to_asset_id]={amount:Number(e.to_amount),precision:e.to_asset.get(\"precision\"),symbol:e.to_asset.get(\"symbol\")})});var u=Object(n.a)(l,function(t,a){var n=e.getBalance(s,a),r=Math.max(0,t.precision),o=n?E(n,r):0;return t.assetId=a,t.amount>o&&(t.warning=!0,t.balance=o),t});this.setState({balanceWarning:{peer1:c,peer2:u}})}},{key:\"renderBalanceWarnings\",value:function(){var e=this.state.balanceWarning,t=e.peer1,a=e.peer2,n=t.some(function(e){return!!e.warning}),r=a.some(function(e){return!!e.warning}),s=p.a.translate(\"showcases.barter.peer_left\"),i=p.a.translate(\"showcases.barter.peer_right\"),c=n?o.a.createElement(\"div\",{style:{maxWidth:\"25rem\"}},p.a.translate(\"showcases.barter.balance_warning_tooltip\",{peer:s}),o.a.createElement(\"br\",null),t.map(function(e){if(e.warning)return o.a.createElement(o.a.Fragment,null,o.a.createElement(\"br\",null),o.a.createElement(\"span\",{style:{marginRight:\"10px\"},key:e.assetId},\" - \"+p.a.translate(\"showcases.barter.balance_warning_line\",{asset_symbol:e.symbol,asset_balance:e.balance,asset_amount:e.amount})))})):null,u=r?o.a.createElement(\"div\",{style:{maxWidth:\"25rem\"}},p.a.translate(\"showcases.barter.balance_warning_tooltip\",{peer:i}),a.map(function(e){if(e.warning)return o.a.createElement(\"span\",{style:{marginRight:\"10px\"},key:e.assetId},o.a.createElement(\"br\",null),o.a.createElement(\"br\",null),p.a.translate(\"showcases.barter.balance_warning_line\",{asset_symbol:e.symbol,asset_balance:e.balance,asset_amount:e.amount}),\";\")})):null;return o.a.createElement(\"span\",{className:\"barter-balance-warning\"},n&&o.a.createElement(l.Popover,{content:c,title:p.a.translate(\"showcases.barter.balance_warning\")},o.a.createElement(\"span\",{style:{cursor:\"help\"}},o.a.createElement(l.Alert,{style:{display:\"inline\",marginRight:\"1rem\"},message:s+\" \"+p.a.translate(\"showcases.barter.balance_warning\"),type:\"warning\",showIcon:!0}))),r&&o.a.createElement(l.Popover,{content:u,title:p.a.translate(\"showcases.barter.balance_warning\")},o.a.createElement(\"span\",{style:{cursor:\"help\"}},o.a.createElement(l.Alert,{style:{display:\"inline\"},message:i+\" \"+p.a.translate(\"showcases.barter.balance_warning\"),type:\"warning\",showIcon:!0}))))}},{key:\"render\",value:function(){var e=this,t=this.state,a=t.from_name,n=t.to_name,r=t.from_account,s=t.to_account,u=t.from_barter,d=t.to_barter,f=t.amount_index,_=t.from_error,g=t.to_error,y=this._getAvailableAssets(),v=y.from_asset_types,w=y.to_asset_types,E=window.innerWidth<850,k=[],S=[],C=\"\",O=\"\",x=function(){var e=!0,t=!1,a=void 0;try{for(var n,r=u[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var o=n.value,s=parseFloat(String.prototype.replace.call(o.from_amount,/,/g,\"\"));if(isNaN(s)||0===s)return!1}}catch(e){t=!0,a=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw a}}var i=!0,l=!1,c=void 0;try{for(var p,m=d[Symbol.iterator]();!(i=(p=m.next()).done);i=!0){var h=p.value;s=parseFloat(String.prototype.replace.call(h.to_amount,/,/g,\"\"));if(isNaN(s)||0===s)return!1}}catch(e){l=!0,c=e}finally{try{!i&&m.return&&m.return()}finally{if(l)throw c}}return!0},A=function(e){var t=0;return e?(t=t,u.forEach(function(e){t+=e.from_feeAmount.getAmount({real:!0})})):d.forEach(function(e){t+=e.to_feeAmount.getAmount({real:!0})}),t},j=this.state.showEscrow&&!this.state.escrow_account,N=!r||!s||r.get(\"id\")==s.get(\"id\")||g||!x()||_||j,M=function(e,t,a,n){if(e&&e.get(\"balances\")){var r=e.get(\"balances\").toJS(),s=t?\"has-error\":\"\";if(1===a.length&&(n=m.ChainStore.getAsset(a[0])),a.length>0){var l=n?n.get(\"id\"):a[0];return o.a.createElement(\"span\",null,o.a.createElement(i.a,{component:\"span\",content:\"transfer.available\"}),\":\",\" \",o.a.createElement(\"span\",{className:s,style:{borderBottom:\"#A09F9F 1px dotted\",cursor:\"pointer\"}},o.a.createElement(b.a,{balance:r[l]})))}return o.a.createElement(\"span\",null,o.a.createElement(\"span\",{className:s},o.a.createElement(i.a,{content:\"transfer.errors.noFunds\"})))}},T=u.map(function(t,a){var n=\"\";t.from_asset&&(n=t.from_asset.get(\"symbol\"),k.push([t.from_amount||0,n].join(\" \")));var s=e.state.memo.from_barter[a]&&e.state.memo.from_barter[a].shown;return o.a.createElement(\"div\",{key:f++},o.a.createElement(\"div\",{style:{position:\"relative\"}},!s&&o.a.createElement(l.Tooltip,{title:p.a.translate(\"tooltip.add_memo_field\"),placement:\"topLeft\"},o.a.createElement(l.Button,{onClick:e.handleMemoOpen(\"from_barter\",a),size:\"small\",icon:\"message\",className:\"add-memo-btn\"})),o.a.createElement(h.a,{label:\"showcases.barter.bartering_asset\",style:{marginBottom:\"1rem\"},amount:t.from_amount,onChange:e.onFromAmountChanged.bind(e,a),asset:v.length>0&&t.from_asset?t.from_asset.get(\"id\"):t.from_asset_id?t.from_asset_id:v[0],assets:v,display_balance:M(r,t.from_balanceError,v,t.from_asset),allowNaN:!0})),s&&e.renderMemoField(\"from_barter\",a))}),P=d.map(function(t,a){t.to_asset&&(t.to_asset.get(\"symbol\"),S.push([t.to_amount||0,t.to_asset.get(\"symbol\")].join(\" \")));var n=e.state.memo.to_barter[a]&&e.state.memo.to_barter[a].shown;return o.a.createElement(\"div\",{key:f++},o.a.createElement(\"div\",{style:{position:\"relative\"}},!n&&o.a.createElement(l.Tooltip,{title:p.a.translate(\"tooltip.add_memo_field\"),placement:\"topLeft\"},o.a.createElement(l.Button,{onClick:e.handleMemoOpen(\"to_barter\",a),size:\"small\",icon:\"message\",className:\"add-memo-btn\"})),o.a.createElement(h.a,{label:\"showcases.barter.bartering_asset\",style:{marginBottom:\"1rem\"},amount:t.to_amount,onChange:e.onToAmountChanged.bind(e,a),asset:w.length>0&&t.to_asset?t.to_asset.get(\"id\"):t.to_asset_id?t.to_asset_id:w[0],assets:w,display_balance:M(s,t.to_balanceError,w,t.to_asset),allowNaN:!0})),n&&e.renderMemoField(\"to_barter\",a))}),B=o.a.createElement(l.Card,{style:{borderRadius:\"10px\"}},o.a.createElement(i.a,{content:\"showcases.barter.peer_left\"}),o.a.createElement(c.a,{label:\"showcases.barter.account\",placeholder:\"placeholder\",style:{marginTop:\"0.5rem\",marginBottom:\"1rem\"},allowPubKey:!0,allowUppercase:!0,account:r,accountName:a,onChange:this.fromChanged.bind(this),onAccountChanged:this.onFromAccountChanged.bind(this),hideImage:!0,typeahead:!0}),r&&o.a.createElement(\"div\",null,T,o.a.createElement(\"div\",{style:{paddingTop:\"10px\",paddingBottom:\"10px\"}},o.a.createElement(l.Button,{onClick:this.addFromAmount.bind(this),disabled:!r||!this.state.from_barter[this.state.from_barter.length-1].from_amount},\"+ Add asset\")))),I=o.a.createElement(l.Card,{style:{borderRadius:\"10px\"}},o.a.createElement(i.a,{content:\"showcases.barter.peer_right\"}),o.a.createElement(c.a,{label:\"showcases.barter.account\",placeholder:\"placeholder\",style:{marginTop:\"0.5rem\",marginBottom:\"1rem\"},allowPubKey:!0,allowUppercase:!0,account:s,accountName:n,onChange:this.toChanged.bind(this),onAccountChanged:this.onToAccountChanged.bind(this),hideImage:!0,typeahead:!0}),s&&o.a.createElement(\"div\",null,P,o.a.createElement(\"div\",{style:{paddingTop:\"10px\",paddingBottom:\"10px\"}},o.a.createElement(l.Button,{onClick:this.addToAmount.bind(this),disabled:!s||!this.state.to_barter[this.state.to_barter.length-1].to_amount},\"+ Add asset\")))),D=\"showcases.barter.not_complete\";N&&(r?s?r.get(\"id\")==s.get(\"id\")?D=\"showcases.barter.error_same_name\":x()?j?D=\"showcases.barter.error_fill_in_escrow_name\":!this.state.showEscrow||r.get(\"id\")!=this.state.escrow_account.get(\"id\")&&s.get(\"id\")!=this.state.escrow_account.get(\"id\")||(D=\"showcases.barter.error_same_name_escrow\"):D=\"showcases.barter.error_fill_in_valid_asset_amount\":D=\"showcases.barter.error_fill_in_peer_right_name\":D=\"showcases.barter.error_fill_in_peer_left_name\");var R=o.a.createElement(l.Card,{style:{borderRadius:\"10px\"}},!N&&o.a.createElement(\"div\",{className:\"left-label\",style:{fontSize:\"1rem\"}},p.a.translate(\"showcases.barter.action\",{peer_left:a,assets_left:k.join(\", \"),peer_right:n,assets_right:S.join(\", \")}),this.state.showEscrow&&!this.state.send_to_escrow&&p.a.translate(\"showcases.barter.escrow_as_witness\",{escrow:this.state.escrow_account.get(\"name\")}),this.state.showEscrow&&this.state.send_to_escrow&&p.a.translate(\"showcases.barter.escrow_as_custodian\",{escrow:this.state.escrow_account.get(\"name\")})),N&&o.a.createElement(\"div\",{className:\"left-label\",style:{fontSize:\"1rem\"}},p.a.translate(D)),o.a.createElement(l.Tooltip,{title:p.a.translate(\"showcases.barter.add_escrow_tooltip\"),placement:\"topRight\"},o.a.createElement(l.Button,{key:this.state.showEscrow?\"remove_escrow\":\"add_escrow\",onClick:this.toggleEscrow.bind(this),style:{float:\"right\"}},p.a.translate(this.state.showEscrow?\"showcases.barter.remove_escrow\":\"showcases.barter.add_escrow\"))),500===u.length&&500===d.length?o.a.createElement(\"div\",{className:\"amount-selector\",style:this.props.style},o.a.createElement(i.a,{className:\"left-label\",component:\"label\",content:\"transfer.explict_price\"}),o.a.createElement(\"div\",{className:\"inline-label input-wrapper\"},o.a.createElement(l.Input,{disabled:!1,type:\"text\",value:function(){var e=\"\";x()&&(e=parseFloat(u[0].from_amount)/parseFloat(d[0].to_amount));return e}()}),o.a.createElement(\"div\",{className:\"form-label select floating-dropdown\"},o.a.createElement(\"div\",{className:\"dropdown-wrapper inactive\"},o.a.createElement(\"div\",null,C+\"/\"+O))))):\"\"),F=o.a.createElement(l.Card,{style:{borderRadius:\"10px\"}},o.a.createElement(i.a,{content:\"showcases.barter.peer_left\"}),o.a.createElement(l.Tooltip,{title:p.a.translate(this.state.send_to_escrow?\"showcases.barter.fee_due_now_tooltip\":\"showcases.barter.fee_when_proposal_executes_tooltip\")},o.a.createElement(\"div\",null,o.a.createElement(h.a,{label:this.state.send_to_escrow?\"showcases.barter.fee_due_now\":\"showcases.barter.fee_when_proposal_executes\",disabled:!0,style:{marginTop:\"0.5rem\",marginBottom:\"1rem\"},amount:A(!0)+0,asset:\"1.3.0\",assets:[\"1.3.0\"],error:!1===this.state.hasPoolBalance?\"transfer.errors.insufficient\":null,scroll_length:2}))),o.a.createElement(l.Tooltip,{title:p.a.translate(\"showcases.barter.proposal_fee_tooltip\")},o.a.createElement(\"div\",null,o.a.createElement(h.a,{label:\"showcases.barter.proposal_fee\",disabled:!0,amount:this.state.proposal_fee,style:{marginBottom:\"1rem\"},asset:\"1.3.0\",assets:[\"1.3.0\"],error:!1===this.state.hasPoolBalance?\"transfer.errors.insufficient\":null,scroll_length:2}))),o.a.createElement(l.Tooltip,{title:p.a.translate(\"showcases.barter.total_fees_tooltip\")},o.a.createElement(\"span\",{style:{marginTop:\"1rem\"}},o.a.createElement(i.a,{content:\"showcases.barter.total_fees\",className:\"left-label\",component:\"label\",fee:A(!0)+this.state.proposal_fee,asset:\"BTS\"})))),V=o.a.createElement(l.Card,{style:{borderRadius:\"10px\"}},o.a.createElement(i.a,{content:\"showcases.barter.peer_right\"}),o.a.createElement(l.Tooltip,{title:p.a.translate(\"showcases.barter.fee_when_proposal_executes_tooltip\")},o.a.createElement(\"div\",null,o.a.createElement(h.a,{label:\"showcases.barter.fee_when_proposal_executes\",disabled:!0,amount:A(!1),style:{marginTop:\"0.5rem\"},asset:\"1.3.0\",assets:[\"1.3.0\"],error:!1===this.state.hasPoolBalance?\"transfer.errors.insufficient\":null,scroll_length:2})))),z=null;this.state.showEscrow&&(z=o.a.createElement(l.Card,{style:{borderRadius:\"10px\"}},o.a.createElement(i.a,{content:\"showcases.barter.escrow_account\"}),o.a.createElement(l.Tooltip,{title:p.a.translate(\"showcases.barter.fee_when_proposal_executes_tooltip\")},o.a.createElement(\"div\",null,o.a.createElement(h.a,{label:\"showcases.barter.fee_when_proposal_executes\",disabled:!1,amount:A(!0),style:{marginTop:\"0.5rem\"},asset:\"1.3.0\",assets:[\"1.3.0\"],error:!1===this.state.hasPoolBalance?\"transfer.errors.insufficient\":null,scroll_length:2})))));var L=o.a.createElement(l.Card,{style:{borderRadius:\"10px\"}},o.a.createElement(l.Tooltip,{title:p.a.translate(\"showcases.barter.new_barter_tooltip\"),placement:\"bottom\"},o.a.createElement(\"h2\",{style:{textAlign:\"center\"}},o.a.createElement(i.a,{content:\"showcases.barter.new_barter\"}),\" \",o.a.createElement(l.Icon,{type:\"question-circle\",theme:\"filled\"})))),W=null,H=this.state.memo.escrow[0]&&this.state.memo.escrow[0].shown,q=this.state.escrow_payment_changed?this.state.escrow_payment:A(!0);return this.state.showEscrow&&(W=o.a.createElement(l.Card,{style:{borderRadius:\"10px\"}},o.a.createElement(c.a,{label:\"showcases.barter.escrow_account\",placeholder:\"placeholder\",style:{marginBottom:\"1rem\"},allowPubKey:!0,allowUppercase:!0,account:this.state.escrow_account,accountName:this.state.escrow_account_name,onChange:this.escrowAccountChanged.bind(this),onAccountChanged:this.onEscrowAccountChanged.bind(this),hideImage:!0,typeahead:!0}),o.a.createElement(l.Tooltip,{title:p.a.translate(\"showcases.barter.send_to_escrow_tooltip\")},o.a.createElement(\"span\",null,o.a.createElement(l.Switch,{style:{margin:6},checked:this.state.send_to_escrow,onChange:this.onToggleSendToEscrow.bind(this)}),o.a.createElement(i.a,{content:\"showcases.barter.send_to_escrow\"}))),o.a.createElement(\"div\",{style:{position:\"relative\"}},!H&&o.a.createElement(l.Tooltip,{title:p.a.translate(\"tooltip.add_memo_field\"),placement:\"topLeft\"},o.a.createElement(l.Button,{onClick:this.handleMemoOpen(\"escrow\",0),size:\"small\",icon:\"message\",className:\"add-memo-btn\"})),o.a.createElement(l.Tooltip,{title:p.a.translate(\"showcases.barter.escrow_payment_tooltip\"),placement:\"topLeft\"},o.a.createElement(\"div\",null,o.a.createElement(h.a,{label:\"showcases.barter.escrow_payment\",disabled:!1,amount:q,onChange:this._updateEscrowFee.bind(this),style:{margin:\"1rem 0\"},asset:\"1.3.0\",assets:[\"1.3.0\"],error:!1===this.state.hasPoolBalance?\"transfer.errors.insufficient\":null,scroll_length:2}))),H&&this.renderMemoField(\"escrow\",0)))),o.a.createElement(\"div\",{className:\"center\",style:{padding:\"10px\",maxWidth:\"80rem\",width:\"100%\",margin:\"0 auto\"}},o.a.createElement(l.Card,null,E?o.a.createElement(\"div\",null,o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:\"10px\"}},L)),o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:\"10px\"}},B)),o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:\"10px\"}},I)),o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:\"10px\"}},R)),W&&o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:\"10px\"}},W)),o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:\"10px\"}},F)),o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:\"10px\"}},V)),null!=z&&o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:\"10px\"}},z))):o.a.createElement(\"div\",null,o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:\"10px\"}},L)),o.a.createElement(l.Row,null,o.a.createElement(l.Col,{span:12,style:{padding:\"10px\"}},B),o.a.createElement(l.Col,{span:12,style:{padding:\"10px\"}},I)),o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:\"10px\"}},R)),W&&o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:\"10px\"}},W)),o.a.createElement(l.Row,null,o.a.createElement(l.Col,{span:12,style:{padding:\"10px\"}},F),o.a.createElement(l.Col,{span:12,style:{padding:\"10px\"}},V,z))),o.a.createElement(\"div\",{className:\"barter-footer\"},o.a.createElement(l.Tooltip,{title:p.a.translate(\"showcases.barter.propose_tooltip\"),placement:\"topLeft\"},o.a.createElement(l.Button,{key:\"propose\",disabled:N,onClick:N?null:this.onSubmit.bind(this)},p.a.translate(\"propose\"))),!N&&this.renderBalanceWarnings())))}},{key:\"_updateEscrowFee\",value:function(e){this.setState({escrow_payment_changed:!0,escrow_payment:e.amount})}},{key:\"onToggleSendToEscrow\",value:function(){this.setState({send_to_escrow:!this.state.send_to_escrow})}},{key:\"toggleEscrow\",value:function(){this.setState({showEscrow:!this.state.showEscrow})}}]),a}();t.default=k}.call(this,a(126).Buffer)},2234:function(e,t,a){\"use strict\";a.r(t);var n=a(0),r=a.n(n),o=a(4),s=a.n(o),i=a(2),l=a.n(i),c=a(7),u=a(1975),p=a.n(u),d=(a(140),a(31)),m=a(5),h=a(44),f=a(1980),_=a(24),g=a(22),b=a(752),y=a(13),v=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var w=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={isBorrowBaseModalVisible:!1,selectedAsset:null,step:0},e.steps=[{key:\"introduction\",icon:\"borrow\"},{key:\"concept\",has_legend:!0},{key:\"setup\",has_legend:!0},{key:\"benefits\",has_legend:!0},{key:\"risks\",has_legend:!0}],e.showBorrowModal=e.showBorrowModal.bind(e),e.hideBorrowModal=e.hideBorrowModal.bind(e),e}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n[\"Component\"]),v(t,[{key:\"showBorrowModal\",value:function(){var e=this;this.props.currentAccount?this.setState({isBorrowBaseModalVisible:!0}):h.a.unlock().then(function(){e.setState({isBorrowBaseModalVisible:!0})}).catch(function(){})}},{key:\"hideBorrowModal\",value:function(){this.setState({isBorrowBaseModalVisible:!1})}},{key:\"next\",value:function(){var e=this.state.step+1;e>=this.steps.length&&(e=this.steps.length),this.setState({step:e})}},{key:\"prev\",value:function(){var e=this.state.step-1;e<0&&(e=0),this.setState({step:e})}},{key:\"onAssetChange\",value:function(e){this.setState({selectedAsset:e})}},{key:\"render\",value:function(){var e=this,t=m.ChainStore.getAccount(this.props.currentAccount),a=!(!t||\"string\"==typeof t),n=this.state.step,o=window.innerWidth<=800,i=this.state.step>0,u=m.ChainStore.getAsset(this.state.selectedAsset),p=this.steps,d=null;if(n<p.length)try{p[n].has_legend&&(d=(d=s.a.translate(\"showcases.borrow.steps_\"+p[n].key+\".text_legend\")).split(\"\\n\").map(function(e){return e.split(\":\")}))}catch(e){d=s.a.translate(\"showcases.borrow.steps_\"+p[n].key+\".text_legend\")}var h=null;return n>=p.length&&(h=r.a.createElement(c.Card,null,r.a.createElement(\"div\",{className:\"center-content\"},r.a.createElement(l.a,{content:\"showcases.borrow.choose\",component:\"h4\"})),r.a.createElement(\"div\",{style:{display:\"flex\",justifyContent:\"center\"}},r.a.createElement(\"div\",null,r.a.createElement(b.a,{style:{width:\"12rem\",marginBottom:\"1rem\"},assets:[\"1.3.113\",\"1.3.120\",\"1.3.121\",\"1.3.1325\",\"1.3.105\",\"1.3.106\",\"1.3.103\"],onChange:this.onAssetChange.bind(this)}),r.a.createElement(c.Tooltip,{title:s.a.translate(\"showcases.borrow.borrow_tooltip\"),placement:\"bottom\"},r.a.createElement(c.Button,{type:\"primary\",style:{width:\"12rem\"},disabled:null===this.state.selectedAsset||!a||\"1.2.3\"===t.get(\"id\"),onClick:this.showBorrowModal},r.a.createElement(l.a,{content:\"exchange.borrow\"}))))))),r.a.createElement(\"div\",{style:{align:\"center\",display:\"flex\",paddingTop:\"1rem\",justifyContent:\"center\"},onKeyDown:this.onKeyDown.bind(this)},r.a.createElement(c.Card,{style:{borderRadius:\"50px\",width:\"70%\",maxWidth:\"70rem\",paddingTop:\"1rem\",paddingBottom:\"1rem\"}},r.a.createElement(\"div\",{style:{display:\"flex\",justifyContent:\"center\"}},r.a.createElement(l.a,{component:\"h1\",content:null!=h?\"showcases.borrow.now_ready\":\"showcases.borrow.title_long\"})),i&&(o?n<this.steps.length?r.a.createElement(r.a.Fragment,null,n+\". \",r.a.createElement(l.a,{content:\"showcases.borrow.steps_\"+p[n].key+\".title\"})):null:r.a.createElement(c.Steps,{progressDot:!0,current:n-1},p.map(function(e,t){return 0==t?null:r.a.createElement(c.Steps.Step,{key:e.key,title:s.a.translate(\"showcases.borrow.steps_\"+e.key+\".title\")})}))),r.a.createElement(\"div\",{style:{paddingTop:\"1rem\",paddingBottom:\"1rem\"}},null!=h&&h,null==h&&r.a.createElement(c.Card,{onKeyDown:this.onKeyDown.bind(this)},!!p[n].icon&&r.a.createElement(g.a,{name:\"steps[current].icon\"}),r.a.createElement(l.a,{component:\"h2\",content:\"showcases.borrow.steps_\"+p[n].key+\".title_within\"}),r.a.createElement(l.a,{component:\"p\",content:\"showcases.borrow.steps_\"+p[n].key+\".text\"}),!!p[n].has_legend&&r.a.createElement(r.a.Fragment,null,d.map(function(e,t){return r.a.createElement(\"p\",{key:\"borrow_subp_\"+t},r.a.createElement(\"strong\",null,e[0]),\": \",e[1])})))),r.a.createElement(\"div\",{className:\"steps-action\"},n<p.length&&r.a.createElement(c.Tooltip,{title:0==n?s.a.translate(\"showcases.borrow.navigate_with_keys\"):null},r.a.createElement(c.Button,{type:\"primary\",onClick:function(){return e.next()},tabIndex:\"0\",ref:\"next\",onKeyDown:this.onKeyDown.bind(this)},0==n&&r.a.createElement(l.a,{content:\"showcases.borrow.get_started\"}),n>0&&n<p.length-1&&r.a.createElement(l.a,{content:\"showcases.borrow.next\"}),n===p.length-1&&r.a.createElement(l.a,{content:\"showcases.borrow.do_it\"}))),n>0&&r.a.createElement(c.Button,{style:{marginLeft:8},onClick:function(){return e.prev()},ref:\"previous\",onKeyDown:this.onKeyDown.bind(this)},r.a.createElement(l.a,{content:\"showcases.borrow.previous\"})))),a&&!!u&&r.a.createElement(f.a,{visible:this.state.isBorrowBaseModalVisible,hideModal:this.hideBorrowModal,quote_asset:u.get(\"id\"),backing_asset:u.getIn([\"bitasset\",\"options\",\"short_backing_asset\"]),account:t}))}},{key:\"componentDidMount\",value:function(){this.focusDiv()}},{key:\"componentDidUpdate\",value:function(){this.focusDiv()}},{key:\"focusDiv\",value:function(){var e=this.state.step,t=this.steps;e<t.length&&this.refs.next?y.findDOMNode(this.refs.next).focus():e==t.length&&this.refs.previous&&y.findDOMNode(this.refs.previous).focus()}},{key:\"onKeyDown\",value:function(e){39===e.keyCode||\"ArrowRight\"==e.key?(e.preventDefault(),e.stopPropagation(),this.next()):37!==e.keyCode&&\"ArrowLeft\"!=e.key||(e.preventDefault(),e.stopPropagation(),this.prev())}}]),t}();w=p()(w,50,{leading:!1}),t.default=Object(d.a)(w,{listenTo:function(){return[_.a]},getProps:function(){return{currentAccount:_.a.getState().currentAccount||_.a.getState().passwordAccount}}})},2239:function(e,t,a){\"use strict\";a.r(t);var n=a(0),r=a.n(n),o=a(26),s=a(552),i=a(111),l=a(750);var c=function(e,t,a){return null==e?e:Object(l.a)(e,t,a)},u=a(4),p=a.n(u),d=a(196),m=a(2),h=a.n(m),f=a(25),_=a(408),g=a(88),b=a(353),y=a.n(b),v=a(7),w=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var E=v.Form.Item,k=v.Select.Option,S=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={message:null},e.handleNotificationChange=e.handleNotificationChange.bind(e),e}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),w(t,[{key:\"_setMessage\",value:function(e){var t=this;this.setState({message:p.a.translate(e)}),this.timer=setTimeout(function(){t.setState({message:null})},4e3)}},{key:\"componentWillUnmount\",value:function(){clearTimeout(this.timer)}},{key:\"handleNotificationChange\",value:function(e){var t=this;return function(a){t.props.onNotificationChange(e,!!a.target.checked)}}},{key:\"render\",value:function(){var e=this.props,t=e.defaults,a=e.setting,n=void 0,o=void 0,s=void 0,i=e.settings.get(a),l=null;switch(a){case\"locale\":o=i,n=t.map(function(e){var t=\"languages.\"+e,a=p.a.translate(t);return r.a.createElement(k,{key:e,value:e},a)});break;case\"themes\":o=i,n=t.map(function(e){var t=\"settings.\"+e,a=p.a.translate(t);return r.a.createElement(k,{key:e,value:e},a)});break;case\"browser_notifications\":o=i,l=r.a.createElement(\"div\",{className:\"settings--notifications\"},r.a.createElement(\"div\",{className:\"settings--notifications--group\"},r.a.createElement(\"div\",{className:\"settings--notifications--item\"},r.a.createElement(v.Checkbox,{id:\"browser_notifications.allow\",checked:!!o.allow,onChange:this.handleNotificationChange(\"allow\")},p.a.translate(\"settings.browser_notifications_allow\"))),r.a.createElement(\"div\",{className:\"settings--notifications--group\"},r.a.createElement(\"div\",{className:\"settings--notifications--item\"},r.a.createElement(v.Checkbox,{id:\"browser_notifications.additional.transferToMe\",disabled:!o.allow,checked:!!o.additional.transferToMe,onChange:this.handleNotificationChange(\"additional.transferToMe\")},p.a.translate(\"settings.browser_notifications_additional_transfer_to_me\"))))),!!o.allow&&y.a.needsPermission&&r.a.createElement(\"a\",{href:\"https://goo.gl/zZ7NHY\",target:\"_blank\",rel:\"noopener noreferrer\",className:\"external-link\"},r.a.createElement(h.a,{component:\"div\",className:\"settings--notifications--no-browser-support\",content:\"settings.browser_notifications_disabled_by_browser_notify\"})));break;case\"defaultMarkets\":n=null,o=null;break;case\"walletLockTimeout\":o=i,s=r.a.createElement(v.Input,{type:\"text\",className:\"settings--input\",value:i,onChange:this.props.onChange.bind(this,a)});break;default:\"number\"==typeof i?o=t[i]:\"boolean\"==typeof i?o=i?t[0]:t[1]:\"string\"==typeof i&&(o=i),t?n=t.map(function(e){var t=e.translate?p.a.translate(\"settings.\"+e.translate):e;\"unit\"===a&&(t=r.a.createElement(g.a,{name:e}));var n=e.translate?e.translate:e;return r.a.createElement(k,{value:e.translate?e.translate:e,key:n},t)}):s=r.a.createElement(\"input\",{className:\"settings-input\",type:\"text\",defaultValue:o,onBlur:this.props.onChange.bind(this,a)})}if(\"number\"!=typeof o&&!o&&!n)return null;o&&o.translate&&(o=o.translate);return r.a.createElement(\"section\",{className:\"no-border-bottom\"},r.a.createElement(function(e){var t=e.noHeader,a=e.setting,n=e.children;return r.a.createElement(r.a.Fragment,null,t&&n||r.a.createElement(E,{label:p.a.translate(\"settings.\"+a)},n))},{noHeader:!1,setting:a},n?r.a.createElement(\"ul\",{className:\"unstyled-list\"},r.a.createElement(\"li\",{className:\"with-dropdown\"},void 0,r.a.createElement(v.Select,{value:o,className:\"settings--select\",onChange:this.props.onChange.bind(this,a)},n),void 0)):null,s?r.a.createElement(\"ul\",{className:\"unstyled-list\"},r.a.createElement(\"li\",null,s)):null,l||null),r.a.createElement(\"div\",{className:\"facolor-success\"},this.state.message))}}]),t}(),C=a(2227),O=a(24),x=a(39),A=a(31),j=a(15),N=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var M=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t),function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),N(t,[{key:\"shouldComponentUpdate\",value:function(e){return!j.a.are_equal_shallow(e.myAccounts,this.props.myAccounts)||e.hiddenAccounts!==this.props.hiddenAccounts}},{key:\"onToggleHide\",value:function(e,t,a){a.preventDefault(),x.a.toggleHideAccount(e,t)}},{key:\"render\",value:function(){var e=this,t=this.props,a=t.myAccounts,n=t.hiddenAccounts,o=n.toArray().concat(a).sort();return o.length?r.a.createElement(\"table\",{className:\"table\"},r.a.createElement(\"tbody\",null,o.map(function(t){var a=n.has(t),o=r.a.createElement(\"a\",{onClick:a?e.onToggleHide.bind(e,t,!1):e.onToggleHide.bind(e,t,!0)},r.a.createElement(h.a,{content:\"account.\"+(a?\"unignore\":\"ignore\")}));return r.a.createElement(\"tr\",{key:t},r.a.createElement(\"td\",null,t),r.a.createElement(\"td\",null,r.a.createElement(C.a,{to:\"/account/\"+t+\"/permissions\"},r.a.createElement(h.a,{content:\"settings.view_keys\"}))),r.a.createElement(\"td\",null,o))}))):r.a.createElement(\"div\",null,r.a.createElement(h.a,{content:\"settings.no_accounts\"}))}}]),t}(),T=M=Object(A.a)(M,{listenTo:function(){return[O.a]},getProps:function(){return{myAccounts:O.a.getMyAccounts(),hiddenAccounts:O.a.getState().myHiddenAccounts}}}),P=a(847),B=a(1995),I=a(19),D=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var R=v.Form.Item,F=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={lookupActive:!1,resetMessage:null},e}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),D(t,[{key:\"onLookup\",value:function(){this.setState({lookupActive:!0})}},{key:\"onResetBrainkeySequence\",value:function(){I.a.resetBrainKeySequence(),this.setState({resetMessage:p.a.translate(\"wallet.brainkey_reset_success\")})}},{key:\"render\",value:function(){var e=this.state.lookupActive;return this.props.deprecated?r.a.createElement(\"div\",null,r.a.createElement(P.ChangeActiveWallet,null),r.a.createElement(P.WalletDelete,null)):r.a.createElement(\"div\",null,r.a.createElement(P.ChangeActiveWallet,null),r.a.createElement(P.WalletDelete,null),r.a.createElement(R,{label:p.a.translate(\"wallet.balance_claims\"),className:\"no-offset\",style:{padding:\"15px 0\"}},r.a.createElement(\"div\",{style:{paddingBottom:10}},r.a.createElement(h.a,{content:\"settings.lookup_text\"}),\":\"),r.a.createElement(v.Button,{onClick:this.onLookup.bind(this)},r.a.createElement(h.a,{content:\"wallet.balance_claim_lookup\"}))),e?r.a.createElement(B.a,null):null,r.a.createElement(R,{label:p.a.translate(\"wallet.brainkey_seq_reset\"),className:\"no-offset\",style:{paddingBottom:\"15px\"}},r.a.createElement(\"div\",{style:{paddingBottom:10}},r.a.createElement(\"p\",null,r.a.createElement(h.a,{unsafe:!0,content:\"wallet.brainkey_seq_reset_text\"})),r.a.createElement(v.Button,{onClick:this.onResetBrainkeySequence.bind(this)},r.a.createElement(h.a,{content:\"wallet.brainkey_seq_reset_button\"})),this.state.resetMessage?r.a.createElement(\"p\",{style:{paddingTop:10},className:\"facolor-success\"},this.state.resetMessage):null)))}}]),t}(),V=a(2055),z=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var L=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t),function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),z(t,[{key:\"render\",value:function(){return r.a.createElement(V.a,null)}}]),t}(),W=a(359),H=a(2012),q=a(580),U=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var J=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={json:null,error:null},a}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),U(t,[{key:\"upload\",value:function(e){var t=this;this.setState({error:!1,json:null});var a=e.target.files[0],n=new FileReader;n.onload=function(e){var a=e.target.result;try{var n=JSON.parse(a);for(var r in n){var o=n[r],s=o.quote,i=o.base;if(!s||!i)throw new Error(\"Cannot parse json data.\")}t.setState({json:n})}catch(e){t.setState({error:!0})}},n.readAsText(a)}},{key:\"finish\",value:function(){var e=this.state.json;for(var t in f.a.clearStarredMarkets(),e){var a=e[t],n=a.quote,r=a.base;f.a.addStarMarket(n,r)}v.Notification.success({message:p()(\"settings.backup_favorites_success\")})}},{key:\"render\",value:function(){var e=this.state;return r.a.createElement(\"div\",null,r.a.createElement(\"input\",{type:\"file\",id:\"file_input\",accept:\".json\",style:{border:\"solid\",marginBottom:15},onChange:this.upload.bind(this)}),e.error&&r.a.createElement(\"h5\",null,r.a.createElement(h.a,{content:\"settings.backup_favorites_error\"})),e.json&&r.a.createElement(\"p\",null,r.a.createElement(v.Button,{type:\"primary\",onClick:this.finish.bind(this)},r.a.createElement(h.a,{content:\"settings.backup_favorites_finish\"}))))}}]),t}(),K=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var Z=v.Select.Option,G=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={restoreType:0,types:[\"backup\",\"key\",\"legacy\",\"brainkey\",\"favorites\"]},e}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),K(t,[{key:\"_setWalletMode\",value:function(){f.a.changeSetting({setting:\"passwordLogin\",value:!1})}},{key:\"_changeType\",value:function(e){this.setState({restoreType:this.state.types.indexOf(e)})}},{key:\"render\",value:function(){if(this.props.passwordLogin)return r.a.createElement(\"div\",null,r.a.createElement(h.a,{content:\"settings.wallet_required\",component:\"h4\"}),r.a.createElement(\"p\",{className:\"dark-text-color\"},r.a.createElement(h.a,{content:\"settings.wallet_required_text\"}),\":\"),r.a.createElement(v.Button,{type:\"primary\",className:\"button\",onClick:this._setWalletMode},r.a.createElement(h.a,{content:\"settings.enable_wallet\"})));var e=this.state,t=e.types,a=e.restoreType,n=t.map(function(e){return r.a.createElement(Z,{key:e,value:e},p.a.translate(\"settings.backup_\"+e),\" \")}),o=void 0;switch(t[a]){case\"backup\":o=r.a.createElement(\"div\",null,r.a.createElement(W.b,null));break;case\"brainkey\":o=r.a.createElement(\"div\",null,r.a.createElement(\"p\",{style:{maxWidth:\"40rem\",paddingBottom:10}},r.a.createElement(h.a,{content:\"settings.restore_brainkey_text\"})),r.a.createElement(q.a,{nested:!0}));break;case\"favorites\":o=r.a.createElement(\"div\",null,r.a.createElement(J,null));break;default:o=r.a.createElement(H.a,{privateKey:1===a})}return r.a.createElement(\"div\",null,r.a.createElement(v.Select,{onChange:this._changeType.bind(this),className:\"bts-select\",value:t[a]},n),o)}}]),t}(),Y=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var Q=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={message:null},e}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),Y(t,[{key:\"_setMessage\",value:function(e){var t=this;this.setState({message:p.a.translate(e)}),this.timer=setTimeout(function(){t.setState({message:null})},4e3)}},{key:\"componentWillUnmount\",value:function(){clearTimeout(this.timer)}},{key:\"render\",value:function(){var e=this;return r.a.createElement(\"section\",{className:\"no-border-bottom\"},r.a.createElement(\"header\",null,r.a.createElement(h.a,{component:\"span\",style:{fontWeight:\"normal\",fontFamily:\"Roboto-Medium, arial, sans-serif\",fontStyle:\"normal\"},content:\"settings.reset_text_description\",generalName:p.a.translate(\"settings.general\"),with:{generalName:p.a.translate(\"settings.general\"),accessName:p.a.translate(\"settings.access\"),faucetName:p.a.translate(\"settings.faucet_address\")}})),r.a.createElement(v.Button,{type:\"primary\",style:{height:60,width:\"100%\",marginTop:\"30px\"},onClick:function(){f.a.clearSettings().then(function(){e._setMessage(\"settings.restore_default_success\")})}},p.a.translate(\"settings.reset\")),r.a.createElement(\"div\",{className:\"facolor-success\",style:{marginTop:\"20px\",height:\"18px\"}},this.state.message))}}]),t}(),X=a(2053),$=a(360),ee=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var te=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t),function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),ee(t,[{key:\"makeBackup\",value:function(){var e=this.props.starredMarkets.toJS(),t=new Blob([JSON.stringify(e)],{type:\"application/json; charset=us-ascii\"});Object($.saveAs)(t,\"favorites.json\")}},{key:\"render\",value:function(){return r.a.createElement(\"div\",null,r.a.createElement(\"p\",null,r.a.createElement(h.a,{content:\"settings.backup_favoritestext\"})),r.a.createElement(v.Button,{type:\"primary\",onClick:this.makeBackup.bind(this)},r.a.createElement(h.a,{content:\"settings.backup_favoritesbtn\"})))}}]),t}(),ae=Object(A.a)(te,{listenTo:function(){return[o.a]},getProps:function(){return{starredMarkets:o.a.getState().starredMarkets}}}),ne=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var re=v.Select.Option,oe=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={restoreType:0,types:[\"backup\",\"brainkey\",\"favorites\"]},e}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),ne(t,[{key:\"_changeType\",value:function(e){this.setState({restoreType:this.state.types.indexOf(e)})}},{key:\"render\",value:function(){var e=this.state,t=e.types,a=e.restoreType,n=t.map(function(e){return r.a.createElement(re,{key:e,value:e},p.a.translate(\"settings.backupcreate_\"+e),\" \")}),o=void 0;switch(t[a]){case\"backup\":o=r.a.createElement(W.a,null);break;case\"brainkey\":o=r.a.createElement(X.a,null);break;case\"favorites\":o=r.a.createElement(ae,null)}return r.a.createElement(\"div\",null,r.a.createElement(v.Select,{onChange:this._changeType.bind(this),className:\"bts-select\",value:t[a],style:{marginBottom:\"16px\"}},n),o)}}]),t}(),se=a(412),ie=a(42),le=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},ce=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var ue=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),n=a._getMenuEntries(e),r=0,o=e.match.params.tab?n.indexOf(e.match.params.tab):e.viewSettings.get(\"activeSetting\",0);o>=0&&(r=o);var s=[\"locale\",\"unit\",\"browser_notifications\",\"showSettles\",\"walletLockTimeout\",\"themes\",\"showAssetPercent\",\"viewOnlyMode\"];return Object(ie.b)().length>1&&s.push(\"passwordLogin\"),s.push(\"reset\"),a.state={isAddNodeModalVisible:!1,isRemoveNodeModalVisible:!1,removeNode:{name:null,url:null},apiServer:e.settings.get(\"apiServer\"),activeSetting:r,menuEntries:n,settingEntries:{general:s,access:[\"apiServer\",\"faucet_address\"]}},a.showAddNodeModal=a.showAddNodeModal.bind(a),a.hideAddNodeModal=a.hideAddNodeModal.bind(a),a.showRemoveNodeModal=a.showRemoveNodeModal.bind(a),a.hideRemoveNodeModal=a.hideRemoveNodeModal.bind(a),a._handleNotificationChange=a._handleNotificationChange.bind(a),a}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),ce(t,[{key:\"componentDidUpdate\",value:function(e){e.match.params.tab!==this.props.match.params.tab&&this.props.match.params.tab&&this._onChangeMenu(this.props.match.params.tab)}},{key:\"componentWillReceiveProps\",value:function(e){if(e.settings.get(\"passwordLogin\")!==this.props.settings.get(\"passwordLogin\")){var t=this._getMenuEntries(this.props),a=this._getMenuEntries(e),n=t[this.state.activeSetting],r=a.indexOf(n),o=a[r];this.setState({menuEntries:a}),r&&r!==this.state.activeSetting?this.setState({activeSetting:a.indexOf(n)}):(!o||this.state.activeSetting>a.length-1)&&this.setState({activeSetting:0})}}},{key:\"showAddNodeModal\",value:function(){this.setState({isAddNodeModalVisible:!0})}},{key:\"hideAddNodeModal\",value:function(){this.setState({isAddNodeModalVisible:!1})}},{key:\"showRemoveNodeModal\",value:function(e,t){this.setState({isRemoveNodeModalVisible:!0,removeNode:{url:e,name:t}})}},{key:\"hideRemoveNodeModal\",value:function(){this.setState({isRemoveNodeModalVisible:!1,removeNode:{url:null,name:null}})}},{key:\"_getMenuEntries\",value:function(e){if(e.deprecated)return[\"wallet\",\"backup\"];var t=[];return t.push(\"general\"),e.settings.get(\"passwordLogin\")||t.push(\"wallet\"),t.push(\"accounts\"),e.settings.get(\"passwordLogin\")||t.push(\"password\"),e.settings.get(\"passwordLogin\")||t.push(\"backup\"),e.settings.get(\"passwordLogin\")||t.push(\"restore\"),t.push(\"access\"),Object(ie.h)().show&&t.push(\"faucet_address\"),t.push(\"reset\"),t}},{key:\"triggerModal\",value:function(e){for(var t,a=arguments.length,n=Array(a>1?a-1:0),r=1;r<a;r++)n[r-1]=arguments[r];(t=this.refs.ws_modal).show.apply(t,[e].concat(n))}},{key:\"_handleNotificationChange\",value:function(e,t){var a=c(this.props.settings.get(\"browser_notifications\"),e,t);f.a.changeSetting({setting:\"browser_notifications\",value:a})}},{key:\"_handleSettingsEntryChange\",value:function(e,t){t.target?this._onChangeSetting(e,t):this._onChangeSetting(e,{target:{value:t}})}},{key:\"_onChangeSetting\",value:function(e,t){t.preventDefault&&t.preventDefault();var a=this.props.defaults,n=null;function r(e,t){if(!t)return e;if(!t[0].translate)return t.indexOf(e);for(var a=0;a<t.length;a++)if(p.a.translate(\"settings.\"+t[a].translate)===e)return a}switch(e){case\"locale\":var o=p.a.getLocale();t.target.value!==o&&(d.a.switchLocale(t.target.value),f.a.changeSetting({setting:\"locale\",value:t.target.value}));break;case\"themes\":f.a.changeSetting({setting:\"themes\",value:t.target.value});break;case\"defaultMarkets\":break;case\"walletLockTimeout\":var s=parseInt(t.target.value,10);isNaN(s)&&(s=0),isNaN(s)||\"number\"!=typeof s||f.a.changeSetting({setting:\"walletLockTimeout\",value:s});break;case\"inverseMarket\":case\"confirmMarketOrder\":n=0===r(t.target.value,a[e]);break;case\"apiServer\":f.a.changeSetting({setting:\"apiServer\",value:t.target.value}),this.setState({apiServer:t.target.value});break;case\"showSettles\":case\"showAssetPercent\":case\"passwordLogin\":case\"viewOnlyMode\":var i=a[e][0];i.translate&&(i=i.translate),f.a.changeSetting({setting:e,value:t.target.value===i});break;case\"unit\":var l=r(t.target.value,a[e]);f.a.changeSetting({setting:e,value:a[e][l]});break;default:n=r(t.target.value,a[e])}null!==n&&f.a.changeSetting({setting:e,value:n})}},{key:\"onReset\",value:function(){f.a.clearSettings()}},{key:\"_redirectToEntry\",value:function(e){this.props.history.push(\"/settings/\"+e)}},{key:\"_onChangeMenu\",value:function(e){var t=this.state.menuEntries.indexOf(e);this.setState({activeSetting:t}),f.a.changeViewSetting({activeSetting:t})}},{key:\"render\",value:function(){var e=this,t=this.props,a=t.settings,n=t.defaults,o=this.state,s=o.menuEntries,i=o.activeSetting,l=o.settingEntries,c=void 0,u=s[i]||s[0];switch(u){case\"accounts\":c=r.a.createElement(T,null);break;case\"wallet\":c=r.a.createElement(F,this.props);break;case\"password\":c=r.a.createElement(L,null);break;case\"backup\":c=r.a.createElement(oe,null);break;case\"restore\":c=r.a.createElement(G,{passwordLogin:this.props.settings.get(\"passwordLogin\")});break;case\"access\":c=r.a.createElement(se.a,{faucet:a.get(\"faucet_address\"),nodes:n.apiServer,onChange:this._onChangeSetting.bind(this),showAddNodeModal:this.showAddNodeModal,showRemoveNodeModal:this.showRemoveNodeModal});break;case\"faucet_address\":c=r.a.createElement(v.Input,{disabled:!Object(ie.h)().editable,type:\"text\",defaultValue:a.get(\"faucet_address\"),onChange:Object(ie.h)().editable?this._onChangeSetting.bind(this,\"faucet_address\"):null});break;case\"reset\":c=r.a.createElement(Q,null);break;default:c=l[u].map(function(t){return r.a.createElement(S,le({key:t,setting:t,settings:a,defaults:n[t],onChange:e._handleSettingsEntryChange.bind(e),onNotificationChange:e._handleNotificationChange,locales:e.props.localesObject},e.state))})}return r.a.createElement(v.Form,{layout:\"vertical\"},r.a.createElement(\"div\",{className:this.props.deprecated?\"\":\"grid-block settings-container\"},r.a.createElement(\"div\",{className:\"grid-block main-content margin-block wrap\"},r.a.createElement(\"div\",{className:\"grid-content shrink settings-menu\",style:{paddingRight:\"2rem\"}},r.a.createElement(h.a,{style:{paddingBottom:10,paddingLeft:10},component:\"h3\",content:\"header.settings\",className:\"panel-bg-color\"}),r.a.createElement(\"ul\",null,s.map(function(t,a){return r.a.createElement(\"li\",{className:a===i?\"active\":\"\",onClick:e._redirectToEntry.bind(e,t),key:t},r.a.createElement(h.a,{content:\"settings.\"+t}))}))),r.a.createElement(\"div\",{className:\"grid-content\",style:{height:\"100%\"}},r.a.createElement(\"div\",{className:\"grid-block small-12 no-margin vertical\",style:{maxWidth:1e3}},r.a.createElement(h.a,{component:\"h3\",content:\"settings.\"+s[i]}),\"access\"!=u&&r.a.createElement(h.a,{unsafe:!0,style:{paddingTop:5,marginBottom:30},content:\"settings.\"+s[i]+\"_text\",className:\"panel-bg-color\"}),c))),r.a.createElement(_.a,{removeNode:this.state.removeNode,isAddNodeModalVisible:this.state.isAddNodeModalVisible,isRemoveNodeModalVisible:this.state.isRemoveNodeModalVisible,onAddNodeClose:this.hideAddNodeModal,onRemoveNodeClose:this.hideRemoveNodeModal,apis:n.apiServer,api:n.apiServer.filter(function(t){return t.url===e.state.apiServer}).reduce(function(e,t){return t&&t.url},null),changeConnection:function(t){e.setState({apiServer:t})}})))}}]),t}(),pe=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var de=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t),function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),pe(t,[{key:\"render\",value:function(){return r.a.createElement(i.a,{stores:[o.a],inject:{settings:function(){return o.a.getState().settings},viewSettings:function(){return o.a.getState().viewSettings},defaults:function(){return o.a.getState().defaults},localesObject:function(){return s.a.getState().localesObject},apiLatencies:function(){return o.a.getState().apiLatencies}}},r.a.createElement(ue,this.props))}}]),t}();t.default=de},2242:function(e,t,a){\"use strict\";a.r(t);var n=a(0),r=a.n(n),o=a(14),s=a(7),i=a(4),l=a.n(i),c=a(5),u=a(15),p=a(574),d=a(327),m=a(2),h=a.n(m),f=a(1949),_=(a(33),a(1952)),g=(a(11),a(140),a(1)),b=a.n(g),y=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function v(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}var w=function(e){function t(){var e,a,n;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);for(var r=arguments.length,o=Array(r),s=0;s<r;s++)o[s]=arguments[s];return a=n=v(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),n.onInputChange=function(e){var t=n.props,a=t.onChange,r=t.periodType;a&&a({amount:n.getNumericEventValue(e),type:r})},n.onTypeChange=function(e){var t=n.props,a=t.onChange,r=t.inputValue;a&&a({amount:r,type:e})},v(n,a)}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),y(t,[{key:\"getNumericEventValue\",value:function(e){return\"\"==e.target.value||null==e.target.value||e.target.value<0?\"\":0===e.target.value?0:parseFloat(e.target.value)==e.target.value?e.target.value.trim():parseFloat(e.target.value.trim().replace(/[^\\d.-]/g,\"\"))||0}},{key:\"render\",value:function(){var e=this.props,t=e.inputValue,a=e.values,n=e.entries,o=e.periodType,s=e.tabIndex,i=e.placeholder,l=e.disabled,c=e.scroll_length;return r.a.createElement(\"div\",{className:\"amount-selector\",style:this.props.style},r.a.createElement(h.a,{className:\"left-label\",component:\"label\",content:this.props.label}),r.a.createElement(\"div\",{className:\"inline-label input-wrapper\"},r.a.createElement(\"span\",{className:\"input-addon-before\"},\"Each\"),r.a.createElement(\"input\",{disabled:l,type:\"number\",value:t||\"\",placeholder:i,onChange:this.onInputChange,tabIndex:s,style:{paddingLeft:\"70px\"}}),r.a.createElement(\"div\",{className:\"form-label select floating-dropdown\"},r.a.createElement(_.a,{entries:n,values:a,value:o&&o.name,onChange:this.onTypeChange,scroll_length:c}))))}}]),t}();w.propTypes={label:b.a.string,placeholder:b.a.string,onChange:b.a.func,tabIndex:b.a.number,error:b.a.string,scroll_length:b.a.number},w.defaultProps={disabled:!1,tabIndex:0};var E=w,k=a(24),S=a(270),C=a(75),O=a(37),x=a(152),A=a(357),j=a(31),N=a(799),M=a(233),T=a(29),P=a.n(T),B=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var I=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.onSubmit=function(e){e.preventDefault();var t=a.state,n=t.feeAsset,r=(t.feeAmount,t.from_account),o=t.to_account,s=t.amount,i=t.asset,l=t.asset_id,c=t.period,p=t.num_of_periods,d=t.period_start_time,m=t.permissionId,h=a.props.operation.type;\"create\"===h?M.a.createWithdrawPermission(r,o,l,u.a.convert_typed_to_satoshi(s,i),c.type.seconds*Number(c.amount),p,d.valueOf(),n?n.get(\"id\"):\"1.3.0\").then(function(e){a.props.hideModal()}).catch(function(e){console.error(e)}):\"update\"===h&&M.a.updateWithdrawPermission(m,r,o,l,u.a.convert_typed_to_satoshi(s,i),c.type.seconds*Number(c.amount),p,d.valueOf(),n?n.get(\"id\"):\"1.3.0\").then(function(e){a.props.hideModal()}).catch(function(e){console.error(e)})},a.onToAccountChanged=function(e){a.setState({to_account:e,error:null})},a.onAmountChanged=function(e){var t=e.amount,n=e.asset;n&&a.setState({amount:t,asset:n,asset_id:n.get(\"id\"),error:null,maxAmount:!1},a._checkBalance)},a.toChanged=function(e){a.setState({to_name:e,error:null})},a.onNumOfPeriodsChanged=function(e){var t=parseInt(e.target.value,10);!Object(p.a)(t)&&\"number\"==typeof t&&t>=0&&a.setState({num_of_periods:t})},a.onPeriodChanged=function(e){var t=e.amount,n=e.type;a.setState({period:{amount:t,type:n}})},a.onStartDateChanged=function(e){e?a.setState({period_start_time:e}):a.setState({period_start_time:null})},a.state=a.getInitialState(e),a.onTrxIncluded=a.onTrxIncluded.bind(a),a._updateFee=Object(d.a)(a._updateFee.bind(a),250),a._checkFeeStatus=a._checkFeeStatus.bind(a),a._checkBalance=a._checkBalance.bind(a),a._isMounted=!1,a}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),B(t,[{key:\"getInitialState\",value:function(){return{to_name:\"\",from_account:null,to_account:null,amount:\"\",asset_id:null,asset:null,error:null,feeAsset:null,fee_asset_id:\"1.3.0\",feeAmount:new O.a({amount:0}),feeStatus:{},maxAmount:!1,num_of_periods:\"\",period:{amount:\"\",type:{seconds:604800,name:\"Week\"}},period_start_time:P()().add(\"seconds\",120),permissionId:\"\",balanceError:!1}}},{key:\"componentDidMount\",value:function(){this._isMounted=!0}},{key:\"componentDidUpdate\",value:function(e,t){var a=this,n=this.props.operation;if(this.props.isModalVisible&&e.isModalVisible!==this.props.isModalVisible?this.setState({from_account:c.ChainStore.getAccount(this.props.currentAccount)},function(){a._updateFee(),a._checkFeeStatus(a.state)}):this.props.isModalVisible||e.isModalVisible===this.props.isModalVisible||this.setState(this.getInitialState()),n&&\"update\"===n.type&&n.payload.id!==t.permissionId){var r=c.ChainStore.getAccount(n.payload.authorized_account);if(r&&r.get){for(var o=P.a.utc(n.payload.period_start_time).valueOf(),s=(P.a.utc(n.payload.expiration).valueOf()-o)/(1e3*n.payload.withdrawal_period_sec),i=[{seconds:604800,name:\"Week\"},{seconds:86400,name:\"Day\"},{seconds:3600,name:\"Hour\"},{seconds:60,name:\"Minute\"}],l=void 0,p=void 0,d=void 0,m=0;m<i.length;m++)if(n.payload.withdrawal_period_sec>=i[m].seconds){var h=i[m];p=h.name,l=h.seconds,d=Math.round(n.payload.withdrawal_period_sec/h.seconds);break}var f=c.ChainStore.getAsset(n.payload.withdrawal_limit.asset_id);this.setState({to_account:r,to_name:r.get(\"name\"),asset:f,permissionId:n.payload.id,amount:u.a.convert_satoshi_to_typed(n.payload.withdrawal_limit.amount,f),asset_id:n.payload.withdrawal_limit.asset_id,num_of_periods:s,period:{amount:d,type:{seconds:l,name:p}},period_start_time:P.a.utc(n.payload.period_start_time)})}}}},{key:\"componentWillUnmount\",value:function(){this._isMounted=!1}},{key:\"_checkBalance\",value:function(){var e=this.state,t=e.feeAmount,a=e.amount,n=e.from_account,r=e.asset;if(r&&n){this._updateFee();var o=n.getIn([\"balances\",r.get(\"id\")]),s=n.getIn([\"balances\",t.asset_id]);if(r&&n){if(!o)return this.setState({balanceError:!0});var i=c.ChainStore.getObject(o),l=s?c.ChainStore.getObject(s):null;if(l&&0!==l.get(\"balance\")||this.setState({fee_asset_id:\"1.3.0\"},this._updateFee),i&&t){if(!a)return this.setState({balanceError:!1});var u=Object(x.a)(a,r,t,i);null!==u&&this.setState({balanceError:!u})}}}}},{key:\"_checkFeeStatus\",value:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state).from_account,a=this.props,n=a.isModalVisible,r=a.operation;if(t&&n){var o=Object.keys(t.get(\"balances\").toJS()).sort(u.a.sortID),s={},i=[];o.forEach(function(e){i.push(Object(x.b)({accountID:t.get(\"id\"),feeID:e,type:r&&\"update\"===r.type?\"withdraw_permission_update\":\"withdraw_permission_create\",data:{type:\"memo\",content:null}}))}),Promise.all(i).then(function(t){o.forEach(function(e,a){s[e]=t[a]}),u.a.are_equal_shallow(e.state.feeStatus,s)||e.setState({feeStatus:s}),e._checkBalance()}).catch(function(e){console.error(e)})}}},{key:\"_setTotal\",value:function(e,t){var a=this.state.feeAmount,n=c.ChainStore.getObject(t),r=c.ChainStore.getObject(e),o=new O.a({amount:n.get(\"balance\"),asset_id:r.get(\"id\"),precision:r.get(\"precision\")});n&&(a.asset_id===o.asset_id&&o.minus(a),this.setState({maxAmount:!0,amount:o.getAmount({real:!0})},this._checkBalance))}},{key:\"_getAvailableAssets\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state,t=this.state.feeStatus;var a=e.from_account,n=[],r=[];if(!a||!a.get(\"balances\"))return{asset_types:n,fee_asset_types:r};var o=e.from_account.get(\"balances\").toJS();for(var s in n=Object.keys(o).sort(u.a.sortID),r=Object.keys(o).sort(u.a.sortID),o){var i=c.ChainStore.getObject(o[s]);i&&0===i.get(\"balance\")&&(n.splice(n.indexOf(s),1),-1!==r.indexOf(s)&&r.splice(r.indexOf(s),1))}return{asset_types:n,fee_asset_types:r=r.filter(function(e){return function(e){return void 0===t[e]||t[e]&&t[e].hasPoolBalance}(e)&&function(e){return void 0===t[e]||t[e]&&t[e].hasBalance}(e)})}}},{key:\"_updateFee\",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state;if(this.props.isModalVisible){var a=this.props.operation,n=t.fee_asset_id,r=t.from_account,o=t.asset_id,s=this._getAvailableAssets(t).fee_asset_types;if(1===s.length&&s[0]!==n&&(n=s[0]),!r)return null;Object(x.b)({accountID:r.get(\"id\"),feeID:n,type:a&&\"update\"===a.type?\"withdraw_permission_update\":\"withdraw_permission_create\",data:{type:\"memo\",content:null}}).then(function(t){var a=t.fee,n=t.hasBalance,s=t.hasPoolBalance;Object(x.e)(r,a).then(function(t){return t?e.setState({fee_asset_id:o},e._updateFee):e.setState({feeAmount:a,fee_asset_id:a.asset_id,hasBalance:n,hasPoolBalance:s,error:!n||!s})})})}}},{key:\"onFeeChanged\",value:function(e){var t=e.asset;this.setState({feeAsset:t,fee_asset_id:t.get(\"id\"),error:null},this._updateFee)}},{key:\"onTrxIncluded\",value:function(e){e.included&&e.broadcasted_transaction?(C.a.unlisten(this.onTrxIncluded),C.a.reset()):e.closed&&(C.a.unlisten(this.onTrxIncluded),C.a.reset())}},{key:\"onDatepickerRef\",value:function(e){e&&e.picker.input&&(e.picker.input.readOnly=!1)}},{key:\"render\",value:function(){var e=this,t=this.state,a=t.from_account,n=t.to_account,o=t.asset,i=t.asset_id,u=t.feeAmount,d=t.amount,m=(t.error,t.to_name),_=t.feeAsset,g=t.fee_asset_id,b=t.balanceError,y=t.num_of_periods,v=t.period,w=t.period_start_time,k=this.props.operation,C=this._getAvailableAssets(),O=C.asset_types,x=C.fee_asset_types,j=null,M=null,T=this.state.feeAmount.getAmount({real:!0});if(a&&a.get(\"balances\")){var B=a.get(\"balances\").toJS(),I=this.state.balanceError?\"has-error\":\"\";if(1===O.length&&(o=c.ChainStore.getAsset(O[0])),O.length>0){var D=o?o.get(\"id\"):O[0],R=_?_.get(\"id\"):\"1.3.0\";j=r.a.createElement(\"span\",null,r.a.createElement(h.a,{component:\"span\",content:\"transfer.available\"}),\":\",\" \",r.a.createElement(\"span\",{className:I,style:{borderBottom:\"#A09F9F 1px dotted\",cursor:\"pointer\"},onClick:this._setTotal.bind(this,D,B[D],T,R)},r.a.createElement(A.a,{balance:B[D]}))),R==D&&this.state.balanceError&&(M=r.a.createElement(\"span\",null,r.a.createElement(\"span\",{className:I},r.a.createElement(h.a,{content:\"transfer.errors.insufficient\"}))))}else j=r.a.createElement(\"span\",null,r.a.createElement(\"span\",{className:I},r.a.createElement(h.a,{content:\"transfer.errors.noFunds\"}))),M=r.a.createElement(\"span\",null,r.a.createElement(\"span\",{className:I},r.a.createElement(h.a,{content:\"transfer.errors.noFunds\"})))}var F=parseFloat(String.prototype.replace.call(d,/,/g,\"\")),V=F&&!Object(p.a)(F),z=!a||!n||!V||!o||b||a.get(\"id\")==n.get(\"id\")||!v.amount||!y||!w;return r.a.createElement(s.Modal,{title:k&&\"create\"===k.type?l.a.translate(\"showcases.direct_debit.create_new_mandate\"):l.a.translate(\"showcases.direct_debit.update_mandate\"),visible:this.props.isModalVisible,overlay:!0,onCancel:this.props.hideModal,footer:[r.a.createElement(s.Button,{key:\"send\",disabled:z,onClick:z?null:this.onSubmit.bind(this)},k&&\"create\"===k.type?l.a.translate(\"showcases.direct_debit.create\"):l.a.translate(\"showcases.direct_debit.update\")),r.a.createElement(s.Button,{key:\"Cancel\",onClick:this.props.hideModal},r.a.createElement(h.a,{component:\"span\",content:\"transfer.cancel\"}))]},r.a.createElement(\"div\",{className:\"grid-block vertical no-overflow\"},r.a.createElement(\"form\",{noValidate:!0},r.a.createElement(\"div\",null,r.a.createElement(s.Tooltip,{title:l.a.translate(\"showcases.direct_debit.tooltip.authorized_account\"),mouseEnterDelay:.5},r.a.createElement(\"div\",{className:\"content-block\"},r.a.createElement(S.a,{label:\"showcases.direct_debit.authorized_account\",accountName:m,account:n,onChange:this.toChanged.bind(this),onAccountChanged:this.onToAccountChanged,size:60,typeahead:!0,hideImage:!0})))),r.a.createElement(s.Tooltip,{title:l.a.translate(\"showcases.direct_debit.tooltip.limit_per_period\"),mouseEnterDelay:.5},r.a.createElement(\"div\",{className:\"content-block transfer-input\"},r.a.createElement(f.a,{label:\"showcases.direct_debit.limit_per_period\",amount:d,onChange:this.onAmountChanged,asset:O.length>0&&o?o.get(\"id\"):i||O[0],assets:O,display_balance:j,allowNaN:!0}))),r.a.createElement(s.Tooltip,{title:l.a.translate(\"showcases.direct_debit.tooltip.period\"),mouseEnterDelay:.5},r.a.createElement(\"div\",{className:\"content-block transfer-input\"},r.a.createElement(E,{label:\"showcases.direct_debit.period\",inputValue:v.amount,entries:[\"Minute\",\"Hour\",\"Day\",\"Week\"],values:{Minute:{seconds:60,name:\"Minute\"},Hour:{seconds:3600,name:\"Hour\"},Day:{seconds:86400,name:\"Day\"},Week:{seconds:604800,name:\"Week\"}},periodType:v.type,onChange:this.onPeriodChanged}))),r.a.createElement(s.Tooltip,{title:l.a.translate(\"showcases.direct_debit.tooltip.num_of_periods\"),mouseEnterDelay:.5},r.a.createElement(\"div\",{className:\"content-block transfer-input\"},r.a.createElement(\"label\",{className:\"left-label\"},l.a.translate(\"showcases.direct_debit.num_of_periods\")),r.a.createElement(\"input\",{type:\"number\",value:y,onChange:this.onNumOfPeriodsChanged}))),r.a.createElement(\"div\",{className:\"content-block transfer-input\"},r.a.createElement(\"label\",{className:\"left-label\"},l.a.translate(\"showcases.direct_debit.start_date\")),r.a.createElement(s.Tooltip,{title:l.a.translate(\"showcases.direct_debit.tooltip.start_time\"),mouseEnterDelay:.5},r.a.createElement(N.a,{value:w,showToday:!1,showTime:!0,placeholder:\"\",onChange:this.onStartDateChanged,className:\"date-picker-width100\",style:{width:\"100%\"},ref:function(t){return e.onDatepickerRef(t)},disabledDate:function(e){return e&&e<P()().add(2,\"minutes\")}}))),r.a.createElement(\"div\",{className:\"content-block transfer-input\"},r.a.createElement(\"div\",{className:\"no-margin no-padding\"},r.a.createElement(\"div\",{id:\"txFeeSelector\",className:\"small-12\"},r.a.createElement(f.a,{label:\"transfer.fee\",disabled:!0,amount:T,onChange:this.onFeeChanged.bind(this),asset:x.length&&u?u.asset_id:1===x.length?x[0]:g||x[0],assets:x,display_balance:M,error:!1===this.state.hasPoolBalance?\"transfer.errors.insufficient\":null,scroll_length:2})))))))}}]),t}(),D=Object(j.a)(I,{listenTo:function(){return[k.a]},getProps:function(){return{currentAccount:k.a.getState().currentAccount,passwordAccount:k.a.getState().passwordAccount}}}),R=a(2222),F=a(178),V=a(2010),z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},L=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var W=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.showModal=function(e){return function(){a.setState({isModalVisible:!0,operationData:e})}},a.hideModal=function(){a.setState({isModalVisible:!1,operation:null})},a.showClaimModal=function(e){return function(){a.setState({isClaimModalVisible:!0,operationClaimData:e})}},a.hideClaimModal=function(){a.setState({isClaimModalVisible:!1})},a._onFilter=function(e){e.preventDefault(),a.setState({filterString:e.target.value.toLowerCase()})},a.handleDeleteProposal=function(e){console.log(\"delete permissin\"),M.a.deleteWithdrawPermission(e.id,e.withdraw_from_account,e.authorized_account).then(function(){}).catch(function(e){a.setState({errorMessage:e.toString()}),console.error(e)})},a.state={isModalVisible:!1,isClaimModalVisible:!1,filterString:\"\",operationData:\"\",operationClaimData:\"\",withdraw_permission_list:[]},a}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n[\"Component\"]),L(t,[{key:\"_update\",value:function(){var e=this,t=this.props.currentAccount;Object(V.b)(t)&&Promise.all([o.Apis.instance().db_api().exec(\"get_withdraw_permissions_by_giver\",[t.get(\"id\"),\"1.12.0\",100]),o.Apis.instance().db_api().exec(\"get_withdraw_permissions_by_recipient\",[t.get(\"id\"),\"1.12.0\",100])]).then(function(t){var a=[];(a=(a=a.concat(t[0])).concat(t[1])).forEach(function(e){try{c.ChainStore.getAccount(e.authorized_account,!1),c.ChainStore.getAccount(e.withdraw_from_account,!1)}catch(e){}}),e.setState({withdraw_permission_list:a})})}},{key:\"componentDidMount\",value:function(){this._update()}},{key:\"componentWillReceiveProps\",value:function(){this._update()}},{key:\"render\",value:function(){var e=this,t=this.state,a=t.isModalVisible,n=t.isClaimModalVisible,o=t.withdraw_permission_list,i=t.operationData,p=t.operationClaimData,d=t.filterString,m=this.props.currentAccount,h=null;o.length&&(h=o.map(function(e){var t=c.ChainStore.getObject(e.withdrawal_limit.asset_id,!1),a=c.ChainStore.getAccountName(e.authorized_account),n=c.ChainStore.getAccountName(e.withdraw_from_account),o=new Date(e.period_start_time+\"Z\").getTime(),s=(new Date).getTime()-o,i=\"\",p=1e3*e.withdrawal_period_sec;s<0?console.log(\"first period is not started\"):i=o+p*Math.ceil(s/p);return{key:e.id,id:e.id,type:e.authorized_account==m.get(\"id\")?\"payee\":\"payer\",authorized:a,from:n,to:a,limit:r.a.createElement(\"span\",null,u.a.get_asset_amount(e.withdrawal_limit.amount,t)+\" \",r.a.createElement(F.a,{asset:e.withdrawal_limit.asset_id})),until:i?l.a.localize(new Date(i),{type:\"date\",format:\"full\"}):l.a.translate(\"showcases.direct_debit.first_period_not_started\"),expires:l.a.localize(new Date(e.expiration+\"Z\"),{type:\"date\",format:\"full\"}),claimed:0==e.claimed_this_period?\"-\":r.a.createElement(\"span\",null,u.a.get_asset_amount(e.claimed_this_period,t)+\" \",r.a.createElement(F.a,{asset:e.withdrawal_limit.asset_id})),rawData:z({},e)}})).length&&h.filter(function(e){return e.authorized&&-1!==e.authorized.indexOf(d)});var f=[{title:\"#\",dataIndex:\"id\",key:\"id\",sorter:function(e,t){return e.id>t.id?1:e.id<t.id?-1:0}},{title:\"From\",dataIndex:\"from\",key:\"from\",sorter:function(e,t){return e.from>t.from?1:e.from<t.from?-1:0}},{title:\"To\",dataIndex:\"to\",key:\"to\",sorter:function(e,t){return e.to>t.to?1:e.to<t.to?-1:0}},{title:l.a.translate(\"showcases.direct_debit.current_period_expires\"),dataIndex:\"until\",key:\"until\",sorter:function(e,t){return e.until>t.until?1:e.until<t.until?-1:0}},{title:\"Limit\",dataIndex:\"limit\",key:\"limit\",sorter:function(e,t){return e.rawData.withdrawal_limit.amount-t.rawData.withdrawal_limit.amount}},{title:\"Claimed\",dataIndex:\"claimed\",key:\"claimed\",sorter:function(e,t){var a=e.rawData.claimed_this_period;return e.rawData.claimed_this_period-a}},{title:l.a.translate(\"showcases.direct_debit.expires\"),dataIndex:\"expires\",key:\"expires\",sorter:function(e,t){return e.expires>t.expires?1:e.expires<t.expires?-1:0}},{title:\"Actions\",dataIndex:\"action\",key:\"action\",render:function(t,a){return a.type?\"payer\"===a.type?r.a.createElement(\"span\",null,r.a.createElement(s.Button,{style:{marginRight:\"10px\"},onClick:function(){return e.handleDeleteProposal(a.rawData)}},l.a.translate(\"showcases.direct_debit.delete\")),r.a.createElement(s.Button,{onClick:e.showModal({type:\"update\",payload:a.rawData})},l.a.translate(\"showcases.direct_debit.update\"))):r.a.createElement(\"span\",{onClick:e.showClaimModal({type:\"claim\",payload:a.rawData})},r.a.createElement(s.Button,null,l.a.translate(\"showcases.direct_debit.claim\"))):null}}];return r.a.createElement(\"div\",{className:\"direct-debit-view\"},r.a.createElement(s.Card,{className:\"direct-debit-table-card\"},r.a.createElement(s.Row,null,r.a.createElement(s.Col,{span:24,style:{padding:\"10px\"}},r.a.createElement(\"div\",{style:{marginBottom:\"30px\"}},r.a.createElement(s.Input,{className:\"direct-debit-table__filter-input\",placeholder:l.a.translate(\"explorer.witnesses.filter_by_name\"),onChange:this._onFilter,style:{width:\"200px\",marginRight:\"30px\"},addonAfter:r.a.createElement(s.Icon,{type:\"search\"})}),r.a.createElement(s.Button,{onClick:this.showModal({type:\"create\",payload:null}),style:{marginRight:\"30px\"}},l.a.translate(\"showcases.direct_debit.create_new_mandate\")),!!this.state.errorMessage&&r.a.createElement(\"span\",{className:\"red\"},this.state.errorMessage)),r.a.createElement(s.Table,{columns:f,dataSource:h,pagination:!1,className:\"direct-debit-table\"}))),r.a.createElement(D,{isModalVisible:a,hideModal:this.hideModal,operation:i}),r.a.createElement(R.a,{isModalVisible:n,hideModal:this.hideClaimModal,operation:p})))}}]),t}();W=Object(V.a)(W);t.default=W},2246:function(e,t,a){\"use strict\";a.r(t);var n=a(0),r=a.n(n),o=a(7),s=a(4),i=a.n(s),l=a(5),c=a(15),u=a(574),p=a(327),d=a(2),m=a.n(d),h=a(330),f=a(3),_=a.n(f),g=a(270),b=a(75),y=a(37),v=a(152),w=a(357),E=a(133),k=a(29),S=a.n(k),C=a(2054),O=(a(2220),a(43)),x=a(1),A=a.n(x),j=a(2010),N=\"function\"==typeof Symbol&&\"symbol\"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&\"function\"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?\"symbol\":typeof e},M=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function T(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}function P(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}function B(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var I=function(e){function t(e){T(this,t);var a=P(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state=a.getInitialState(),a.hasRandomHash=!1,a}return B(t,r.a.Component),M(t,[{key:\"getInitialState\",value:function(){return{stage:1,preimage_hash_calculated:null,ciphers:[\"sha256\",\"ripemd160\"]}}},{key:\"componentDidMount\",value:function(){this.props.preimage_hash||this.hasRandomHash||this.generateRandom({target:{}})}},{key:\"componentDidUpdate\",value:function(e,t){e.preimage_hash===this.props.preimage_hash||this.props.preimage_hash||(this.hasRandomHash=!1),this.props.preimage_hash||this.hasRandomHash||this.generateRandom({target:{}})}},{key:\"onClick\",value:function(e){var t=this,a=!1;this.state.stage!==e.target.value&&1==e.target.value&&(a=!0),this.setState({stage:e.target.value},function(){return a?t.generateRandom():null})}},{key:\"onSizeChanged\",value:function(e){this.props.onAction({preimage_size:e.target.value?parseInt(e.target.value):null})}},{key:\"onHashChanged\",value:function(e){this.props.onAction({preimage_hash:e.target.value})}},{key:\"onInputChanged\",value:function(e){var t=this.props,a=t.preimage,n=t.preimage_cipher;if(n||(n=\"sha256\"),e.target?(a=e.target.value,this.hashingInProgress=!1):n=e,2==this.state.stage)this.props.onAction({preimage_cipher:n});else{var r=C.a.calculateHash(a,n).hash;\"create\"!==this.props.type?(this.props.onAction({preimage:a,preimage_cipher:n,preimage_size:a.length}),this.setState({preimage_hash_calculated:r})):this.props.onAction({preimage:a,preimage_cipher:n,preimage_hash:r,preimage_size:a.length})}}},{key:\"generateRandom\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{target:{}};this.hasRandomHash=!0,e.target.value=l.key.get_random_key().toWif().substr(10,30),this.onInputChanged(e)}},{key:\"render\",value:function(){var e=r.a.createElement(r.a.Fragment,null,i.a.translate(this.props.label),\"create\"==this.props.type&&r.a.createElement(o.Radio.Group,{value:this.state.stage,onChange:this.onClick.bind(this),style:{marginBottom:\"7px\",marginLeft:\"24px\"}},r.a.createElement(o.Radio,{value:1},r.a.createElement(m.a,{content:\"showcases.htlc.first_stage\"})),r.a.createElement(o.Radio,{value:2},r.a.createElement(m.a,{content:\"showcases.htlc.second_stage\"})),r.a.createElement(o.Radio,{value:3},r.a.createElement(m.a,{content:\"showcases.htlc.custom\"})))),t=\"create\"!==this.props.type&&null!==this.state.preimage_hash_calculated?this.state.preimage_hash_calculated==this.props.preimage_hash:null;return r.a.createElement(o.Form.Item,{label:e},r.a.createElement(\"span\",null,i.a.translate(\"showcases.htlc.preimage_has_been_created\")),r.a.createElement(o.Input.Group,{className:\"content-block transfer-input preimage-row\"},r.a.createElement(o.Tooltip,{title:i.a.translate(\"create\"!==this.props.type?\"showcases.htlc.tooltip.enter_preimage\":\"showcases.htlc.tooltip.preimage_random\"),mouseEnterDelay:.5},r.a.createElement(o.Input,{style:{width:\"60%\",color:null==t?void 0:t?\"green\":\"red\"},name:\"preimage\",id:\"preimage\",type:\"text\",onChange:this.onInputChanged.bind(this),value:2==this.state.stage?\"\":this.props.preimage,placeholder:i.a.translate(this.props.hash?\"showcases.htlc.enter_secret_preimage\":\"showcases.htlc.preimage\"),disabled:\"create\"===this.props.type&&(1==this.state.stage||2==this.state.stage)})),r.a.createElement(o.Select,{optionLabelProp:\"value\",style:{width:\"19.5%\"},onChange:this.onInputChanged.bind(this),value:this.props.preimage_cipher},this.state.ciphers.map(function(e){return r.a.createElement(o.Select.Option,{key:e,value:e},e)})),r.a.createElement(o.Tooltip,{title:i.a.translate(\"showcases.htlc.tooltip.new_random\"),mouseEnterDelay:.5},r.a.createElement(o.Button,{type:\"primary\",icon:\"deployment-unit\",style:{verticalAlign:\"top\"},onClick:this.generateRandom.bind(this)})),r.a.createElement(\"div\",{style:{float:\"right\"}},r.a.createElement(E.a,{dataPlace:\"top\",text:\"preimage: \"+this.props.preimage+\" hash type: \"+this.props.preimage_cipher}))),r.a.createElement(o.Input.Group,{className:\"content-block transfer-input preimage-row\"},r.a.createElement(o.Tooltip,{title:i.a.translate(\"showcases.htlc.tooltip.preimage_hash\"),mouseEnterDelay:.5},r.a.createElement(o.Input,{style:{width:\"78%\"},name:\"hash\",id:\"hash\",type:\"text\",onChange:this.onHashChanged.bind(this),value:this.props.preimage_hash||\"\",placeholder:i.a.translate(\"showcases.htlc.hash\"),disabled:1==this.state.stage})),r.a.createElement(o.Tooltip,{title:i.a.translate(\"showcases.htlc.tooltip.preimage_size\"),mouseEnterDelay:.5},r.a.createElement(o.Input,{style:{width:\"53px\",marginRight:\"0.2rem\"},name:\"size\",id:\"size\",type:\"text\",onChange:this.onSizeChanged.bind(this),value:this.props.preimage_size||\"\",placeholder:i.a.translate(\"showcases.htlc.size\"),disabled:1==this.state.stage})),r.a.createElement(\"div\",{style:{float:\"right\"}},r.a.createElement(E.a,{dataPlace:\"top\",text:\"hash: \"+this.props.preimage_hash+\" preimage size: \"+this.props.preimage_size}))))}}]),t}();I.propTypes={preimage_hash:A.a.string,preimage_size:A.a.number,preimage:A.a.string,preimage_cipher:A.a.string};var D=function(e){function t(e){T(this,t);var a=P(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.onSubmit=function(e){e.preventDefault();var t=a.state,n=t.from_account,r=t.to_account,o=t.amount,s=t.asset,i=t.asset_id,l=t.preimage,u=t.preimage_size,p=t.preimage_hash,d=t.preimage_cipher,m=t.claim_period,h=a.props.operation.type;\"create\"===h?C.a.create({from_account_id:n.get(\"id\"),to_account_id:r.get(\"id\"),asset_id:i,amount:c.a.convert_typed_to_satoshi(o,s),lock_time:m,preimage:l,preimage_size:u,preimage_hash:p,preimage_cipher:d}).then(function(e){a.props.hideModal()}).catch(function(e){console.error(e)}):\"redeem\"===h?C.a.redeem({htlc_id:a.props.operation.payload.id,user_id:r.get(\"id\"),preimage:l}).then(function(e){a.props.hideModal()}).catch(function(e){console.error(e)}):\"extend\"===h&&C.a.extend({htlc_id:a.props.operation.payload.id,user_id:n.get(\"id\"),seconds_to_add:m}).then(function(e){a.props.hideModal()}).catch(function(e){console.error(e)})},a.onToAccountChanged=function(e){a.setState({to_account:e,error:null})},a.onAmountChanged=function(e){var t=e.amount,n=e.asset;n&&(\"object\"!==(void 0===n?\"undefined\":N(n))&&(n=l.ChainStore.getAsset(n)),a.setState({amount:t,asset:n,asset_id:n.get(\"id\"),error:null,maxAmount:!1},a._checkBalance))},a.toChanged=function(e){a.setState({to_name:e,error:null})},a.onExpirationDateChanged=function(e){if(e){var t=a.state.period_start_time,n=e.valueOf(),r=t.valueOf(),o=Math.floor((n-r)/1e3);a.setState({claim_period:o,period:null,expirationDate:e})}else a.setState({claim_period:0,period:null,expirationDate:null})},a.setPeriod=function(e){var t=S()().add(e,\"day\"),n=\"one_day\",r=60*e*60*24;switch(e){case 1:n=\"one_day\";break;case 2:n=\"two_days\";break;case 7:n=\"one_week\"}a.setState({claim_period:r,period:n,expirationDate:t})},a.state=a.getInitialState(e),a.onTrxIncluded=a.onTrxIncluded.bind(a),a._updateFee=Object(p.a)(a._updateFee.bind(a),250),a._checkFeeStatus=a._checkFeeStatus.bind(a),a._checkBalance=a._checkBalance.bind(a),a}return B(t,r.a.Component),M(t,[{key:\"getInitialState\",value:function(){var e=S()().add(\"seconds\",120);return{from_name:\"\",to_name:\"\",from_account:null,to_account:null,amount:\"\",asset_id:null,asset:null,error:null,feeAsset:null,fee_asset_id:\"1.3.0\",feeAmount:new y.a({amount:0}),feeStatus:{},maxAmount:!1,num_of_periods:\"\",period_start_time:e,htlcId:\"\",balanceError:!1,preimage:null,preimage_cipher:null,preimage_hash:null,preimage_size:null,claim_period:86400,period:\"one_day\",expirationDate:S()().add(\"seconds\",180).add(1,\"day\")}}},{key:\"shouldComponentUpdate\",value:function(e,t,a){return!(e.fromAccount&&!Object(j.b)(e.fromAccount))}},{key:\"_syncOperation\",value:function(e){if(e&&e.payload&&\"create\"!==e.type){var t=e.payload.transfer.to,a=e.payload.transfer.from,n={amount:e.payload.transfer.amount,asset_id:e.payload.transfer.asset_id},r=new Date(e.payload.conditions.time_lock.expiration),o=l.ChainStore.getAccount(t),s=l.ChainStore.getAccount(a);if(o&&s&&o.get&&s.get){var i=l.ChainStore.getAsset(n.asset_id,!1);this.setState({to_account:o,to_name:o.get(\"name\"),from_account:s,from_name:s.get(\"name\"),asset:i,amount:c.a.convert_satoshi_to_typed(n.amount,i),asset_id:n.asset_id,period_start_time:r,htlcId:e.payload.id,preimage_hash:e.payload.conditions.hash_lock.preimage_hash[1],preimage_size:e.payload.conditions.hash_lock.preimage_hash[0]})}else this.setState({htlcId:e.payload.id,preimage_hash:e.payload.conditions.hash_lock.preimage_hash[1],preimage_size:e.payload.conditions.hash_lock.preimage_hash[0]})}else this.setState({htlcId:null,preimage_hash:null,preimage_size:null})}},{key:\"componentDidMount\",value:function(){this._syncOperation(this.props.operation)}},{key:\"componentDidUpdate\",value:function(e,t){var a=this,n=this.props.operation;this.props.fromAccount===e.fromAccount&&null!=this.state.from_account||this.setState({from_account:this.props.fromAccount,from_name:this.props.fromAccount.get(\"name\")},function(){a._updateFee(),a._checkFeeStatus(a.state)}),e.operation!==this.props.operation&&this._syncOperation(n)}},{key:\"_checkBalance\",value:function(){var e=this.state,t=e.feeAmount,a=e.amount,n=e.from_account,r=e.asset;if(r&&n){this._updateFee();var o=n.getIn([\"balances\",r.get(\"id\")]),s=n.getIn([\"balances\",t.asset_id]);if(r&&n){if(!o)return this.setState({balanceError:!0});var i=l.ChainStore.getObject(o),c=s?l.ChainStore.getObject(s):null;if(c&&0!==c.get(\"balance\")||this.setState({fee_asset_id:\"1.3.0\"},this._updateFee),i&&t){if(!a)return this.setState({balanceError:!1});var u=Object(v.a)(a,r,t,i);null!==u&&this.setState({balanceError:!u})}}}}},{key:\"_checkFeeStatus\",value:function(){var e=this,t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state).from_account,a=this.props,n=a.isModalVisible,r=a.operation;if(t&&n){var o=Object.keys(t.get(\"balances\").toJS()).sort(c.a.sortID),s={},i=[];o.forEach(function(e){i.push(Object(v.b)({accountID:t.get(\"id\"),feeID:e,type:r&&\"create\"===r.type?\"htlc_create\":r&&\"redeem\"===r.type?\"htlc_redeem\":\"htlc_extend\",data:{type:\"memo\",content:null}}))}),Promise.all(i).then(function(t){o.forEach(function(e,a){s[e]=t[a]}),c.a.are_equal_shallow(e.state.feeStatus,s)||e.setState({feeStatus:s}),e._checkBalance()}).catch(function(e){console.error(e)})}}},{key:\"_setTotal\",value:function(e,t){var a=this.state.feeAmount,n=l.ChainStore.getObject(t),r=l.ChainStore.getObject(e),o=new y.a({amount:n.get(\"balance\"),asset_id:r.get(\"id\"),precision:r.get(\"precision\")});n&&(a.asset_id===o.asset_id&&o.minus(a),this.setState({maxAmount:!0,amount:o.getAmount({real:!0})},this._checkBalance))}},{key:\"_getAvailableAssets\",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state,t=this.state.feeStatus;var a=e.from_account,n=[],r=[];if(!a||!a.get(\"balances\"))return{asset_types:n,fee_asset_types:r};var o=e.from_account.get(\"balances\").toJS();for(var s in n=Object.keys(o).sort(c.a.sortID),r=Object.keys(o).sort(c.a.sortID),o){var i=l.ChainStore.getObject(o[s]);i&&0===i.get(\"balance\")&&(n.splice(n.indexOf(s),1),-1!==r.indexOf(s)&&r.splice(r.indexOf(s),1))}return{asset_types:n,fee_asset_types:r=r.filter(function(e){return function(e){return void 0===t[e]||t[e]&&t[e].hasPoolBalance}(e)&&function(e){return void 0===t[e]||t[e]&&t[e].hasBalance}(e)})}}},{key:\"_updateFee\",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state;if(this.props.isModalVisible){var a=this.props.operation,n=t.fee_asset_id,r=t.from_account,o=t.asset_id,s=this._getAvailableAssets(t).fee_asset_types;if(1===s.length&&s[0]!==n&&(n=s[0]),!r)return null;Object(v.b)({accountID:r.get(\"id\"),feeID:n,type:a&&\"create\"===a.type?\"htlc_create\":a&&\"redeem\"===a.type?\"htlc_redeem\":\"htlc_extend\",data:{type:\"memo\",content:null}}).then(function(t){var a=t.fee,n=t.hasBalance,s=t.hasPoolBalance;Object(v.e)(r,a).then(function(t){return t?e.setState({fee_asset_id:o},e._updateFee):e.setState({feeAmount:a,fee_asset_id:a.asset_id,hasBalance:n,hasPoolBalance:s,error:!n||!s})})})}}},{key:\"onFeeChanged\",value:function(e){var t=e.asset;\"object\"!==(void 0===t?\"undefined\":N(t))&&(t=l.ChainStore.getAsset(t)),this.setState({feeAsset:t,fee_asset_id:t.get(\"id\"),error:null},this._updateFee)}},{key:\"onTrxIncluded\",value:function(e){e.included&&e.broadcasted_transaction?(b.a.unlisten(this.onTrxIncluded),b.a.reset()):e.closed&&(b.a.unlisten(this.onTrxIncluded),b.a.reset())}},{key:\"onDatepickerRef\",value:function(e){e&&e.picker.input&&(e.picker.input.readOnly=!1)}},{key:\"onPreimageChanged\",value:function(e){var t=e.preimage,a=e.preimage_cipher,n=e.preimage_hash,r=e.preimage_size,o={};void 0!==t&&(o.preimage=t),void 0!==a&&(o.preimage_cipher=a),void 0!==n&&(o.preimage_hash=n),void 0!==r&&(o.preimage_size=r),this.setState(o)}},{key:\"render\",value:function(){var e=this,t=this.state,a=t.from_account,n=t.to_account,s=t.asset,c=t.asset_id,p=t.feeAmount,d=t.amount,f=t.from_name,b=t.to_name,y=t.feeAsset,v=t.fee_asset_id,E=t.balanceError,k=t.preimage,S=t.preimage_cipher,C=t.claim_period,O=t.preimage_hash,x=t.preimage_size,A=t.period_start_time,j=t.expirationDate,N=this.props.operation,M=N&&\"extend\"===N.type,T=N&&\"redeem\"===N.type,P=this._getAvailableAssets(),B=P.asset_types,D=P.fee_asset_types,R=null,F=null,V=this.state.feeAmount.getAmount({real:!0});if(a&&a.get(\"balances\")){var z=a.get(\"balances\").toJS(),L=this.state.balanceError?\"has-error\":\"\";if(1===B.length&&(s=l.ChainStore.getAsset(B[0])),B.length>0){var W=s?s.get(\"id\"):B[0],H=y?y.get(\"id\"):\"1.3.0\";R=r.a.createElement(\"span\",null,r.a.createElement(m.a,{component:\"span\",content:\"transfer.available\"}),\":\",\" \",r.a.createElement(\"span\",{className:L,style:{borderBottom:\"#A09F9F 1px dotted\",cursor:\"pointer\"},onClick:this._setTotal.bind(this,W,z[W],V,H)},r.a.createElement(w.a,{balance:z[W]}))),H==W&&this.state.balanceError&&(F=r.a.createElement(\"span\",null,r.a.createElement(\"span\",{className:L},r.a.createElement(m.a,{content:\"transfer.errors.insufficient\"}))))}else R=r.a.createElement(\"span\",null,r.a.createElement(\"span\",{className:L},r.a.createElement(m.a,{content:\"transfer.errors.noFunds\"}))),F=r.a.createElement(\"span\",null,r.a.createElement(\"span\",{className:L},r.a.createElement(m.a,{content:\"transfer.errors.noFunds\"})))}var q=parseFloat(String.prototype.replace.call(d,/,/g,\"\")),U=q&&!Object(u.a)(q),J=!a||!n||!U||!s||E||a.get(\"id\")==n.get(\"id\")||!(S&&k||O)||!C,K=N&&\"create\"===N.type?i.a.translate(\"showcases.htlc.create_htlc\"):M?i.a.translate(\"showcases.htlc.extend_htlc\"):i.a.translate(\"showcases.htlc.redeem_htlc\"),Z=N&&\"create\"===N.type?i.a.translate(\"showcases.direct_debit.create\"):i.a.translate(\"showcases.direct_debit.update\"),G=r.a.createElement(\"div\",{className:\"form-input-header--label\"},i.a.translate(\"showcases.htlc.expiration_date\"),r.a.createElement(\"div\",{className:\"form-input-header--right\"},r.a.createElement(\"span\",{className:_()(\"period-row\",{\"is-active\":\"one_day\"===this.state.period}),onClick:function(){return e.setPeriod(1)}},i.a.translate(\"showcases.htlc.expiration_period.one_day\")),r.a.createElement(\"span\",{className:_()(\"period-row\",{\"is-active\":\"two_days\"===this.state.period}),onClick:function(){return e.setPeriod(2)}},i.a.translate(\"showcases.htlc.expiration_period.two_days\")),r.a.createElement(\"span\",{className:_()(\"period-row\",{\"is-active\":\"one_week\"===this.state.period}),onClick:function(){return e.setPeriod(7)}},i.a.translate(\"showcases.htlc.expiration_period.one_week\"))));return r.a.createElement(o.Modal,{title:K,visible:this.props.isModalVisible,overlay:!0,onCancel:this.props.hideModal,footer:[r.a.createElement(o.Button,{key:\"send\",disabled:J,onClick:J?null:this.onSubmit.bind(this)},Z),r.a.createElement(o.Button,{key:\"Cancel\",onClick:this.props.hideModal},r.a.createElement(m.a,{component:\"span\",content:\"transfer.cancel\"}))]},r.a.createElement(\"div\",{className:\"grid-block vertical no-overflow\"},r.a.createElement(o.Form,{className:\"full-width\",layout:\"vertical\"},r.a.createElement(g.a,{label:\"showcases.htlc.sender\",accountName:f,account:a,size:60,typeahead:!0,hideImage:!0,disabled:!0}),r.a.createElement(g.a,{label:\"showcases.htlc.recipient\",accountName:b,account:n,onChange:this.toChanged.bind(this),onAccountChanged:this.onToAccountChanged,size:60,typeahead:!0,hideImage:!0,disabled:M||T}),T?null:r.a.createElement(h.a,{label:\"showcases.htlc.amount\",amount:d,onChange:this.onAmountChanged.bind(this),asset:B.length>0&&s?s.get(\"id\"):c||B[0],assets:B,display_balance:M||T?void 0:R,allowNaN:!0,disabled:M||T,selectDisabled:M||T}),M?r.a.createElement(o.Form.Item,{label:i.a.translate(\"showcases.htlc.preimage\")},r.a.createElement(o.Input,{type:\"text\",value:O||\"\",placeholder:i.a.translate(\"showcases.htlc.hash\"),readOnly:!0,disabled:!0})):r.a.createElement(I,{ref:function(t){return e.preimage=t},label:\"showcases.htlc.preimage\",onAction:this.onPreimageChanged.bind(this),preimage_hash:O,preimage_size:x,preimage:k,preimage_cipher:S,type:N&&N.type?N.type:\"create\"}),T?null:r.a.createElement(\"div\",null,r.a.createElement(o.Form.Item,{label:G,validateStatus:\"\",className:\"form-input-header\"},r.a.createElement(o.DatePicker,{showToday:!0,showTime:!0,placeholder:\"\",onChange:this.onExpirationDateChanged,className:\"date-picker-width100\",style:{width:\"100%\"},ref:function(t){return e.onDatepickerRef(t)},disabledDate:function(e){return e&&e<A},value:j})),r.a.createElement(\"div\",{className:\"content-block transfer-input\"},r.a.createElement(\"div\",{className:\"no-margin no-padding\"},r.a.createElement(\"div\",{id:\"txFeeSelector\",className:\"small-12\"},r.a.createElement(h.a,{label:\"transfer.fee\",disabled:!0,amount:V,onChange:this.onFeeChanged.bind(this),asset:D.length&&p?p.asset_id:1===D.length?D[0]:v||D[0],assets:D,display_balance:F,error:!1===this.state.hasPoolBalance?\"transfer.errors.insufficient\":null,scroll_length:2}))))))))}}]),t}();D.propTypes={isModalVisible:A.a.bool.isRequired,hideModal:A.a.func.isRequired,fromAccount:O.a.ChainObject.isRequired,operation:A.a.object};var R=D,F=a(178),V=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},z=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function L(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,a){return function n(r,o){try{var s=t[r](o),i=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(i).then(function(e){n(\"next\",e)},function(e){n(\"throw\",e)});e(i)}(\"next\")})}}var W=function(e){function t(e){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.showModal=function(e){return L(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.payload){t.next=7;break}return t.next=3,Object(l.FetchChainObjects)(l.ChainStore.getAccount,[e.payload.transfer.to],void 0,{});case 3:return t.next=5,Object(l.FetchChainObjects)(l.ChainStore.getAccount,[e.payload.transfer.from],void 0,{});case 5:return t.next=7,Object(l.FetchChainObjects)(l.ChainStore.getAsset,[e.payload.transfer.asset_id]);case 7:n.setState({isModalVisible:!0,operationData:e});case 8:case\"end\":return t.stop()}},t,a)}))},n.hideModal=function(){n.setState({isModalVisible:!1,operation:null})},n._onFilter=function(e){e.preventDefault(),n.setState({filterString:e.target.value.toLowerCase()})},n.state={isModalVisible:!1,filterString:\"\",operationData:void 0,htlc_list:[],tableIsLoading:!1},n.hasLoadedOnce=null,n}return function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,n[\"Component\"]),z(t,[{key:\"_update\",value:function(){var e=L(regeneratorRuntime.mark(function e(){var t,a,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.currentAccount,!Object(j.b)(t)||this.hasLoadedOnce===t.get(\"id\")){e.next=24;break}return this.hasLoadedOnce=t.get(\"id\"),this.setState({tableIsLoading:!0}),e.next=7,C.a.getHTLCs(t.get(\"id\"));case 7:a=e.sent,n=0;case 9:if(!(n<a.length)){e.next=23;break}return r=a[n],e.prev=11,e.next=14,Object(l.FetchChainObjects)(l.ChainStore.getObject,[r.transfer.asset_id],void 0,{});case 14:return e.next=16,Object(l.FetchChainObjects)(l.ChainStore.getAccountName,[r.transfer.from,r.transfer.to]);case 16:e.next=20;break;case 18:e.prev=18,e.t0=e.catch(11);case 20:n++,e.next=9;break;case 23:this.setState({htlc_list:a,tableIsLoading:!1});case 24:case\"end\":return e.stop()}},e,this,[[11,18]])}));return function(){return e.apply(this,arguments)}}()},{key:\"componentDidMount\",value:function(){this._update()}},{key:\"componentDidUpdate\",value:function(e){this._update()}},{key:\"render\",value:function(){var e=this,t=this.state,a=t.isModalVisible,n=t.htlc_list,s=t.operationData,u=t.filterString,p=this.props.currentAccount,d=null;n.length&&(d=n.map(function(e){var t=e.transfer.to,a=e.transfer.from,n={amount:e.transfer.amount,asset_id:e.transfer.asset_id},s=new Date(e.conditions.time_lock.expiration),u=l.ChainStore.getAsset(n.asset_id,!1),d=l.ChainStore.getAccountName(t)||t,m=l.ChainStore.getAccountName(a)||a;return{key:e.id,id:e.id,type:t==p.get(\"id\")?\"payee\":\"payer\",from:m,to:d,amount:r.a.createElement(\"span\",null,u?c.a.get_asset_amount(n.amount,u)+\" \":null,r.a.createElement(F.a,{asset:n.asset_id})),hash:r.a.createElement(o.Tooltip,{title:i.a.translate(\"htlc.preimage_hash_explanation\")},r.a.createElement(\"span\",null,\"(\"+e.conditions.hash_lock.preimage_size+\",\"+e.conditions.hash_lock.preimage_hash[0]+\"): \"+e.conditions.hash_lock.preimage_hash[1])),expires:i.a.localize(s,{type:\"date\",format:\"full\"}),rawData:V({},e)}})).length&&d.filter(function(e){return e.to&&-1!==e.to.indexOf(u)});var m=[{title:\"#\",dataIndex:\"id\",key:\"id\",sorter:function(e,t){return e.id>t.id?1:e.id<t.id?-1:0}},{title:i.a.translate(\"showcases.htlc.from\"),dataIndex:\"from\",key:\"from\",sorter:function(e,t){return e.from>t.from?1:e.from<t.from?-1:0}},{title:i.a.translate(\"showcases.htlc.to\"),dataIndex:\"to\",key:\"to\",sorter:function(e,t){return e.to>t.to?1:e.to<t.to?-1:0}},{title:i.a.translate(\"showcases.htlc.amount\"),dataIndex:\"amount\",key:\"amount\",sorter:function(e,t){return e.rawData.op[1].amount.amount-t.rawData.op[1].amount.amount}},{title:i.a.translate(\"showcases.htlc.hash\"),dataIndex:\"hash\",key:\"hash\"},{title:i.a.translate(\"showcases.htlc.expires\"),dataIndex:\"expires\",key:\"expires\",sorter:function(e,t){return e.expires>t.expires?1:e.expires<t.expires?-1:0}},{title:i.a.translate(\"showcases.htlc.actions\"),dataIndex:\"action\",key:\"action\",render:function(t,a){return a.type?\"payer\"===a.type?r.a.createElement(\"span\",null,r.a.createElement(o.Button,{style:{marginRight:\"10px\"},onClick:e.showModal({type:\"extend\",payload:a.rawData})},i.a.translate(\"showcases.htlc.extend\"))):r.a.createElement(\"span\",{onClick:e.showModal({type:\"redeem\",payload:a.rawData})},r.a.createElement(o.Button,null,i.a.translate(\"showcases.htlc.redeem\"))):null}}];return r.a.createElement(\"div\",{className:\"direct-debit-view\"},r.a.createElement(o.Card,{className:\"direct-debit-table-card\"},r.a.createElement(o.Row,null,r.a.createElement(o.Col,{span:24,style:{padding:\"10px\"}},r.a.createElement(\"div\",{style:{marginBottom:\"30px\"}},r.a.createElement(o.Input,{className:\"direct-debit-table__filter-input\",placeholder:i.a.translate(\"explorer.witnesses.filter_by_name\"),onChange:this._onFilter,style:{width:\"200px\",marginRight:\"30px\"},addonAfter:r.a.createElement(o.Icon,{type:\"search\"})}),r.a.createElement(o.Button,{onClick:this.showModal({type:\"create\",payload:null}),style:{marginRight:\"30px\"}},i.a.translate(\"showcases.htlc.create_htlc\")),!!this.state.errorMessage&&r.a.createElement(\"span\",{className:\"red\"},this.state.errorMessage)),r.a.createElement(o.Table,{columns:m,dataSource:d,pagination:!1,className:\"direct-debit-table\",loading:this.state.tableIsLoading}))),r.a.createElement(R,{isModalVisible:a,hideModal:this.hideModal,operation:s,fromAccount:this.props.currentAccount})))}}]),t}();W=Object(j.a)(W);t.default=W}}]);"],"mappings":"AAAA","sourceRoot":""}
(this.webpackJsonp=this.webpackJsonp||[]).push([[20],{2023:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(0),r=n.n(a),i=n(1),o=n.n(i),s=n(4),l=n(5),c=n.n(l),p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};var u=r.a.createRef();function d(e){var t=e.onChange,n=e.value,a=e.placeholder,i=e.maxLength,o=e.style,l=e.className,c=e.name,d=e.autoComplete,m=e.onClear,h=e.type,f=function(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}(e,["onChange","value","placeholder","maxLength","style","className","name","autoComplete","onClear","type"]);return null==m&&(m=function(){t({target:{value:""}}),u.current.focus()}),r.a.createElement(s.Input,p({ref:u,autoComplete:d,style:o,type:h,className:l+" search-input",placeholder:a,maxLength:i,name:c,value:n,onChange:t,addonAfter:r.a.createElement(s.Icon,{type:"search"}),suffix:m?r.a.createElement(s.Icon,{onClick:m,type:"close",className:n?"cursor-pointer":"hide"}):r.a.createElement("span",null)},f))}d.propTypes={onChange:o.a.func.isRequired,value:o.a.string,placeholder:o.a.string,style:o.a.object,className:o.a.string,type:o.a.string,name:o.a.string,autoComplete:o.a.string,maxLength:o.a.number,onClear:o.a.func},d.defaultProps={placeholder:c.a.translate("exchange.filter"),style:{width:"200px"},className:"",type:"text",name:"focus",autoComplete:"off",maxLength:16,onClear:void 0}},2030:function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return h}));var a=n(0),r=n.n(a),i=n(44),o=n(591),s=n.n(o),l=n(48),c=n(30),p=n(23),u=n(41),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var m=function(e){return!!e&&!!e.get("id")},h=function(e){var t,n,a=(n=t=function(t){function n(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,t),d(n,[{key:"render",value:function(){return m(this.props.currentAccount)?r.a.createElement(e,this.props):r.a.createElement(u.a,null)}}]),n}(r.a.Component),t.propTypes={currentAccount:i.a.ChainAccount},t.defaultProps={autosubscribe:!0},n);return a=Object(l.a)(a),a=s()(a,100,{leading:!1}),Object(c.a)(a,{listenTo:function(){return[p.a]},getProps:function(){var e=p.a.getState().currentAccount||p.a.getState().passwordAccount||"please-login";return{currentAccount:new Map([["name",e]])}}})}},2031:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i=n(5),o=n.n(i),s=n(4),l=(n(2045),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}),c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={pageSize:e.pageSize},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),p(t,[{key:"render",value:function(){var e=this,t=this.state.pageSize,n=this.props,a=n.header,i=n.rows,p=n.extraRow,u=n.loading,d=[10,20,30,40,50,100].filter((function(t){return t<Math.max(e.props.pageSize,i.length)}));d.push(Math.max(this.props.pageSize,i.length));var m=null;return null!==this.props.label?m=function(t){return o.a.translate(e.props.label,{count:t})}:"string"==typeof this.props.totalLabel?m=function(t){return o.a.translate(e.props.totalLabel,{count:t})}:"object"===c(this.props.totalLabel)&&(m=function(t){return o.a.translate(e.props.totalLabel.key,l({count:t},e.props.totalLabel.args))}),r.a.createElement("div",{className:"paginated-list",style:this.props.style},r.a.createElement(s.Table,{loading:u,dataSource:i,uns:!0,columns:Array.isArray(a)?a:[],footer:function(){return p||r.a.createElement("span",null," ")},onChange:this.props.toggleSortOrder,pagination:{showSizeChanger:!0,hideOnSinglePage:!1,defaultPageSize:t,pageSizeOptions:d.map((function(e){return e.toString()})),showTotal:function(e,t){return m(e)}},rowClassName:null==this.props.rowClassName?void 0:function(t,n){return e.props.rowClassName(t,n)},rowSelection:this.props.rowSelection}),this.props.children)}}]),t}(r.a.Component);u.defaultProps={rows:[],pageSize:20,className:"table",extraRow:null,style:{paddingBottom:"1rem"},loading:!1,totalLabel:"utility.total_x_items",label:null},t.a=u},2045:function(e,t,n){},2192:function(e,t,n){},2335:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(30),o=n(2030),s=n(472),l=n(594),c=n(112),p=n(82),u=n(5),d=n.n(u),m=n(1),h=n.n(m),f=n(182),b=n(128),y=n(4),g=n(6),_=n(2031),v=n(44),k=n(591),w=n.n(k),O=n(35),E=n(16),P=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},A=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();n(2192);var C=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onRowAction=function(e){return{onClick:n.onMarketAction.bind(n,e)}},n.state={ticker:{}},n.tickersLoaded={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),A(t,[{key:"onMarketAction",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yes";this.props.onMarketAction({market:e,action:t})}},{key:"getHeader",value:function(){var e=this;return[{title:d.a.translate("account.asset"),dataIndex:"asset_id",align:"left",defaultSortOrder:"ascend",sorter:function(e,t){return e.symbol>t.symbol?1:e.symbol<t.symbol?-1:0},render:function(e){return r.a.createElement("div",{style:{whiteSpace:"nowrap"}},r.a.createElement(f.a,{asset:e}))}},{title:d.a.translate("prediction.overview.issuer"),dataIndex:"issuer",align:"left",sorter:function(e,t){var n=g.ChainStore.getAccount(e.issuer),a=g.ChainStore.getAccount(t.issuer),r=null,i=null;return n&&a&&(r=n.get("name"),i=a.get("name")),r>i?1:r<i?-1:0},render:function(e){return r.a.createElement("div",{style:{whiteSpace:"nowrap"}},r.a.createElement(b.a,{account:e}))}},{title:d.a.translate("prediction.overview.prediction"),dataIndex:"condition",align:"left",sorter:function(e,t){return e.condition&&""!==e.condition?t.condition&&""!==t.condition?e.condition.localeCompare(t.condition):1:-1},render:function(e){return r.a.createElement("div",{style:{whiteSpace:"normal"}},r.a.createElement("span",null,e))}},{title:d.a.translate("prediction.overview.market_confidence"),dataIndex:"marketConfidence",align:"left",sorter:function(e,t){return e.marketConfidence>t.marketConfidence?1:e.marketConfidence<t.marketConfidence?-1:0},render:function(t,n){var a=Object.assign({},e.state.ticker[n.asset_id]);return e.state.ticker[n.asset_id]?(a.quote_volume&&"0"!==a.quote_volume&&"1"!==a.quote_volume&&"NaN"!==a.quote_volume&&"-NaN"!==a.quote_volume?a.quote_volume=E.a.convert_typed_to_satoshi(parseFloat(a.quote_volume),g.ChainStore.getAsset(n.short_backing_asset)):a.quote_volume=0,a.percent_change&&"NaN"!==a.percent_change&&"-NaN"!==a.percent_change?"0"==a.percent_change?a.percent_change="0%":a.percent_change=(parseFloat(a.latest)>0?"+":"-")+a.percent_change+"%":a.percent_change="-",r.a.createElement("span",null,d.a.translate("exchange.vol_short")," ",r.a.createElement(O.a,{amount:a.quote_volume,asset:n.short_backing_asset})," ")):null}},{title:d.a.translate("prediction.overview.market_predicated_likelihood"),dataIndex:"marketLikelihood",align:"left",sorter:function(e,t){return e.marketLikelihood>t.marketLikelihood?1:e.marketLikelihood<t.marketLikelihood?-1:0},render:function(t,n){var a=Object.assign({},e.state.ticker[n.asset_id]);return e.state.ticker[n.asset_id]?(a.latest&&"0"!==a.latest&&"1"!==a.latest&&"NaN"!==a.latest&&"-NaN"!==a.latest?a.latest=(100*parseFloat(a.latest)).toPrecision(3)+"%":a.latest="-",a.highest_bid&&"0"!==a.highest_bid&&"1"!==a.highest_bid&&"NaN"!==a.highest_bid&&"-NaN"!==a.highest_bid?a.highest_bid=(100*parseFloat(a.highest_bid)).toPrecision(3)+"%":a.highest_bid="-",a.lowest_ask&&"0"!==a.lowest_ask&&"1"!==a.lowest_ask&&"NaN"!==a.lowest_ask&&"-NaN"!==a.lowest_ask?a.lowest_ask=(100*parseFloat(a.lowest_ask)).toPrecision(3)+"%":a.lowest_ask="-","-"!==a.latest?r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,a.latest," "),r.a.createElement("span",{className:"supsub"},r.a.createElement("sup",{className:"superscript"},a.highest_bid),r.a.createElement("sub",{className:"subscript"},a.lowest_ask)),"   "):"-"):null}},{title:d.a.translate("prediction.overview.description"),dataIndex:"description",align:"left",sorter:function(e,t){return e.description&&""!==e.description?t.description&&""!==t.description?e.description.localeCompare(t.description):1:-1},render:function(e){return r.a.createElement("div",{style:{whiteSpace:"normal"}},r.a.createElement("span",null,e))}},{title:d.a.translate("prediction.overview.expiry"),dataIndex:"expiry",align:"left",sorter:function(e,t){return e.expiry&&""!==e.expiry?t.expiry&&""!==t.expiry?e.expiry.localeCompare(t.expiry):1:-1},render:function(e){return r.a.createElement("div",{style:{whiteSpace:"normal"}},r.a.createElement("span",null,e))}},{title:d.a.translate("prediction.overview.action"),align:"center",render:function(t){return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},(n=t.issuer,e.props.currentAccount.get("id")===n?r.a.createElement(y.Button,{style:{width:"170px"},className:"align-middle",onClick:function(){return e.onMarketAction(t,"resolve")}},d.a.translate("prediction.overview.resolve")):r.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},r.a.createElement(y.Button,{style:{marginRight:"5px"},className:"align-middle",onClick:function(){return e.onMarketAction(t,"yes")}},"Details"))));var n}}]}},{key:"_decideRowClassName",value:function(e,t){return this.props.selectedPredictionMarket?"selected-row":""}},{key:"componentDidUpdate",value:function(e){var t=this;e.predictionMarkets.length!==this.props.predictionMarkets.length&&this.props.predictionMarkets.forEach((function(e){e.asset.id in Object.keys(t.tickersLoaded)||(t.tickersLoaded[e.asset.id]={},p.a.getTicker(e.short_backing_asset,e.asset.id).then((function(n){var a=Object.assign(t.tickersLoaded,t.state.ticker);a[e.asset.id]=n,t.tickersLoaded[e.asset.id]=n,t.setState({ticker:a})})).catch((function(e){return console.error(e)})))}))}},{key:"render",value:function(){var e=this,t=this.getHeader(),n=[];if(this.props.selectedPredictionMarket)n=[this.props.selectedPredictionMarket];else if(this.props.predictionMarkets){n=this.props.predictionMarkets;var a=0;n=n.map((function(e){return P({},e,{key:""+e.asset_id+a++})}))}var i={type:this.props.selectedPredictionMarket?void 0:"radio",hideDefaultSelections:!0,onChange:function(t,n){n.length>0?e.onMarketAction(n[0],null):e.onMarketAction(null,null)},selectedRowKeys:this.props.selectedPredictionMarket?[this.props.selectedPredictionMarket.key]:[]};return r.a.createElement(_.a,{rowSelection:i,rows:n,header:t,pageSize:10,rowClassName:this._decideRowClassName.bind(this),loading:this.props.loading,totalLabel:"utility.total_x_assets"})}}]),t}(a.Component);C.propTypes={predictionMarkets:h.a.array.isRequired,onMarketAction:h.a.func.isRequired,currentAccount:v.a.ChainAccount.isRequired,selectedPredictionMarket:h.a.object},C.defaultProps={predictionMarkets:[]};var S=C=w()(C,150,{leading:!1}),M=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},x=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var j=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),x(t,[{key:"getHeader",value:function(){var e=this,t=this.props.currentAccount.get("id");return[{title:"#",dataIndex:"order_id",align:"left",sorter_inactive:function(e,t){return e.order_id>t.order_id?1:e.order_id<t.order_id?-1:0},render:function(e){return r.a.createElement("div",{style:{whiteSpace:"nowrap"}},r.a.createElement("span",null,e))}},{title:d.a.translate("prediction.details.predictor"),dataIndex:"opinionator",align:"left",sorter_inactive:function(e,t){var n=g.ChainStore.getAccount(e.opinionator).get("name"),a=g.ChainStore.getAccount(t.opinionator).get("name");return n>a?1:n<a?-1:0},render:function(e){return r.a.createElement("div",{style:{whiteSpace:"nowrap"}},r.a.createElement(b.a,{account:e}))}},{title:d.a.translate("prediction.details.prediction"),dataIndex:"opinion",align:"left",sorter_inactive:function(e,t){return e.opinion>t.opinion?1:e.opinion<t.opinion?-1:0},render:function(e){return r.a.createElement("div",{style:{whiteSpace:"nowrap"}},r.a.createElement("span",null,d.a.translate("prediction.details."+("yes"==e?"proves_true":"incorrect"))))}},{title:d.a.translate("prediction.details.predicated_likelihood"),dataIndex:"likelihood",align:"left",sortOrder:"yes"==this.props.opinionFilter?"descend":"ascend",sorter:function(e,t){return e.likelihood>t.likelihood?1:e.likelihood<t.likelihood?-1:0},render:function(e){return r.a.createElement("div",{style:{whiteSpace:"nowrap"}},r.a.createElement("span",null,(100*e).toPrecision(3),"%"))}},{title:d.a.translate("prediction.details.premium"),dataIndex:"premium",align:"left",sorter_inactive:function(e,t){return e.amount>t.amount?1:e.amount<t.amount?-1:0},render:function(e){return r.a.createElement("div",{style:{whiteSpace:"nowrap"}},r.a.createElement(O.a,{amount:e.amount,asset:e.asset_id}))}},{title:d.a.translate("prediction.details.commission"),dataIndex:"commission",align:"left",sorter_inactive:function(e,t){return e.fee>t.fee?1:e.fee<t.fee?-1:0},render:function(e,t){return r.a.createElement("div",{style:{whiteSpace:"nowrap"}},r.a.createElement(O.a,{amount:e.amount,asset:e.asset_id})," (",(t.commission.amount/t.premium.amount*100).toPrecision(3),"%)")}},{title:d.a.translate("prediction.details.potential_profit"),dataIndex:"potentialProfit",align:"left",sorter_inactive:function(e,t){return e.amount>t.amount?1:e.amount<t.amount?-1:0},render:function(e){return r.a.createElement("div",{style:{whiteSpace:"nowrap"}},r.a.createElement(O.a,{amount:e.amount,asset:e.asset_id}))}},{title:d.a.translate("prediction.overview.action"),align:"left",render:function(n){return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"right"}},t&&n.opinionator===t?r.a.createElement(y.Button,{onClick:function(){e.props.onCancel(n)}},d.a.translate("prediction.details.cancel")):r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null,r.a.createElement(y.Tooltip,{title:d.a.translate("yes"==n.opinion?"prediction.tooltips.oppose_proves_true":"prediction.tooltips.oppose_is_incorrect")},r.a.createElement(y.Icon,{style:{fontSize:"1.3rem",marginRight:"0.5rem"},type:"question-circle",theme:"filled"})),r.a.createElement(y.Button,{onClick:function(){e.props.onOppose(n)}},d.a.translate("prediction.details.oppose")))))}}]}},{key:"render",value:function(){var e=this,t=this.getHeader(),n=this.props.predictionMarketData.opinions.filter((function(t){var n=g.ChainStore.getAccount(t.opinionator)?g.ChainStore.getAccount(t.opinionator).get("name"):null;if(e.props.detailsSearchTerm&&-1===(n+"\0"+t.opinion).toUpperCase().indexOf(e.props.detailsSearchTerm))return!1;if(e.props.opinionFilter){if("all"==e.props.opinionFilter)return!0;if(e.props.opinionFilter!=t.opinion)return!1}return!0})),a=0;return n=n.map((function(e){return M({},e,{key:""+e.order_id+a++})})),r.a.createElement(_.a,{rows:n,header:t,pageSize:10})}}]),t}(a.Component),I=j;j.propTypes={predictionMarketData:h.a.any.isRequired,onOppose:h.a.func.isRequired,onCancel:h.a.func.isRequired,currentAccount:v.a.ChainAccount.isRequired,detailsSearchTerm:h.a.string,opinionFilter:h.a.string},j.defaultProps={predictionMarketData:{}};var N=n(2023),R=n(592),T=n(2),F=n.n(T),L=n(593),q=n(40),D=n(556),H=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var z=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={newOpinionParameters:{opinionator:null,opinion:n.props.preselectedOpinion,amount:n.props.preselectedAmount/Math.pow(10,n.props.baseAsset.get("precision"))||" ",probability:n.props.preselectedProbability||null,fee:null},showWarning:!1,inProgress:!1,selectedOpinion:n.props.preselectedOpinion,selectedAsset:null,wrongPropability:!1},n.handleOpinionChange=n.handleOpinionChange.bind(n),n.handleAmountChange=n.handleAmountChange.bind(n),n.onSubmit=n.onSubmit.bind(n),n.handleProbabilityChange=n.handleProbabilityChange.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),H(t,[{key:"_createOrder",value:function(){var e=this;this.setState({inProgress:!0});var t="yes"===this.state.newOpinionParameters.opinion?"buy":"shortAndSell",n=this.props.baseAsset.get("id"),a=new Date;a.setFullYear(a.getFullYear()+1);var r={for_sale:new q.a({asset_id:this.props.baseAsset.get("id"),precision:this.props.baseAsset.get("precision"),amount:this.state.newOpinionParameters.amount*Math.pow(10,this.props.quoteAsset.get("precision"))*this.state.newOpinionParameters.probability}),to_receive:new q.a({asset_id:this.props.quoteAsset.get("id"),precision:this.props.quoteAsset.get("precision"),amount:this.state.newOpinionParameters.amount*Math.pow(10,this.props.quoteAsset.get("precision"))})};r.price=new q.i({base:r.for_sale,quote:r.to_receive});var i={for_sale:new q.a({asset_id:this.props.quoteAsset.get("id"),precision:this.props.quoteAsset.get("precision"),amount:this.state.newOpinionParameters.amount*Math.pow(10,this.props.quoteAsset.get("precision"))}),to_receive:new q.a({asset_id:this.props.baseAsset.get("id"),precision:this.props.baseAsset.get("precision"),amount:this.state.newOpinionParameters.amount*Math.pow(10,this.props.quoteAsset.get("precision"))*this.state.newOpinionParameters.probability})};i.price=new q.i({base:i.for_sale,quote:i.to_receive});var o="buy"===t?i:r;if("buy"===t){var s=new q.h({for_sale:new q.a({asset_id:this.props.baseAsset.get("id"),precision:this.props.baseAsset.get("precision"),amount:E.a.convert_typed_to_satoshi(this.state.newOpinionParameters.amount,this.props.baseAsset)}),expiration:null,to_receive:new q.a({asset_id:this.props.quoteAsset.get("id"),precision:this.props.quoteAsset.get("precision"),amount:E.a.convert_typed_to_satoshi(this.state.newOpinionParameters.amount,this.props.quoteAsset)/parseFloat(this.state.newOpinionParameters.probability)}),seller:this.props.currentAccount.get("id"),fee:{asset_id:n,amount:0}});return p.a.createLimitOrder2(s).then((function(t){e.setState({inProgress:!1}),t.error&&"wallet locked"!==t.error.message&&y.Notification.error({message:d.a.translate("notifications.exchange_unknown_error_place_order",{amount:o.to_receive.getAmount({real:!0}),symbol:o.to_receive.asset_id})})})).catch((function(e){console.error("order failed:",e)}))}if("shortAndSell"===t){var l=new q.h({for_sale:new q.a({asset_id:this.props.quoteAsset.get("id"),precision:this.props.quoteAsset.get("precision"),amount:E.a.convert_typed_to_satoshi(this.state.newOpinionParameters.amount,this.props.quoteAsset)}),expiration:null,to_receive:new q.a({asset_id:this.props.baseAsset.get("id"),precision:this.props.baseAsset.get("precision"),amount:E.a.convert_typed_to_satoshi(this.state.newOpinionParameters.amount,this.props.baseAsset)*parseFloat(this.state.newOpinionParameters.probability)}),seller:this.props.currentAccount.get("id"),fee:{asset_id:n,amount:0}}),c=new q.a({amount:l.amount_for_sale.getAmount(),asset_id:this.props.baseAsset.get("id"),precision:this.props.baseAsset.get("precision")});p.a.createPredictionShort(l,c).then((function(t){e.setState({inProgress:!1}),t.error&&"wallet locked"!==t.error.message&&y.Notification.error({message:d.a.translate("notifications.exchange_unknown_error_place_order",{amount:buyAssetAmount,symbol:buyAsset.symbol})})}))}}},{key:"componentDidUpdate",value:function(e){this.props.preselectedOpinion===e.preselectedOpinion&&this.props.preselectedAmount===e.preselectedAmount&&this.props.preselectedProbability===e.preselectedProbability||this._updateStateFromProps()}},{key:"componentDidMount",value:function(){this._updateStateFromProps()}},{key:"_updateStateFromProps",value:function(){var e=this.state.newOpinionParameters;(e=Object.assign({},e)).opinion=this.props.preselectedOpinion,e.amount=this.props.preselectedAmount/Math.pow(10,this.props.baseAsset.get("precision"))||" ",e.probability=this.props.preselectedProbability||null,this.setState({newOpinionParameters:e,selectedOpinion:this.props.preselectedOpinion})}},{key:"handleOpinionChange",value:function(){var e=this.state.newOpinionParameters;e.opinion="no"===e.opinion?"yes":"no",e.opinionator=this.props.currentAccount.get("id"),this.setState({newOpinionParameters:e,selectedOpinion:e.opinion})}},{key:"handleAmountChange",value:function(e){var t=e.amount,n=e.asset,a=this.state.newOpinionParameters;a.amount=t,a.opinionator=this.props.currentAccount.get("id"),this.setState({newOpinionParameter:a}),"string"==typeof n&&this.setState({selectedAsset:n})}},{key:"handleProbabilityChange",value:function(e){var t=this.state.newOpinionParameters;t.probability=e.target.value,this.setState({newOpinionParameter:t,wrongProbability:!this._isProbabilityValid(t)})}},{key:"_isProbabilityValid",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null==e&&(e=this.state.newOpinionParameters),!(!e.probability||e.probability<=.01||e.probability>=.99)}},{key:"_isFormValid",value:function(){return this._isProbabilityValid()&&parseFloat(this.state.newOpinionParameters.amount)>0}},{key:"_getPotentialWinnings",value:function(){return this.state.newOpinionParameters.probability&&this.state.newOpinionParameters.amount?"yes"===this.state.newOpinionParameters.opinion?E.a.format_number(this.state.newOpinionParameters.amount/parseFloat(this.state.newOpinionParameters.probability),this.props.baseAsset.get("precision"),!1):E.a.format_number(this.state.newOpinionParameters.amount*(1+(this.state.newOpinionParameters.probability?parseFloat(this.state.newOpinionParameters.probability):0)),this.props.baseAsset.get("precision"),!1):0}},{key:"onSubmit",value:function(){this._isFormValid()?this._createOrder.call(this):this.setState({showWarning:!0})}},{key:"render",value:function(){var e=this.state,t=e.showWarning,n=e.newOpinionParameters,a=e.wrongProbability,i=[r.a.createElement(y.Button,{type:"primary",key:"submit",onClick:this.onSubmit,disabled:this.state.inProgress},d.a.translate("global.confirm")),r.a.createElement(y.Button,{key:"cancel",onClick:this.props.onClose,disabled:this.state.inProgress},d.a.translate("global.cancel"))];return r.a.createElement(y.Modal,{title:r.a.createElement(F.a,{content:"prediction.add_opinion_modal.title"}),visible:this.props.visible,onCancel:this.props.onClose,overlay:!0,closable:!this.state.inProgress,footer:i},r.a.createElement("div",{className:"prediction-markets--add-prediction-offer"},r.a.createElement(y.Form,{className:"full-width",layout:"vertical"},r.a.createElement(y.Form.Item,null,r.a.createElement("label",{className:"left-label"},r.a.createElement(F.a,{content:"prediction.add_opinion_modal.symbol"}),r.a.createElement(y.Input,{type:"text",disabled:!0,tabIndex:1,value:this.props.predictionMarket.symbol}))),r.a.createElement(y.Form.Item,null,r.a.createElement("label",{className:"left-label"},r.a.createElement(F.a,{content:"prediction.details.prediction"}),r.a.createElement(y.Input,{type:"text",disabled:!0,tabIndex:2,value:this.props.predictionMarket.condition}))),r.a.createElement(y.Form.Item,null,r.a.createElement("span",{className:!n.probability&&t||a?"has-error":""},r.a.createElement("label",{className:"left-label"},r.a.createElement(F.a,{content:"prediction.details.predicated_likelihood"}),r.a.createElement(D.a,{placeholder:"0.0",onChange:this.handleProbabilityChange,value:this.state.newOpinionParameters.probability})))),r.a.createElement(y.Form.Item,{style:{marginBottom:"1rem"}},r.a.createElement("span",null,r.a.createElement("label",{className:"left-label"},r.a.createElement(F.a,{content:"prediction.details.i_think_that"}))),r.a.createElement(y.Radio.Group,{value:this.state.selectedOpinion,onChange:this.handleOpinionChange},r.a.createElement(y.Radio,{value:"yes"},d.a.translate("prediction.details.proves_true")),r.a.createElement(y.Radio,{value:"no"},d.a.translate("prediction.details.incorrect")))),r.a.createElement(y.Form.Item,null,r.a.createElement("span",null,r.a.createElement("label",{className:"left-label"},r.a.createElement(F.a,{content:"prediction.details.premium"}),r.a.createElement(L.a,{onChange:this.handleAmountChange,placeholder:"0.0",tabIndex:6,amount:this.state.newOpinionParameters.amount,asset:this.props.baseAsset.get("id")})))),r.a.createElement(y.Form.Item,null,r.a.createElement("label",{className:"left-label"},r.a.createElement(F.a,{content:"prediction.details.commission"}),r.a.createElement(L.a,{disabled:!0,amount:Math.min(this.props.predictionMarket.max_market_fee,this.state.newOpinionParameters.amount*this.props.predictionMarket.market_fee/1e4),asset:this.props.baseAsset.get("id")}))),r.a.createElement(y.Form.Item,null,r.a.createElement("label",{className:"left-label"},r.a.createElement(F.a,{content:"prediction.details.potential_profit"}),r.a.createElement(L.a,{disabled:!0,amount:this._getPotentialWinnings(),asset:this.props.baseAsset.get("id")}))),this.state.inProgress?r.a.createElement(F.a,{content:"footer.loading"}):null)))}}]),t}(y.Modal),B=z;z.propTypes={visible:h.a.bool,onClose:h.a.func,predictionMarket:h.a.any.isRequired,opinion:h.a.any,currentAccount:v.a.ChainAccount.isRequired,preselectedOpinion:h.a.string,preselectedAmount:h.a.number,preselectedProbability:h.a.number,baseAsset:h.a.object,quoteAsset:h.a.object},z.defaultProps={visible:!1,predictionMarket:null,opinion:{}};var U=n(375),G=n(193),W=n.n(G),V=n(32),J=n.n(V),K=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var Y=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={marketOptions:{precision:"5",max_supply:1e5,max_market_fee:0,market_fee_percent:0,description:{main:""},reward_percent:0,symbol:""},showWarning:!1,wrongSymbol:!1,wrongDate:!1,core_exchange_rate:{quote:{asset_id:null,amount:1},base:{asset_id:"1.3.0",amount:1}},bitasset_opts:{feed_lifetime_sec:86400,minimum_feeds:7,force_settlement_delay_sec:86400,force_settlement_offset_percent:1*W.a.GRAPHENE_1_PERCENT,maximum_force_settlement_volume:20*W.a.GRAPHENE_1_PERCENT,short_backing_asset:"1.3.0"},inProgress:!1},n.handleChange=n.handleChange.bind(n),n.handleAssetChange=n.handleAssetChange.bind(n),n.handleFeeChange=n.handleFeeChange.bind(n),n.onSubmit=n.onSubmit.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),K(t,[{key:"_getPermissionsAndFlags",value:function(){var e=c.a.getFlagBooleans(0,!0),t=c.a.getFlagBooleans("all",!0);return e.charge_market_fee=!0,{flags:c.a.getFlags(e,!0),permissions:c.a.getPermissions(t,!0)}}},{key:"_createAsset",value:function(){var e=this,t=this.state,n=t.marketOptions,a=t.core_exchange_rate,r=t.bitasset_opts,i=this._getPermissionsAndFlags(),o=i.permissions,l=i.flags,c=JSON.stringify(this.state.marketOptions.description);this.setState({inProgress:!0});var p=g.ChainStore.getAccount(this.props.currentAccount).get("id");s.a.createAsset(p,n,l,o,a,!0,!0,r,c).then((function(t){e.setState({inProgress:!1}),console.log("... AssetActions.createAsset(account_id, update)",p,n,l,o),e.props.onMarketCreated(n.symbol)})).catch((function(t){console.error(t),e.setState({inProgress:!1})}))}},{key:"handleChange",value:function(e){var t=this.state.marketOptions;switch(e instanceof J.a&&(e.set("milliseconds",0),e={target:{name:"expiry",value:e.toISOString()}}),e.target.name){case"symbol":t[e.target.name]=e.target.value.toUpperCase();break;case"main":case"condition":case"expiry":t.description[e.target.name]=e.target.value;break;default:t[e.target.name]=e.target.value}this.setState({marketOptions:t})}},{key:"handleAssetChange",value:function(e){if(e){var t=this.state.bitasset_opts,n=this.state.marketOptions,a=this.state.core_exchange_rate;t.short_backing_asset=e,n.precision=g.ChainStore.getAsset(e).get("precision"),a.base.asset_id=e,this.setState({bitasset_opts:t,core_exchange_rate:a,marketOptions:n})}}},{key:"_forcePositive",value:function(e){return parseFloat(e)<0?"0":e}},{key:"handleFeeChange",value:function(e){console.log(e);var t=this.state.marketOptions;t.market_fee_percent=this._forcePositive(e.target.value),this.setState({marketOptions:t})}},{key:"_isFormValid",value:function(){return this.props.symbols.includes(this.state.marketOptions.symbol)?(this.setState({wrongSymbol:!0}),!1):(this.setState({wrongSymbol:!1}),new Date>new Date(this.state.marketOptions.description.expiry)?(this.setState({wrongDate:!0}),!1):(this.setState({wrongDate:!1}),this.state.marketOptions.symbol&&this.state.marketOptions.description.main&&this.state.marketOptions.description.condition&&this.state.marketOptions.description.expiry))}},{key:"onSubmit",value:function(e){this._isFormValid()?(e&&e.preventDefault(),this._createAsset().call(this)):this.setState({showWarning:!0})}},{key:"render",value:function(){var e=this.state,t=e.showWarning,n=e.marketOptions,a=e.wrongSymbol,i=e.wrongDate,o=[r.a.createElement(y.Button,{type:"primary",key:"submit",onClick:this.onSubmit,disabled:this.state.inProgress},d.a.translate("global.confirm")),r.a.createElement(y.Button,{key:"cancel",onClick:this.props.onClose,disabled:this.state.inProgress},d.a.translate("global.cancel"))];return r.a.createElement(y.Modal,{title:r.a.createElement(F.a,{content:"prediction.create_market_modal.title"}),visible:this.props.visible,onCancel:this.props.onClose,overlay:!0,closable:!this.state.inProgress,footer:o},r.a.createElement("div",{className:"prediction-markets--create-prediction-market"},r.a.createElement(y.Form,{className:"full-width",layout:"vertical"},r.a.createElement(y.Form.Item,null,r.a.createElement("span",{className:!n.symbol&&t||a?"has-error":""},r.a.createElement("label",{className:"left-label"},r.a.createElement(y.Tooltip,{title:d.a.translate("prediction.create_market_modal.tooltip_symbol"),placement:"topLeft"},r.a.createElement(F.a,{content:"prediction.create_market_modal.symbol"}),r.a.createElement(y.Icon,{style:{marginLeft:"0.5rem"},theme:"filled",type:"question-circle"})),r.a.createElement(y.Input,{name:"symbol",type:"text",onChange:this.handleChange,tabIndex:1,value:this.state.marketOptions.symbol})))),r.a.createElement(y.Form.Item,null,r.a.createElement("span",{className:!n.description.condition&&t?"has-error":""},r.a.createElement("label",{className:"left-label"},r.a.createElement(y.Tooltip,{title:d.a.translate("prediction.create_market_modal.tooltip_condition"),placement:"topLeft"},r.a.createElement(F.a,{content:"prediction.create_market_modal.condition"}),r.a.createElement(y.Icon,{style:{marginLeft:"0.5rem"},theme:"filled",type:"question-circle"})),r.a.createElement(y.Input,{name:"condition",type:"text",onChange:this.handleChange,tabIndex:2})))),r.a.createElement(y.Form.Item,null,r.a.createElement("span",{className:!n.description.main&&t?"has-error":""},r.a.createElement("label",{className:"left-label"},r.a.createElement(y.Tooltip,{title:d.a.translate("prediction.create_market_modal.tooltip_description"),placement:"topLeft"},r.a.createElement(F.a,{content:"prediction.create_market_modal.description"}),r.a.createElement(y.Icon,{style:{marginLeft:"0.5rem"},theme:"filled",type:"question-circle"})),r.a.createElement(y.Input.TextArea,{name:"main",onChange:this.handleChange,tabIndex:3})))),r.a.createElement(y.Form.Item,null,r.a.createElement("span",{className:!n.description.expiry&&t||i?"has-error":""},r.a.createElement("label",{className:"left-label"},r.a.createElement(y.Tooltip,{title:d.a.translate("prediction.create_market_modal.tooltip_resolution_date"),placement:"topLeft"},r.a.createElement(F.a,{content:"prediction.create_market_modal.resolution_date"}),r.a.createElement(y.Icon,{style:{marginLeft:"0.5rem"},theme:"filled",type:"question-circle"})),r.a.createElement("div",null,r.a.createElement(y.DatePicker,{style:{width:"100%"},name:"expiry",showTime:!0,placeholder:d.a.translate("prediction.create_market_modal.select_date_and_time"),onChange:this.handleChange,onOk:this.handleChange,tabIndex:4}))))),r.a.createElement(y.Form.Item,null,r.a.createElement("label",{className:"left-label"},r.a.createElement(y.Tooltip,{title:d.a.translate("prediction.create_market_modal.tooltip_backing_asset"),placement:"topLeft"},r.a.createElement(F.a,{content:"prediction.create_market_modal.backing_asset"}),r.a.createElement(y.Icon,{style:{marginLeft:"0.5rem"},theme:"filled",type:"question-circle"})),r.a.createElement(U.a,{assets:["1.3.0","1.3.113","1.3.120","1.3.121"],value:this.state.bitasset_opts.short_backing_asset,onChange:this.handleAssetChange,tabIndex:5}))),r.a.createElement(y.Form.Item,null,r.a.createElement("label",{className:"left-label"},r.a.createElement(y.Tooltip,{title:d.a.translate("prediction.create_market_modal.tooltip_commission"),placement:"topLeft"},r.a.createElement(F.a,{content:"prediction.create_market_modal.commission"}),r.a.createElement(y.Icon,{style:{marginLeft:"0.5rem"},theme:"filled",type:"question-circle"})),r.a.createElement(y.Input,{tabIndex:6,type:"number",value:this.state.marketOptions.market_fee_percent,onChange:this.handleFeeChange}))),this.state.inProgress?r.a.createElement(F.a,{content:"footer.loading"}):null)))}}]),t}(y.Modal),Q=Y;Y.propTypes={visible:h.a.bool,onClose:h.a.func,currentAccount:h.a.string,symbols:h.a.array,onMarketCreated:h.a.func},Y.defaultProps={visible:!1};var X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},Z=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var $=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={resolveParameters:{asset_id:n.props.predictionMarket.asset_id,result:"yes"},result:"yes"},n.handleResultChange=n.handleResultChange.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Z(t,[{key:"handleResultChange",value:function(e){var t=e.target.value;this.setState({resolveParameters:X({},this.state.resolveParameters,{result:t}),result:t})}},{key:"render",value:function(){var e=this,t=[r.a.createElement(y.Button,{type:"primary",key:"submit",onClick:function(){return e.props.onResolveMarket(e.state.resolveParameters)},disabled:this.state.inProgress},d.a.translate("global.confirm")),r.a.createElement(y.Button,{key:"cancel",onClick:this.props.onClose,disabled:this.state.inProgress},d.a.translate("global.cancel"))];return r.a.createElement(y.Modal,{title:r.a.createElement(F.a,{content:"prediction.resolve_modal.title"}),visible:this.props.visible,onCancel:this.props.onClose,overlay:!0,closable:!this.state.inProgress,footer:t},r.a.createElement("div",{className:"prediction-markets--resolve-prediction-market-asset"},r.a.createElement(y.Form,{className:"full-width",layout:"vertical"},r.a.createElement(y.Form.Item,null,r.a.createElement("label",{className:"left-label"},r.a.createElement(F.a,{content:"prediction.resolve_modal.symbol"}),r.a.createElement(y.Input,{type:"text",disabled:!0,tabIndex:1,value:this.props.predictionMarket.symbol}))),r.a.createElement(y.Form.Item,null,r.a.createElement("label",{className:"left-label"},r.a.createElement(F.a,{content:"prediction.resolve_modal.prediction"}),r.a.createElement(y.Input,{type:"text",disabled:!0,tabIndex:2,value:this.props.predictionMarket.condition}))),r.a.createElement(y.Form.Item,null,r.a.createElement("label",{className:"left-label"},r.a.createElement(F.a,{content:"prediction.resolve_modal.the_prediction_has"})),r.a.createElement(y.Radio.Group,{value:this.state.result,onChange:this.handleResultChange},r.a.createElement(y.Radio,{value:"yes"},d.a.translate("prediction.resolve_modal.proven_true")),r.a.createElement(y.Radio,{value:"no"},d.a.translate("prediction.resolve_modal.was_incorrect")))))))}}]),t}(y.Modal),ee=$;$.propTypes={predictionMarket:h.a.any.isRequired,onResolveMarket:h.a.func.isRequired,visible:h.a.bool,onClose:h.a.func},$.defaultProps={visible:!1,predictionMarket:null};var te=n(197),ne=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var ae=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onOppose=function(e){n.setState({preselectedOpinion:"no"===e.opinion?"yes":"no",preselectedAmount:e.amount,preselectedProbability:e.probability}),n.onAddOpinionModalOpen()},n.onCancelOpinion=function(e){p.a.cancelLimitOrders(n.props.currentAccount.get("id"),[e.order_id]).catch((function(e){console.log("cancel orders error:",e)}))},n.onResolveMarket=function(e){var t=n.props.currentAccount.get("id"),a="yes"===e.result?1:0,r=g.ChainStore.getAsset(e.asset_id).toJS(),i=new q.a({real:1,asset_id:r.id,precision:r.precision}),o=g.ChainStore.getAsset(r.bitasset.options.short_backing_asset),l=new q.a({real:a,asset_id:r.bitasset.options.short_backing_asset,precision:o.get("precision")}),c=new q.i({quote:l,base:i});s.a.assetGlobalSettle(r,t,c).then((function(){new Promise((function(e){return setTimeout(e,1e3)})).then((function(){n.updateAsset(r.symbol)}))})),n.setState({isResolveModalOpen:!1})},n.state={loading:!1,searchTerm:"",detailsSearchTerm:"",selectedPredictionMarket:null,opinions:[],preselectedOpinion:"yes",preselectedAmount:0,preselectedProbability:0,isCreateMarketModalOpen:!1,isAddOpinionModalOpen:!1,isResolveModalOpen:!1,isHideUnknownHousesChecked:!0,isHideInvalidAssetsChecked:!0,opinionFilter:"yes",predictionMarketAssetFilter:"open"},n.onCreatePredictionMarketModalOpen=n.onCreatePredictionMarketModalOpen.bind(n),n.onCreatePredictionMarketModalClose=n.onCreatePredictionMarketModalClose.bind(n),n.onAddOpinionModalOpen=n.onAddOpinionModalOpen.bind(n),n.onAddOpinionModalClose=n.onAddOpinionModalClose.bind(n),n.onSearch=n.onSearch.bind(n),n.onSearchDetails=n.onSearchDetails.bind(n),n.onMarketAction=n.onMarketAction.bind(n),n.onResolveModalOpen=n.onResolveModalOpen.bind(n),n.onResolveModalClose=n.onResolveModalClose.bind(n),n.updateAsset=n.updateAsset.bind(n),n.handleUnknownHousesToggleChange=n.handleUnknownHousesToggleChange.bind(n),n.handleInvalidAssetsChecked=n.handleInvalidAssetsChecked.bind(n),n}var n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),ne(t,[{key:"componentDidUpdate",value:function(e){e.marketLimitOrders!==this.props.marketLimitOrders&&this._updateOpinionsList(this.props.marketLimitOrders)}},{key:"_isKnownIssuer",value:function(e){return this.props.whitelistedIssuers.includes(e.issuer)}},{key:"_isValidPredictionMarketAsset",value:function(e){var t=new Date(e.forPredictions.description.expiry);return!(t instanceof Date&&isNaN(t.getTime()))&&(!!e.forPredictions.description.condition&&(!!e.forPredictions.description.main&&(!(e.forPredictions.description.condition.length<10)&&(!(e.forPredictions.description.main.length<20)&&!(e.options.market_fee_percent/100>=10)))))}},{key:"_updateOpinionsList",value:function(e){var t=[],n=this.state.selectedPredictionMarket;e.forEach((function(e,a){var r=e.market_base===e.sell_price.base.asset_id?"no":"yes",i=e.market_base===e.sell_price.base.asset_id?e.sell_price.invert().toReal():e.sell_price.toReal(),o=e.market_base===e.sell_price.base.asset_id?e.amountForSale():e.amountToReceive(),s=e.market_base===e.sell_price.base.asset_id?e.amountToReceive():e.amountForSale(),l=0;c.a.getFlagBooleans(n.options.flags,!0).charge_market_fee&&(l=Math.min(n.options.max_market_fee,o.amount*n.options.market_fee_percent/1e4)),i<1&&t.push({order_id:a,opinionator:e.seller,opinion:r,amount:o,likelihood:i,potentialProfit:new q.a({amount:o.amount,asset_id:s.asset_id,precision:s.precision}),premium:s,commission:new q.a({amount:l*i,asset_id:s.asset_id,precision:s.precision})})})),this.setState({opinions:[].concat(t)})}},{key:"getMarketOpinions",value:(n=regeneratorRuntime.mark((function e(t){var n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.subscribedMarket){e.next=3;break}return e.next=3,p.a.unSubscribeMarket(this.state.subscribedMarket.quote.get("id"),this.state.subscribedMarket.base.get("id"));case 3:return n=g.ChainStore.getObject(t.options.core_exchange_rate.base.asset_id),a=g.ChainStore.getAsset(t.options.core_exchange_rate.quote.asset_id),e.next=7,p.a.subscribeMarket(n,a,this.props.bucketSize,this.props.currentGroupOrderLimit);case 7:this.setState({subscribedMarket:{base:n,quote:a}});case 8:case"end":return e.stop()}}),e,this)})),a=function(){var e=n.apply(this,arguments);return new Promise((function(t,n){return function a(r,i){try{var o=e[r](i),s=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(s).then((function(e){a("next",e)}),(function(e){a("throw",e)}));t(s)}("next")}))},function(e){return a.apply(this,arguments)})},{key:"onMarketAction",value:function(e){var t=this,n=e.market,a=e.action;if("string"==typeof a)switch(this.state.selectedPredictionMarket||this.setState({selectedPredictionMarket:n}),a){case"resolve":this.setState({preselectedAmount:0,preselectedProbability:0}),this.onResolveModalOpen();break;case"yes":this.state.subscribedMarket&&(this.setState({preselectedAmount:0,preselectedProbability:0,preselectedOpinion:"yes"}),this.onAddOpinionModalOpen());break;case"no":this.state.subscribedMarket&&(this.setState({preselectedAmount:0,preselectedProbability:0,preselectedOpinion:"no"}),this.onAddOpinionModalOpen());break;default:this.setState({preselectedAmount:0,preselectedProbability:0})}else this.state.selectedPredictionMarket?this.setState({selectedPredictionMarket:null}):this.setState({selectedPredictionMarket:n},(function(){return t.getMarketOpinions(n)}))}},{key:"onSearch",value:function(e){this.setState({searchTerm:e.target.value||""})}},{key:"onSearchDetails",value:function(e){this.setState({detailsSearchTerm:e.target.value||""})}},{key:"onCreatePredictionMarketModalOpen",value:function(){this.setState({isCreateMarketModalOpen:!0})}},{key:"onCreatePredictionMarketModalClose",value:function(){this.setState({isCreateMarketModalOpen:!1})}},{key:"onAddOpinionModalOpen",value:function(){this.setState({isAddOpinionModalOpen:!0})}},{key:"onAddOpinionModalClose",value:function(){this.setState({isAddOpinionModalOpen:!1,preselectedOpinion:"no",preselectedAmount:0,preselectedProbability:0})}},{key:"onResolveModalOpen",value:function(){this.setState({isResolveModalOpen:!0})}},{key:"onResolveModalClose",value:function(){this.setState({isResolveModalOpen:!1})}},{key:"handleUnknownHousesToggleChange",value:function(){var e=this,t=!this.state.isHideUnknownHousesChecked;this.setState({isHideUnknownHousesChecked:t,selectedPredictionMarket:null},(function(){return e.props.fetchAllAssets()}))}},{key:"handleInvalidAssetsChecked",value:function(){this.setState({isHideInvalidAssetsChecked:!this.state.isHideInvalidAssetsChecked,selectedPredictionMarket:null})}},{key:"updateAsset",value:function(e){s.a.getAssetList.defer(e,1)}},{key:"_filterMarkets",value:function(){var e=this,t=this.state.predictionMarketAssetFilter;return this.props.predictionMarkets.filter((function(n){var a=n.asset;if(!a)return!1;var r=a.bitasset_data||a.bitasset||{};if(e.state.isHideUnknownHousesChecked&&!e._isKnownIssuer(a))return!1;if(e.state.isHideInvalidAssetsChecked&&!e._isValidPredictionMarketAsset(a))return!1;var i=g.ChainStore.getAccount(a.issuer)?g.ChainStore.getAccount(a.issuer).get("name"):null;if(i&&e.state.searchTerm&&-1!==(i+"\0"+a.condition+"\0"+a.description).toUpperCase().indexOf(e.state.searchTerm))return!1;if(t&&"all"!==t){var o=new Date(a.forPredictions.description.expiry),s=(r.settlement_fund||0)>0||o<new Date;return"open"===t?!s:"past_resolution_date"===t&&s}return!0}))}},{key:"getOverviewSection",value:function(){var e=this,t=this._filterMarkets();return r.a.createElement("div",null,r.a.createElement("div",{className:"header-selector",style:{display:"inline-block",width:"100%"}},r.a.createElement("div",{className:"filter-block"},r.a.createElement(N.a,{onChange:this.onSearch,value:this.state.searchTerm}),r.a.createElement(y.Radio.Group,{style:{marginLeft:"20px"},value:this.state.predictionMarketAssetFilter,onChange:function(t){e.setState({predictionMarketAssetFilter:t.target.value})}},r.a.createElement(y.Radio,{value:"all"},d.a.translate("prediction.overview.all")),r.a.createElement(y.Radio,{value:"open"},d.a.translate("prediction.overview.open")),r.a.createElement(y.Radio,{value:"past_resolution_date"},d.a.translate("prediction.overview.past_resolution_date"))),r.a.createElement("span",null,r.a.createElement(y.Switch,{style:{marginLeft:"20px",cursor:"pointer"},onChange:this.handleUnknownHousesToggleChange,checked:this.state.isHideUnknownHousesChecked}),r.a.createElement(F.a,{onClick:this.handleUnknownHousesToggleChange,content:"prediction.overview.hide_unknown_houses",style:{marginLeft:"10px",cursor:"pointer"}}),r.a.createElement(y.Tooltip,{title:d.a.translate("prediction.tooltips.hide_unknown_houses")},r.a.createElement(y.Icon,{style:{marginLeft:"0.5rem"},type:"question-circle",theme:"filled"})),r.a.createElement(y.Switch,{style:{marginLeft:"20px",cursor:"pointer"},onChange:this.handleInvalidAssetsChecked,checked:this.state.isHideInvalidAssetsChecked}),r.a.createElement(F.a,{onClick:this.handleInvalidAssetsChecked,content:"prediction.overview.hide_invalid_asset",style:{marginLeft:"10px",cursor:"pointer"}}),r.a.createElement(y.Tooltip,{title:d.a.translate("prediction.tooltips.hide_invalid_asset")},r.a.createElement(y.Icon,{style:{marginLeft:"0.5rem"},type:"question-circle",theme:"filled"})))),r.a.createElement("div",{className:"filter-status"},d.a.translate("utility.x_assets_hidden",{count:this.props.predictionMarkets.length-t.length,total:this.props.predictionMarkets.length}))),r.a.createElement("div",{className:"header-selector",style:{display:"inline-block",width:"100%",paddingTop:"0rem"}},r.a.createElement("span",{className:"action-buttons"},r.a.createElement(y.Tooltip,{title:d.a.translate("prediction.tooltips.create_prediction_market_asset")},r.a.createElement(y.Icon,{style:{fontSize:"1.3rem",marginRight:"0.5rem"},type:"question-circle",theme:"filled"})),r.a.createElement(y.Button,{onClick:this.onCreatePredictionMarketModalOpen},d.a.translate("prediction.overview.create_market")))),r.a.createElement(S,{predictionMarkets:t,currentAccount:this.props.currentAccount,onMarketAction:this.onMarketAction,selectedPredictionMarket:this.state.selectedPredictionMarket,loading:this.props.loading}))}},{key:"getDetailsSection",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("h3",null,d.a.translate("prediction.details.list_of_current_prediction_offers"),r.a.createElement(y.Tooltip,{title:d.a.translate("prediction.tooltips.what_is_a_prediction_offer")},r.a.createElement(y.Icon,{style:{marginLeft:"0.5rem"},type:"question-circle",theme:"filled"}))),r.a.createElement("div",{className:"header-selector",style:{display:"inline-block",width:"100%"}},r.a.createElement("div",{className:"filter-block"},r.a.createElement(N.a,{onChange:this.onSearchDetails,value:this.state.detailsSearchTerm,autoComplete:"off"}),r.a.createElement(y.Radio.Group,{style:{marginLeft:"20px"},value:this.state.opinionFilter,onChange:function(t){e.setState({opinionFilter:t.target.value})}},r.a.createElement(y.Radio,{value:"all"},d.a.translate("prediction.details.all")),r.a.createElement(y.Radio,{value:"yes"},d.a.translate("prediction.details.proves_true")),r.a.createElement(y.Radio,{value:"no"},d.a.translate("prediction.details.incorrect")))),r.a.createElement("span",{className:"action-buttons"},r.a.createElement(y.Tooltip,{title:d.a.translate("prediction.tooltips.add_prediction")},r.a.createElement(y.Icon,{style:{fontSize:"1.3rem",marginRight:"0.5rem"},type:"question-circle",theme:"filled"})),r.a.createElement(y.Button,{onClick:this.onAddOpinionModalOpen},d.a.translate("prediction.details.add_prediction")))),this.state.opinions?r.a.createElement(I,{predictionMarketData:{predictionMarket:this.state.selectedPredictionMarket,opinions:this.state.opinions},currentAccount:this.props.currentAccount,onOppose:this.onOppose,onCancel:this.onCancelOpinion,detailsSearchTerm:this.state.detailsSearchTerm.toUpperCase(),opinionFilter:this.state.opinionFilter}):null)}},{key:"render",value:function(){var e=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(this.props.assets)).map((function(e){return e[1].symbol}));return r.a.createElement("div",{className:"prediction-markets grid-block vertical",style:{overflow:"visible",margin:"15px"}},r.a.createElement("div",{className:"grid-block small-12 shrink",style:{overflow:"visible"}},r.a.createElement(R.a,{path:"components/PredictionMarkets"})),this.getOverviewSection(),this.state.selectedPredictionMarket?this.getDetailsSection():null,this.state.isCreateMarketModalOpen?r.a.createElement(Q,{visible:this.state.isCreateMarketModalOpen,onClose:this.onCreatePredictionMarketModalClose,currentAccount:this.props.currentAccount.get("id"),symbols:e,onMarketCreated:this.updateAsset}):null,this.state.isAddOpinionModalOpen?r.a.createElement(B,{visible:this.state.isAddOpinionModalOpen,onClose:this.onAddOpinionModalClose,predictionMarket:this.state.selectedPredictionMarket,opinion:this.state.initialOpinion,currentAccount:this.props.currentAccount,preselectedOpinion:this.state.preselectedOpinion,preselectedAmount:this.state.preselectedAmount,preselectedProbability:this.state.preselectedProbability,baseAsset:this.state.subscribedMarket.base,quoteAsset:this.state.subscribedMarket.quote}):null,this.state.isResolveModalOpen?r.a.createElement(ee,{visible:this.state.isResolveModalOpen,onClose:this.onResolveModalClose,predictionMarket:this.state.selectedPredictionMarket,onResolveMarket:this.onResolveMarket}):null)}}]),t}(a.Component);ae=Object(i.a)(ae,{listenTo:function(){return[l.a,te.a]},getProps:function(){return{assets:l.a.getState().assets,bucketSize:te.a.getState().bucketSize,currentGroupOrderLimit:te.a.getState().currentGroupLimit,marketLimitOrders:te.a.getState().marketLimitOrders}}});var re=ae=Object(o.a)(ae),ie=n(190),oe=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();function se(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var le=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={lastAssetSymbol:"",predictionMarkets:[],fetching:!0,whitelistedIssuers:[],fetchAllAssets:!1},n}var n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),oe(t,[{key:"_getPredictionMarketList",value:function(e){return[].concat(se(e)).map((function(e){return e[1]})).filter(this._isPredictionMarket).map(this._normalizePredictionMarketAsset)}},{key:"componentDidUpdate",value:function(e){var t=this;if(e.assets!==this.props.assets&&this.state.fetchAllAssets){var n=this.props.assets.sort((function(e,t){return e.symbol>t.symbol?1:e.symbol<t.symbol?-1:0})).last(),a=this._getPredictionMarketList(this.props.assets);s.a.getAssetList.defer(n.symbol,100);var r=this.state.lastAssetSymbol===n.symbol;setTimeout((function(){t.setState({predictionMarkets:a,lastAssetSymbol:n.symbol,fetchAllAssets:!r,fetching:!r})}),0)}}},{key:"componentWillMount",value:function(){var e=this;Object(ie.d)().then((function(t){e._getWhitelistedAssets(t).then((function(n){var a=n.filter(e._isPredictionMarket).map(e._normalizePredictionMarketAsset);e.setState({whitelistedIssuers:t,predictionMarkets:a,fetching:!1})}))}))}},{key:"_normalizePredictionMarketAsset",value:function(e){return e.forPredictions||(e.forPredictions={description:c.a.parseDescription(e.options.description),flagBooleans:c.a.getFlagBooleans(e.options.flags,!0)}),function(e){var t=0,n=0;return e.forPredictions.flagBooleans.charge_market_fee&&(t=e.options.market_fee_percent,n=e.options.max_market_fee),{asset:e,short_backing_asset:(e.bitasset_data||e.bitasset||{}).options.short_backing_asset||"1.3.0",asset_id:e.id,issuer:e.issuer,description:e.forPredictions.description.main,symbol:e.symbol,condition:e.forPredictions.description.condition,expiry:e.forPredictions.description.expiry,options:e.options,marketConfidence:0,marketLikelihood:0,market_fee:t,max_market_fee:n}}(e)}},{key:"_isPredictionMarket",value:function(e){return!!e&&(e.bitasset_data||e.bitasset||{}).is_prediction_market}},{key:"_getWhitelistedAssets",value:(n=regeneratorRuntime.mark((function e(t){var n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,Object(g.FetchChainObjects)(g.ChainStore.getAccount,t,void 0,{});case 3:return e.sent.forEach((function(e){e&&(e=e.toJS(),n=[].concat(se(n),se(e.assets)))})),e.next=7,Object(g.FetchChainObjects)(g.ChainStore.getAsset,n,void 0,{});case 7:return a=e.sent,e.abrupt("return",a.map((function(e){return e.toJS()})));case 9:case"end":return e.stop()}}),e,this)})),a=function(){var e=n.apply(this,arguments);return new Promise((function(t,n){return function a(r,i){try{var o=e[r](i),s=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(s).then((function(e){a("next",e)}),(function(e){a("throw",e)}));t(s)}("next")}))},function(e){return a.apply(this,arguments)})},{key:"fetchAllAssets",value:function(){this.setState({fetching:!0,fetchAllAssets:!0},(function(){setTimeout((function(){return s.a.getAssetList("",100)}),300)}))}},{key:"render",value:function(){var e=this;return r.a.createElement(re,{assets:this.props.assets,whitelistedIssuers:this.state.whitelistedIssuers,predictionMarkets:this.state.predictionMarkets,loading:this.state.fetching,fetchAllAssets:function(){e.fetchAllAssets()}})}}]),t}(r.a.Component);le=Object(i.a)(le,{listenTo:function(){return[l.a,te.a]},getProps:function(){return{assets:l.a.getState().assets,bucketSize:te.a.getState().bucketSize,currentGroupOrderLimit:te.a.getState().currentGroupLimit,marketLimitOrders:te.a.getState().marketLimitOrders}}});t.default=le=Object(o.a)(le)}}]);
//# sourceMappingURL=pm.js.map
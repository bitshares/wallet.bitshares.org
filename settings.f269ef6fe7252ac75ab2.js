(this.webpackJsonp=this.webpackJsonp||[]).push([[21],{2020:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(2),s=a.n(o),i=a(35),l=a(2026),c=a(9),u=a.n(c),p=a(5),d=a.n(p),h=a(127),m=a(16),f=a(1),_=a.n(f),g=a(285),b=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var E=function(e){function t(){return y(this,t),w(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return v(t,e),b(t,[{key:"shouldComponentUpdate",value:function(e){return!m.a.are_equal_shallow(e.assets,this.props.assets)||e.value!==this.props.value||e.scroll_length!==this.props.scroll_length}},{key:"render",value:function(){return this.props.assets.length?r.a.createElement(l.a,{entries:this.props.assets.map((function(e){return e&&e.get("symbol")})).filter((function(e){return!!e})),values:this.props.assets.reduce((function(e,t){return t&&t.get("symbol")&&(e[t.get("symbol")]=t),e}),{}),singleEntry:this.props.assets[0]?r.a.createElement(i.a,{asset:this.props.assets[0].get("id"),amount:0,hide_amount:!0}):null,value:this.props.value,onChange:this.props.onChange,scroll_length:this.props.scroll_length}):null}}]),t}(r.a.Component);E.propTypes={value:_.a.string,onChange:_.a.func,scroll_length:_.a.number},E=Object(h.a)(E,{asList:!0});var k=function(e){function t(){return y(this,t),w(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return v(t,e),b(t,[{key:"componentDidMount",value:function(){this.onAssetChange(this.props.asset)}},{key:"formatAmount",value:function(e){return e||(e=""),"number"==typeof e&&(e=e.toString()),e.trim().replace(/,/g,"")}},{key:"_onChange",value:function(e){this.props.onChange&&this.props.onChange({amount:this.getNumericEventValue(e),asset:this.props.asset})}},{key:"onAssetChange",value:function(e){this.props.onChange&&this.props.onChange({amount:this.props.amount,asset:e})}},{key:"render",value:function(){var e=this.props.error?d.a.translate(this.props.error):this.formatAmount(this.props.amount);return r.a.createElement("div",{className:"amount-selector",style:this.props.style},r.a.createElement("label",{className:"right-label"},this.props.display_balance),r.a.createElement(s.a,{className:"left-label",component:"label",content:this.props.label}),r.a.createElement("div",{className:"inline-label input-wrapper"},r.a.createElement("input",{disabled:this.props.disabled,type:"text",value:e||"",placeholder:this.props.placeholder,onChange:this._onChange.bind(this),tabIndex:this.props.tabIndex,onPaste:this.props.onPaste||this.onPaste.bind(this),onKeyPress:this.onKeyPress.bind(this)}),r.a.createElement("div",{className:"form-label select floating-dropdown"},this.props.isPrice?r.a.createElement("div",{className:"dropdown-wrapper inactive"},r.a.createElement("div",null,this.props.asset.get("symbol"),"/",this.props.base)):r.a.createElement(E,{ref:this.props.refCallback,value:this.props.asset.get("symbol"),assets:u.a.List(this.props.assets),onChange:this.onAssetChange.bind(this),scroll_length:this.props.scroll_length}))))}}]),t}(g.a);k.propTypes={label:_.a.string,assets:_.a.array,amount:_.a.any,placeholder:_.a.string,onChange:_.a.func,tabIndex:_.a.number,error:_.a.string,scroll_length:_.a.number},k.defaultProps={disabled:!1,tabIndex:0},k=Object(h.a)(k),t.a=k},2030:function(e,t,a){"use strict";a.d(t,"b",(function(){return h})),a.d(t,"a",(function(){return m}));var n=a(0),r=a.n(n),o=a(44),s=a(591),i=a.n(s),l=a(48),c=a(30),u=a(23),p=a(41),d=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var h=function(e){return!!e&&!!e.get("id")},m=function(e){var t,a,n=(a=t=function(t){function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,t),d(a,[{key:"render",value:function(){return h(this.props.currentAccount)?r.a.createElement(e,this.props):r.a.createElement(p.a,null)}}]),a}(r.a.Component),t.propTypes={currentAccount:o.a.ChainAccount},t.defaultProps={autosubscribe:!0},a);return n=Object(l.a)(n),n=i()(n,100,{leading:!1}),Object(c.a)(n,{listenTo:function(){return[u.a]},getProps:function(){var e=u.a.getState().currentAccount||u.a.getState().passwordAccount||"please-login";return{currentAccount:new Map([["name",e]])}}})}},2313:function(e,t,a){"use strict";(function(e){var n=a(33),r=(a(15),a(87)),o=a(20),s=a(6),i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var l=function(e,t){var a=null;switch(e){case"sha256":a=s.hash.sha256(t);break;case"ripemd160":a=s.hash.ripemd160(t);break;case"sha1":throw new Error("sha1 is not considered a secure hashing algorithm, plaase use sha256");default:throw new Error("Wrong cipher name provided when creating htlc op")}return a},c=function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t)}return i(t,[{key:"create",value:function(e){var t=e.from_account_id,a=e.to_account_id,n=e.asset_id,s=e.amount,i=e.lock_time,c=e.preimage_cipher,u=e.preimage,p=void 0===u?null:u,d=e.preimage_hash,h=void 0===d?null:d,m=e.preimage_size,f=void 0===m?null:m,_=e.fee_asset,g=void 0===_?null:_;g||(g="1.3.0"),"string"!=typeof g&&(g=g.get("id"));var b=r.a.new_transaction(),y=function(e){var t=null;switch(e){case"sha256":t=2;break;case"ripemd160":t=0;break;case"sha1":throw new Error("sha1 is not considered a secure hashing algorithm, plaase use sha256");default:throw new Error("Wrong cipher name provided when creating htlc op")}return t}(c);if(p&&!h&&(h=l(c,p)),!f){if(!p)throw Error("Preimage must be given if size is empty");f=p.length}return b.add_type_operation("htlc_create",{from:t,to:a,fee:{amount:0,asset_id:g},amount:{amount:s,asset_id:n},preimage_hash:[y,h],preimage_size:f,claim_period_seconds:i}),function(e){return o.a.process_transaction(b,null,!0).then((function(){e(!0)})).catch((function(t){console.log("[HtlcActions.js:69] ----- htlc create error -----\x3e",t),e(!1)}))}}},{key:"redeem",value:function(t){var a=t.htlc_id,n=t.user_id,s=t.preimage,i=r.a.new_transaction();return i.add_type_operation("htlc_redeem",{preimage:new e(s).toString("hex"),fee:{amount:0,asset_id:"1.3.0"},htlc_id:a,redeemer:n}),function(e){return o.a.process_transaction(i,null,!0).then((function(){e(!0)})).catch((function(t){console.log("[HtlcActions.js:98] ----- htlc redeem error -----\x3e",t),e(!1)}))}}},{key:"extend",value:function(e){var t=e.htlc_id,a=e.user_id,n=e.seconds_to_add,s=r.a.new_transaction();return s.add_type_operation("htlc_extend",{fee:{amount:0,asset_id:"1.3.0"},htlc_id:t,update_issuer:a,seconds_to_add:n}),function(e){return o.a.process_transaction(s,null,!0).then((function(){e(!0)})).catch((function(t){console.log("[HtlcActions.js:127] ----- htlc extend error -----\x3e",t),e(!1)}))}}},{key:"calculateHash",value:function(t,a){var n=l(a,t),r=n.length;return{hash:new e(n).toString("hex"),size:r}}}]),t}();t.a=n.a.createActions(c)}).call(this,a(126).Buffer)},2314:function(e,t,a){},2316:function(e,t,a){"use strict";(function(e){var n=a(606),r=a(0),o=a.n(r),s=a(2),i=a.n(s),l=a(6),c=a(593),u=(a(591),a(23),a(282)),p=a(2317),d=a(16),h=a(5),m=a.n(h),f=a(4),_=a(243),g=a(372),b=a(27),y=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function w(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,a){return function n(r,o){try{var s=t[r](o),i=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(i).then((function(e){n("next",e)}),(function(e){n("throw",e)}));e(i)}("next")}))}}var v=function(t){function a(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,t));return n.onSubmit=function(t){t.preventDefault();var a=n.state,r=a.from_account,o=a.to_account,s=a.feeAsset,i=a.permissionId,l=a.amount,c=a.asset,u=a.asset_id,p=a.memo;_.a.claimWithdrawPermission(i,r,o,u,d.a.convert_typed_to_satoshi(l,c),p?new e(p,"utf-8"):p,s.asset_id).then((function(e){n.props.hideModal()})).catch((function(e){n.setState({errorMessage:e})}))},n.setTotalLimit=function(e){return function(){var t=n.state,a=t.asset,r=t.claimedAmount,o=d.a.get_asset_amount(e-r,a);n.setState({maxAmount:!0,amount:o})}},n.onAmountChanged=function(e){var t=e.amount,a=e.asset;a&&n.setState({amount:t,asset:a,asset_id:a.get("id"),error:null,maxAmount:!1})},n.state=n.getInitialState(t),n}var r,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,t),y(a,[{key:"getInitialState",value:function(){return{to_name:"",from_account:null,from_account_balance:null,to_account:null,amount:"",asset_id:null,asset:null,memo:"",error:null,feeAsset:null,maxAmount:!1,permissionId:"",firstPeriodError:!1,payerBalanceWarning:!1,withdrawal_limit:this.props.operation.payload.withdrawal_limit,current_period_expires:"",claimedAmount:"",errorMessage:null}}},{key:"componentDidUpdate",value:(s=w(regeneratorRuntime.mark((function e(t,a){var n,r,o,s,i,c,u,p,d,h,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.props,r=n.operation,!n.isModalVisible||!r||a.permissionId===r.payload.id){e.next=21;break}return o=new Date(r.payload.period_start_time+"Z").getTime(),s=(new Date).getTime()-o,i=void 0,c="",u=1e3*r.payload.withdrawal_period_sec,s<0?console.log("first period is not started"):(i=Math.ceil(s/u),c=o+u*i),e.next=10,Object(l.FetchChain)("getAccount",r.payload.authorized_account);case 10:return p=e.sent,e.next=13,Object(l.FetchChain)("getAccount",r.payload.withdraw_from_account);case 13:return d=e.sent,e.next=16,Object(l.FetchChain)("getAsset",r.payload.withdrawal_limit.asset_id);case 16:return h=e.sent,e.next=19,this._checkBalance(d,r.payload.withdrawal_limit);case 19:m=e.sent,this.setState({to_account:p,from_account:d,permissionId:r.payload.id,withdrawal_limit:r.payload.withdrawal_limit,claimedAmount:r.payload.claimed_this_period,current_period_expires_date:c,asset:h,from_account_balance:m});case 21:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"onFeeChanged",value:function(e){this.setState({feeAsset:e})}},{key:"onMemoChanged",value:function(e){this.setState({memo:e.target.value})}},{key:"_checkBalance",value:(r=w(regeneratorRuntime.mark((function e(){var t,a,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!1,null==r&&(r=this.state.from_account,t=!0),null==o&&(o=this.state.withdrawal_limit,t=!0),a=r.getIn(["balances",o.asset_id]),n=0,!a){e.next=9;break}return e.next=8,Object(l.FetchChain)("getObject",a);case 8:n=e.sent.get("balance");case 9:return t&&this.setState({from_account_balance:n}),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"render",value:function(){var e=this.state,t=e.from_account,a=e.from_account_balance,r=e.to_account,s=e.asset,l=e.amount,h=e.memo,_=e.payerBalanceWarning,y=e.withdrawal_limit,w=e.current_period_expires_date,v=!1,E=!1,k=0;y&&(k=null!==a?Math.min(a,y.amount):y.amount,s&&l&&(v=d.a.convert_typed_to_satoshi(l,s)>k),null!==a&&a<y.amount&&(E=!0));var C=null;t&&t.get("balances")&&(C=o.a.createElement("span",null,o.a.createElement(i.a,{component:"span",content:"showcases.direct_debit.limit"}),":"," ",o.a.createElement("span",{className:v?"has-error":"",style:{borderBottom:"#A09F9F 1px dotted",cursor:"pointer"},onClick:this.setTotalLimit(k)},o.a.createElement(p.a,{amount:k,assetId:y&&y.asset_id})),"Â ",E&&o.a.createElement(f.Tooltip,{placement:"topRight",title:o.a.createElement(b.a,{string:"showcases.direct_debit.payer_balance_not_sufficient",keys:[{type:"amount",value:y,arg:"limit"}]})},o.a.createElement(f.Icon,{type:"exclamation-circle",theme:"filled",style:{color:"#fe8c00"}}))));var S=parseFloat(String.prototype.replace.call(l,/,/g,"")),O=S&&!Object(n.a)(S),x=!t||!r||!O||!s||E||v||_||!w||t.get("id")==r.get("id");return o.a.createElement(f.Modal,{title:m.a.translate("showcases.direct_debit.claim_funds"),visible:this.props.isModalVisible,overlay:!0,onCancel:this.props.hideModal,footer:[this.state.errorMessage&&o.a.createElement("span",{className:"red",style:{marginRight:"10px"}},this.state.errorMessage),o.a.createElement(f.Button,{key:"send",disabled:x,onClick:x?null:this.onSubmit.bind(this)},m.a.translate("showcases.direct_debit.claim")),o.a.createElement(f.Button,{key:"Cancel",onClick:this.props.hideModal},o.a.createElement(i.a,{component:"span",content:"transfer.cancel"}))]},o.a.createElement("div",{className:"grid-block vertical no-overflow"},o.a.createElement(f.Form,{className:"full-width",layout:"vertical"},o.a.createElement(u.a,{label:"showcases.direct_debit.authorizing_account",accountName:r?r.get("name"):"",account:r,size:60,hideImage:!0,disabled:!0,noForm:!0}),o.a.createElement(f.Form.Item,{label:m.a.translate("showcases.direct_debit.current_period_expires")},o.a.createElement(f.Input,{type:"text",value:w?m.a.localize(new Date(w),{type:"date",format:"full"}):m.a.translate("showcases.direct_debit.first_period_not_started"),disabled:!0,className:w?"":"error-area"})),o.a.createElement(c.a,{label:"showcases.direct_debit.amount_to_withdraw",amount:l,onChange:this.onAmountChanged,asset:y&&y.asset_id,assets:y&&[y.asset_id],display_balance:C,allowNaN:!0}),h&&h.length?o.a.createElement("label",{className:"right-label"},h.length):null,o.a.createElement(f.Form.Item,{label:o.a.createElement(f.Tooltip,{placement:"top",title:m.a.translate("tooltip.memo_tip")},m.a.translate("transfer.memo"))},o.a.createElement(f.Input.TextArea,{style:{marginBottom:0},rows:"3",value:h,onChange:this.onMemoChanged.bind(this)})),o.a.createElement(g.a,{account:r,transaction:{type:"withdraw_permission_claim",options:["price_per_kbyte"],data:{type:"memo",content:h}},onChange:this.onFeeChanged.bind(this)}))))}}]),a}(o.a.Component);t.a=v}).call(this,a(126).Buffer)},2317:function(e,t,a){"use strict";var n=a(0),r=a.n(n),o=a(35),s=a(1),i=a.n(s),l=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var c=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),l(t,[{key:"render",value:function(){return r.a.createElement(o.a,{amount:this.props.amount,asset:this.props.assetId,asPercentage:this.props.asPercentage,assetInfo:this.props.assetInfo,replace:this.props.replace,hide_asset:this.props.hide_asset})}}]),t}(r.a.Component);c.propTypes={hide_asset:i.a.bool},c.defaultProps={hide_asset:!1},t.a=c},2320:function(e,t,a){"use strict";var n=a(305),r=a(598),o=a(616),s=a(225);var i=function(e,t){var a=-1,n=Object(s.a)(e)?Array(e.length):[];return Object(o.a)(e,(function(e,r,o){n[++a]=t(e,r,o)})),n},l=a(53);t.a=function(e,t){return(Object(l.a)(e)?n.a:i)(e,Object(r.a)(t,3))}},2327:function(e,t,a){"use strict";a.r(t),function(e){var n=a(2320),r=a(0),o=a.n(r),s=a(2),i=a.n(s),l=a(4),c=a(282),u=a(372),p=a(5),d=a.n(p),h=a(23),m=a(6),f=a(2020),_=a(40),g=a(16),b=a(212),y=a(371),w=a(243),v=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function E(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}function k(e,t){if(e)return e/Math.pow(10,t)}var C=function(t){function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return e.onMemoChanged=function(t,a){return function(n){var r=Object.assign({},e.state.memo);r[t][a]={message:n.target.value,shown:!0},e.setState({memo:r})}},e.handleMemoOpen=function(t,a){return function(n){var r=Object.assign({},e.state.memo);r[t][a]={message:"",shown:!0},e.setState({memo:r})}},e.state={from_name:"",to_name:"",from_account:null,to_account:null,from_barter:[{index:0,from_amount:"",from_asset_id:null,from_asset:null,from_feeAsset:new _.a({amount:0,asset_id:"1.3.0"}),from_hasPoolBalance:null,from_balanceError:!1}],to_barter:[{index:0,to_amount:"",to_asset_id:null,to_asset:null,to_feeAsset:new _.a({amount:0,asset_id:"1.3.0"}),to_hasPoolBalance:null,to_balanceError:!1}],amount_counter:[],amount_index:0,from_error:null,to_error:null,memo:{from_barter:[{message:"",shown:!1}],to_barter:[{message:"",shown:!1}],escrow:[{message:"",shown:!1}]},proposal_fee:{amount:0,asset_id:"1.3.0"},showEscrow:!1,escrow_account_name:"",escrow_account:null,send_to_escrow:!1,escrow_payment:0,escrow_payment_changed:!1,escrowFeeAssetId:"1.3.0",balanceWarning:{peer1:[],peer2:[]}},e._checkBalance=e._checkBalance.bind(e),e.onTrxIncluded=e.onTrxIncluded.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,t),v(a,[{key:"componentWillMount",value:function(){var e=h.a.getState().currentAccount;this.state.from_name||this.setState({from_name:e})}},{key:"fromChanged",value:function(e){this.setState({from_name:e})}},{key:"escrowAccountChanged",value:function(e){this.setState({escrow_account_name:e})}},{key:"onFromAccountChanged",value:function(e){this.setState({from_account:e,from_barter:[{from_amount:"",from_asset_id:null,from_asset:null,from_feeAsset:new _.a({amount:0,asset_id:"1.3.0"}),from_hasPoolBalance:null,from_balanceError:!1}]})}},{key:"onEscrowAccountChanged",value:function(e){this.setState({escrow_account:e})}},{key:"toChanged",value:function(e){this.setState({to_name:e})}},{key:"onToAccountChanged",value:function(e){this.setState({to_account:e,to_barter:[{to_amount:"",to_asset_id:null,to_asset:null,to_feeAsset:new _.a({amount:0,asset_id:"1.3.0"}),to_hasPoolBalance:null,to_balanceError:!1}]})}},{key:"onFromAmountChanged",value:function(e,t){var a=this,n=t.asset,r=t.amount;if(n){var o=[].concat(E(this.state.from_barter));o[e]={index:e,from_amount:r,from_asset:n,from_asset_id:n.get("id"),from_balanceError:!1,from_feeAsset:o[e].from_feeAsset},this.setState({from_barter:o,from_error:null},(function(){a._checkBalance(o[e].from_feeAsset,r,a.state.from_account,n,e,!0,o[e].from_feeAsset.asset_id,o),a.checkAmountsTotal()}))}}},{key:"onToAmountChanged",value:function(e,t){var a=this,n=t.asset,r=t.amount;if(n){var o=[].concat(E(this.state.to_barter));o[e]={index:e,to_amount:r,to_asset:n,to_asset_id:n.get("id"),to_feeAsset:o[e].to_feeAsset,to_balanceError:!1},this.setState({to_barter:o,to_error:null},(function(){a._checkBalance(o[e].to_feeAsset,r,a.state.to_account,n,e,!1,o[e].to_feeAsset.asset_id,o),a.checkAmountsTotal()}))}}},{key:"_checkBalance",value:function(e,t,a,n,r,o,s,i){if(n&&a){var l=a.getIn(["balances",n.get("id")]),c=a.getIn(["balances",e.asset_id]);if(n&&a){if(!l)return o?(i[r].from_balanceError=!0,this.setState({from_barter:i})):(i[r].to_balanceError=!0,this.setState({to_barter:i}));var u=m.ChainStore.getObject(l),p=c?m.ChainStore.getObject(c):null;if(p&&0!==p.get("balance")||(o?this.setState({from_barter:i}):this.setState({to_barter:i})),u&&e){if(!t)return o?(i[r].from_balanceError=!1,this.setState({from_barter:i})):(i[r].to_balanceError=!1,this.setState({to_barter:i}));var d=Object(b.a)(t,n,e,u);if(null!==d)return o?(i[r].from_balanceError=!d,this.setState({from_barter:i})):(i[r].to_balanceError=!d,this.setState({to_barter:i}))}}}}},{key:"_getAvailableAssets",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state,t=e.from_account,a=e.from_error,n=e.to_account,r=e.to_error,o=function(e,t){var a=[],n=[];if(!e||!e.get("balances")||t)return{asset_types:a,fee_asset_types:n};var r=e.get("balances").toJS();for(var o in a=Object.keys(r).sort(g.a.sortID),n=Object.keys(r).sort(g.a.sortID),r){var s=m.ChainStore.getObject(r[o]);s&&0===s.get("balance")&&(a.splice(a.indexOf(o),1),-1!==n.indexOf(o)&&n.splice(n.indexOf(o),1))}return{asset_types:a,fee_asset_types:n}},s=o(t,a),i=o(n,r);return{from_asset_types:s.asset_types||[],to_asset_types:i.asset_types||[],from_fee_asset_types:s.fee_asset_types||[],to_fee_asset_types:i.fee_asset_types||[]}}},{key:"addFromAmount",value:function(){this.state.from_barter.push({from_amount:"",from_asset_id:null,from_asset:null,from_feeAsset:new _.a({amount:0,asset_id:"1.3.0"})}),this.setState({from_barter:this.state.from_barter})}},{key:"addToAmount",value:function(){this.state.to_barter.push({to_amount:"",to_asset_id:null,to_asset:null,to_feeAsset:new _.a({amount:0,asset_id:"1.3.0"})}),this.setState({to_barter:this.state.to_barter})}},{key:"onSubmit",value:function(t){var a=this;t.preventDefault(),this.setState({from_error:null,to_error:null});var n=void 0,r=[],o=h.a.getState().currentAccount,s=this.state.from_account,i=this.state.memo.escrow[0]&&this.state.memo.escrow[0].message;if(this.state.showEscrow&&this.state.send_to_escrow&&(s=this.state.escrow_account),this.state.showEscrow){var l=this.state.escrow_payment_changed?new _.a({real:this.state.escrow_payment}).getAmount():fee(!0);l>0&&r.push({from_account:this.state.from_account.get("id"),to_account:this.state.escrow_account.get("id"),amount:l,asset:"1.3.0",memo:i?new e(i,"utf-8"):null,feeAsset:this.state.escrowFeeAssetId,propose_account:o})}this.state.from_barter.forEach((function(t,l){var c=t.from_asset,u=t.from_amount;n=new _.a({real:u,asset_id:c.get("id"),precision:c.get("precision")});var p=a.state.memo.from_barter[l]&&a.state.memo.from_barter[l].message;a.state.showEscrow&&a.state.send_to_escrow&&r.push({from_account:a.state.from_account.get("id"),to_account:a.state.escrow_account.get("id"),amount:n.getAmount(),asset:c.get("id"),memo:i?new e(i,"utf-8"):null,feeAsset:t.from_feeAsset?t.from_feeAsset.asset_id:"1.3.0"}),r.push({from_account:s.get("id"),to_account:a.state.to_account.get("id"),amount:n.getAmount(),asset:c.get("id"),memo:p?new e(p,"utf-8"):null,feeAsset:t.from_feeAsset?t.from_feeAsset.asset_id:"1.3.0",propose_account:o})})),this.state.showEscrow&&!this.state.send_to_escrow&&r.push({from_account:this.state.escrow_account.get("id"),to_account:this.state.from_account.get("id"),amount:1,asset:"1.3.0",memo:null,feeAsset:this.state.escrowFeeAssetId,propose_account:o}),this.state.to_barter.forEach((function(t,s){var i=t.to_asset,l=t.to_amount,c=a.state.memo.to_barter[s]&&a.state.memo.to_barter[s].message;n=new _.a({real:l,asset_id:i.get("id"),precision:i.get("precision")}),r.push({from_account:a.state.to_account.get("id"),to_account:a.state.from_account.get("id"),amount:n.getAmount(),asset:i.get("id"),memo:c?new e(c,"utf-8"):null,feeAsset:t.to_feeAsset?t.to_feeAsset.asset_id:"1.3.0",propose_account:o})})),w.a.transfer_list(r,this.state.proposal_fee.asset_id)}},{key:"onTrxIncluded",value:function(e){e.included&&e.broadcasted_transaction?(TransactionConfirmStore.unlisten(this.onTrxIncluded),TransactionConfirmStore.reset()):e.closed&&(TransactionConfirmStore.unlisten(this.onTrxIncluded),TransactionConfirmStore.reset())}},{key:"renderMemoField",value:function(e,t){var a=this.state.memo,n=a[e][t]&&a[e][t].message?a[e][t].message:"";return o.a.createElement("div",{className:"content-block transfer-input"},o.a.createElement(i.a,{className:"left-label",component:"label",content:"transfer.memo"}),o.a.createElement("textarea",{style:{marginBottom:0},rows:"1",value:n,onChange:this.onMemoChanged(e,t)}))}},{key:"getBalance",value:function(e,t){return m.ChainStore.getAccountBalance(e,t)}},{key:"checkAmountsTotal",value:function(){var e=this,t=this.state,a=t.from_barter,r=t.to_barter,o=t.from_account,s=t.to_account,i={},l={};a.forEach((function(e){e.from_amount&&(i.hasOwnProperty(e.from_asset_id)?i[e.from_asset_id]={amount:Number(i[e.from_asset_id].amount)+Number(e.from_amount),precision:e.from_asset.get("precision"),symbol:e.from_asset.get("symbol")}:i[e.from_asset_id]={amount:Number(e.from_amount),precision:e.from_asset.get("precision"),symbol:e.from_asset.get("symbol")})}));var c=Object(n.a)(i,(function(t,a){var n=e.getBalance(o,a),r=Math.max(0,t.precision),s=n?k(n,r):0;return t.assetId=a,t.amount>s&&(t.warning=!0,t.balance=s),t}));r.forEach((function(e){e.to_amount&&(l.hasOwnProperty(e.to_asset_id)?l[e.to_asset_id]={amount:Number(l[e.to_asset_id].amount)+Number(e.to_amount),precision:e.to_asset.get("precision"),symbol:e.to_asset.get("symbol")}:l[e.to_asset_id]={amount:Number(e.to_amount),precision:e.to_asset.get("precision"),symbol:e.to_asset.get("symbol")})}));var u=Object(n.a)(l,(function(t,a){var n=e.getBalance(s,a),r=Math.max(0,t.precision),o=n?k(n,r):0;return t.assetId=a,t.amount>o&&(t.warning=!0,t.balance=o),t}));this.setState({balanceWarning:{peer1:c,peer2:u}})}},{key:"renderBalanceWarnings",value:function(){var e=this.state.balanceWarning,t=e.peer1,a=e.peer2,n=t.some((function(e){return!!e.warning})),r=a.some((function(e){return!!e.warning})),s=d.a.translate("showcases.barter.peer_left"),i=d.a.translate("showcases.barter.peer_right"),c=n?o.a.createElement("div",{style:{maxWidth:"25rem"}},d.a.translate("showcases.barter.balance_warning_tooltip",{peer:s}),o.a.createElement("br",null),t.map((function(e){if(e.warning)return o.a.createElement(o.a.Fragment,null,o.a.createElement("br",null),o.a.createElement("span",{style:{marginRight:"10px"},key:e.assetId}," - "+d.a.translate("showcases.barter.balance_warning_line",{asset_symbol:e.symbol,asset_balance:e.balance,asset_amount:e.amount})))}))):null,u=r?o.a.createElement("div",{style:{maxWidth:"25rem"}},d.a.translate("showcases.barter.balance_warning_tooltip",{peer:i}),a.map((function(e){if(e.warning)return o.a.createElement("span",{style:{marginRight:"10px"},key:e.assetId},o.a.createElement("br",null),o.a.createElement("br",null),d.a.translate("showcases.barter.balance_warning_line",{asset_symbol:e.symbol,asset_balance:e.balance,asset_amount:e.amount}),";")}))):null;return o.a.createElement("span",{className:"barter-balance-warning"},n&&o.a.createElement(l.Popover,{content:c,title:d.a.translate("showcases.barter.balance_warning")},o.a.createElement("span",{style:{cursor:"help"}},o.a.createElement(l.Alert,{style:{display:"inline",marginRight:"1rem"},message:s+" "+d.a.translate("showcases.barter.balance_warning"),type:"warning",showIcon:!0}))),r&&o.a.createElement(l.Popover,{content:u,title:d.a.translate("showcases.barter.balance_warning")},o.a.createElement("span",{style:{cursor:"help"}},o.a.createElement(l.Alert,{style:{display:"inline"},message:i+" "+d.a.translate("showcases.barter.balance_warning"),type:"warning",showIcon:!0}))))}},{key:"onFeeChangedPeer1CreateProposal",value:function(e){this.setState({proposal_fee:e})}},{key:"onFeeChangedPeer1InProposal",value:function(e){var t=this.state.from_barter.map((function(t){return t.to_feeAsset=e,t}));this.setState({from_barter:t})}},{key:"onFeeChangedPeer2InProposal",value:function(e){var t=this.state.to_barter.map((function(t){return t.to_feeAsset=e,t}));this.setState({to_barter:t})}},{key:"onEscrowFeeChanged",value:function(e){this.setState({escrowFeeAssetId:e.asset_id})}},{key:"render",value:function(){var e=this,t=this.state,a=t.from_name,n=t.to_name,r=t.from_account,s=t.to_account,p=t.from_barter,h=t.to_barter,_=t.amount_index,g=t.from_error,b=t.to_error,w=this._getAvailableAssets(),v=w.from_asset_types,E=w.to_asset_types,k=window.innerWidth<850,C=[],S=[],O="",x="",A=function(){var e=!0,t=!1,a=void 0;try{for(var n,r=p[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var o=n.value,s=parseFloat(String.prototype.replace.call(o.from_amount,/,/g,""));if(isNaN(s)||0===s)return!1}}catch(e){t=!0,a=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw a}}var i=!0,l=!1,c=void 0;try{for(var u,d=h[Symbol.iterator]();!(i=(u=d.next()).done);i=!0){var m=u.value;s=parseFloat(String.prototype.replace.call(m.to_amount,/,/g,""));if(isNaN(s)||0===s)return!1}}catch(e){l=!0,c=e}finally{try{!i&&d.return&&d.return()}finally{if(l)throw c}}return!0},j=function(e){console.log(p);var t=0;return e?(t=t,p.forEach((function(e){t+=e.from_feeAsset._real_amount}))):h.forEach((function(e){t+=e.to_feeAsset._real_amount})),t},N=this.state.showEscrow&&!this.state.escrow_account,M=!r||!s||r.get("id")==s.get("id")||b||!A()||g||N,T=function(e,t,a,n){if(e&&e.get("balances")){var r=e.get("balances").toJS(),s=t?"has-error":"";if(1===a.length&&(n=m.ChainStore.getAsset(a[0])),a.length>0){var l=n?n.get("id"):a[0];return o.a.createElement("span",null,o.a.createElement(i.a,{component:"span",content:"transfer.available"}),":"," ",o.a.createElement("span",{className:s,style:{borderBottom:"#A09F9F 1px dotted",cursor:"pointer"}},o.a.createElement(y.a,{balance:r[l]})))}return o.a.createElement("span",null,o.a.createElement("span",{className:s},o.a.createElement(i.a,{content:"transfer.errors.noFunds"})))}},P=p.map((function(t,a){var n="";t.from_asset&&(n=t.from_asset.get("symbol"),C.push([t.from_amount||0,n].join(" ")));var s=e.state.memo.from_barter[a]&&e.state.memo.from_barter[a].shown;return o.a.createElement("div",{key:_++},o.a.createElement("div",{style:{position:"relative"}},!s&&o.a.createElement(l.Tooltip,{title:d.a.translate("tooltip.add_memo_field"),placement:"topLeft"},o.a.createElement(l.Button,{onClick:e.handleMemoOpen("from_barter",a),size:"small",icon:"message",className:"add-memo-btn"})),o.a.createElement(f.a,{label:"showcases.barter.bartering_asset",style:{marginBottom:"1rem"},amount:t.from_amount,onChange:e.onFromAmountChanged.bind(e,a),asset:v.length>0&&t.from_asset?t.from_asset.get("id"):t.from_asset_id?t.from_asset_id:v[0],assets:v,display_balance:T(r,t.from_balanceError,v,t.from_asset),allowNaN:!0})),s&&e.renderMemoField("from_barter",a))})),I=h.map((function(t,a){t.to_asset&&(t.to_asset.get("symbol"),S.push([t.to_amount||0,t.to_asset.get("symbol")].join(" ")));var n=e.state.memo.to_barter[a]&&e.state.memo.to_barter[a].shown;return o.a.createElement("div",{key:_++},o.a.createElement("div",{style:{position:"relative"}},!n&&o.a.createElement(l.Tooltip,{title:d.a.translate("tooltip.add_memo_field"),placement:"topLeft"},o.a.createElement(l.Button,{onClick:e.handleMemoOpen("to_barter",a),size:"small",icon:"message",className:"add-memo-btn"})),o.a.createElement(f.a,{label:"showcases.barter.bartering_asset",style:{marginBottom:"1rem"},amount:t.to_amount,onChange:e.onToAmountChanged.bind(e,a),asset:E.length>0&&t.to_asset?t.to_asset.get("id"):t.to_asset_id?t.to_asset_id:E[0],assets:E,display_balance:T(s,t.to_balanceError,E,t.to_asset),allowNaN:!0})),n&&e.renderMemoField("to_barter",a))})),B=o.a.createElement(l.Card,{style:{borderRadius:"10px"}},o.a.createElement(i.a,{content:"showcases.barter.peer_left"}),o.a.createElement(c.a,{label:"showcases.barter.account",placeholder:"placeholder",style:{marginTop:"0.5rem",marginBottom:"1rem"},allowPubKey:!0,allowUppercase:!0,account:r,accountName:a,onChange:this.fromChanged.bind(this),onAccountChanged:this.onFromAccountChanged.bind(this),hideImage:!0,typeahead:!0}),r&&o.a.createElement("div",null,P,o.a.createElement("div",{style:{paddingTop:"10px",paddingBottom:"10px"}},o.a.createElement(l.Button,{onClick:this.addFromAmount.bind(this),disabled:!r||!this.state.from_barter[this.state.from_barter.length-1].from_amount},"+ Add asset")))),D=o.a.createElement(l.Card,{style:{borderRadius:"10px"}},o.a.createElement(i.a,{content:"showcases.barter.peer_right"}),o.a.createElement(c.a,{label:"showcases.barter.account",placeholder:"placeholder",style:{marginTop:"0.5rem",marginBottom:"1rem"},allowPubKey:!0,allowUppercase:!0,account:s,accountName:n,onChange:this.toChanged.bind(this),onAccountChanged:this.onToAccountChanged.bind(this),hideImage:!0,typeahead:!0}),s&&o.a.createElement("div",null,I,o.a.createElement("div",{style:{paddingTop:"10px",paddingBottom:"10px"}},o.a.createElement(l.Button,{onClick:this.addToAmount.bind(this),disabled:!s||!this.state.to_barter[this.state.to_barter.length-1].to_amount},"+ Add asset")))),R="showcases.barter.not_complete";M&&(r?s?r.get("id")==s.get("id")?R="showcases.barter.error_same_name":A()?N?R="showcases.barter.error_fill_in_escrow_name":!this.state.showEscrow||r.get("id")!=this.state.escrow_account.get("id")&&s.get("id")!=this.state.escrow_account.get("id")||(R="showcases.barter.error_same_name_escrow"):R="showcases.barter.error_fill_in_valid_asset_amount":R="showcases.barter.error_fill_in_peer_right_name":R="showcases.barter.error_fill_in_peer_left_name");var F=o.a.createElement(l.Card,{style:{borderRadius:"10px"}},!M&&o.a.createElement("div",{className:"left-label",style:{fontSize:"1rem"}},d.a.translate("showcases.barter.action",{peer_left:a,assets_left:C.join(", "),peer_right:n,assets_right:S.join(", ")}),this.state.showEscrow&&!this.state.send_to_escrow&&d.a.translate("showcases.barter.escrow_as_witness",{escrow:this.state.escrow_account.get("name")}),this.state.showEscrow&&this.state.send_to_escrow&&d.a.translate("showcases.barter.escrow_as_custodian",{escrow:this.state.escrow_account.get("name")})),M&&o.a.createElement("div",{className:"left-label",style:{fontSize:"1rem"}},d.a.translate(R)),o.a.createElement(l.Tooltip,{title:d.a.translate("showcases.barter.add_escrow_tooltip"),placement:"topRight"},o.a.createElement(l.Button,{key:this.state.showEscrow?"remove_escrow":"add_escrow",onClick:this.toggleEscrow.bind(this),style:{float:"right"}},d.a.translate(this.state.showEscrow?"showcases.barter.remove_escrow":"showcases.barter.add_escrow"))),500===p.length&&500===h.length?o.a.createElement("div",{className:"amount-selector",style:this.props.style},o.a.createElement(i.a,{className:"left-label",component:"label",content:"transfer.explict_price"}),o.a.createElement("div",{className:"inline-label input-wrapper"},o.a.createElement(l.Input,{disabled:!1,type:"text",value:function(){var e="";A()&&(e=parseFloat(p[0].from_amount)/parseFloat(h[0].to_amount));return e}()}),o.a.createElement("div",{className:"form-label select floating-dropdown"},o.a.createElement("div",{className:"dropdown-wrapper inactive"},o.a.createElement("div",null,O+"/"+x))))):""),z=o.a.createElement(l.Card,{style:{borderRadius:"10px"}},o.a.createElement(i.a,{content:"showcases.barter.peer_left"}),o.a.createElement(l.Tooltip,{title:d.a.translate(this.state.send_to_escrow?"showcases.barter.fee_due_now_tooltip":"showcases.barter.fee_when_proposal_executes_tooltip")},o.a.createElement("div",{className:"barter-fee-selector"},o.a.createElement(u.a,{label:this.state.send_to_escrow?"showcases.barter.fee_due_now":"showcases.barter.fee_when_proposal_executes",account:r,transaction:{type:"transfer",options:["price_per_kbyte"],data:{type:"memo",content:null}},onChange:this.onFeeChangedPeer1InProposal.bind(this),multiplier:p.length}))),o.a.createElement(l.Tooltip,{title:d.a.translate("showcases.barter.proposal_fee_tooltip")},o.a.createElement("div",{className:"barter-fee-selector"},o.a.createElement(u.a,{label:"showcases.barter.proposal_fee",account:r,transaction:{type:"proposal_create",options:["price_per_kbyte"],data:{type:"memo",content:null}},onChange:this.onFeeChangedPeer1CreateProposal.bind(this)}))),o.a.createElement(l.Tooltip,{title:d.a.translate("showcases.barter.total_fees_tooltip")},o.a.createElement("span",{style:{marginTop:"1rem"}},o.a.createElement(i.a,{content:"showcases.barter.total_fees",className:"left-label",component:"label",fee:j(!0)+this.state.proposal_fee._real_amount,asset:"BTS"})))),V=o.a.createElement(l.Card,{style:{borderRadius:"10px"}},o.a.createElement(i.a,{content:"showcases.barter.peer_right"}),o.a.createElement(l.Tooltip,{title:d.a.translate("showcases.barter.fee_when_proposal_executes_tooltip")},o.a.createElement("div",{className:"barter-fee-selector"},o.a.createElement(u.a,{label:"showcases.barter.fee_when_proposal_executes",account:s,transaction:{type:"transfer",options:["price_per_kbyte"],data:{type:"memo",content:null}},onChange:this.onFeeChangedPeer2InProposal.bind(this),multiplier:h.length})))),L=null;this.state.showEscrow&&(L=o.a.createElement(l.Card,{style:{borderRadius:"10px"}},o.a.createElement(i.a,{content:"showcases.barter.escrow_account"}),o.a.createElement(l.Tooltip,{title:d.a.translate("showcases.barter.fee_when_proposal_executes_tooltip")},o.a.createElement("div",{className:"barter-fee-selector"},o.a.createElement(u.a,{label:"showcases.barter.fee_when_proposal_executes",account:this.state.escrow_account,transaction:{type:"transfer",options:["price_per_kbyte"],data:{type:"memo",content:null}},onChange:this.onEscrowFeeChanged.bind(this),multiplier:p.length})))));var W=o.a.createElement(l.Card,{style:{borderRadius:"10px"}},o.a.createElement(l.Tooltip,{title:d.a.translate("showcases.barter.new_barter_tooltip"),placement:"bottom"},o.a.createElement("h2",{style:{textAlign:"center"}},o.a.createElement(i.a,{content:"showcases.barter.new_barter"})," ",o.a.createElement(l.Icon,{type:"question-circle",theme:"filled"})))),H=null,U=this.state.memo.escrow[0]&&this.state.memo.escrow[0].shown,q=this.state.escrow_payment_changed?this.state.escrow_payment:j(!0);return this.state.showEscrow&&(H=o.a.createElement(l.Card,{style:{borderRadius:"10px"}},o.a.createElement(c.a,{label:"showcases.barter.escrow_account",placeholder:"placeholder",style:{marginBottom:"1rem"},allowPubKey:!0,allowUppercase:!0,account:this.state.escrow_account,accountName:this.state.escrow_account_name,onChange:this.escrowAccountChanged.bind(this),onAccountChanged:this.onEscrowAccountChanged.bind(this),hideImage:!0,typeahead:!0}),o.a.createElement(l.Tooltip,{title:d.a.translate("showcases.barter.send_to_escrow_tooltip")},o.a.createElement("span",null,o.a.createElement(l.Switch,{style:{margin:6},checked:this.state.send_to_escrow,onChange:this.onToggleSendToEscrow.bind(this)}),o.a.createElement(i.a,{content:"showcases.barter.send_to_escrow"}))),o.a.createElement("div",{style:{position:"relative"}},!U&&o.a.createElement(l.Tooltip,{title:d.a.translate("tooltip.add_memo_field"),placement:"topLeft"},o.a.createElement(l.Button,{onClick:this.handleMemoOpen("escrow",0),size:"small",icon:"message",className:"add-memo-btn"})),o.a.createElement(l.Tooltip,{title:d.a.translate("showcases.barter.escrow_payment_tooltip"),placement:"topLeft"},o.a.createElement("div",null,o.a.createElement(f.a,{label:"showcases.barter.escrow_payment",disabled:!1,amount:q,onChange:this._updateEscrowFee.bind(this),style:{margin:"1rem 0"},asset:"1.3.0",assets:["1.3.0"],error:!1===this.state.hasPoolBalance?"transfer.errors.insufficient":null,scroll_length:2}))),U&&this.renderMemoField("escrow",0)))),o.a.createElement("div",{className:"center",style:{padding:"10px",maxWidth:"80rem",width:"100%",margin:"0 auto"}},o.a.createElement(l.Card,null,k?o.a.createElement("div",null,o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:"10px"}},W)),o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:"10px"}},B)),o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:"10px"}},D)),o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:"10px"}},F)),H&&o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:"10px"}},H)),o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:"10px"}},z)),o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:"10px"}},V)),null!=L&&o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:"10px"}},L))):o.a.createElement("div",null,o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:"10px"}},W)),o.a.createElement(l.Row,null,o.a.createElement(l.Col,{span:12,style:{padding:"10px"}},B),o.a.createElement(l.Col,{span:12,style:{padding:"10px"}},D)),o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:"10px"}},F)),H&&o.a.createElement(l.Row,null,o.a.createElement(l.Col,{style:{padding:"10px"}},H)),o.a.createElement(l.Row,null,o.a.createElement(l.Col,{span:12,style:{padding:"10px"}},z),o.a.createElement(l.Col,{span:12,style:{padding:"10px"}},V,L))),o.a.createElement("div",{className:"barter-footer"},o.a.createElement(l.Tooltip,{title:d.a.translate("showcases.barter.propose_tooltip"),placement:"topLeft"},o.a.createElement(l.Button,{key:"propose",disabled:M,onClick:M?null:this.onSubmit.bind(this)},d.a.translate("propose"))),!M&&this.renderBalanceWarnings())))}},{key:"_updateEscrowFee",value:function(e){this.setState({escrow_payment_changed:!0,escrow_payment:e.amount})}},{key:"onToggleSendToEscrow",value:function(){this.setState({send_to_escrow:!this.state.send_to_escrow})}},{key:"toggleEscrow",value:function(){this.setState({showEscrow:!this.state.showEscrow})}}]),a}(r.Component);t.default=C}.call(this,a(126).Buffer)},2328:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(5),s=a.n(o),i=a(2),l=a.n(i),c=a(4),u=a(591),p=a.n(u),d=(a(127),a(30)),h=a(6),m=a(47),f=a(2060),_=a(23),g=a(34),b=a(375),y=a(11),w=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var v=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={isBorrowBaseModalVisible:!1,selectedAsset:null,step:0},e.steps=[{key:"introduction",icon:"borrow"},{key:"concept",has_legend:!0},{key:"setup",has_legend:!0},{key:"benefits",has_legend:!0},{key:"risks",has_legend:!0}],e.showBorrowModal=e.showBorrowModal.bind(e),e.hideBorrowModal=e.hideBorrowModal.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),w(t,[{key:"showBorrowModal",value:function(){var e=this;this.props.currentAccount?this.setState({isBorrowBaseModalVisible:!0}):m.a.unlock().then((function(){e.setState({isBorrowBaseModalVisible:!0})})).catch((function(){}))}},{key:"hideBorrowModal",value:function(){this.setState({isBorrowBaseModalVisible:!1})}},{key:"next",value:function(){var e=this.state.step+1;e>=this.steps.length&&(e=this.steps.length),this.setState({step:e})}},{key:"prev",value:function(){var e=this.state.step-1;e<0&&(e=0),this.setState({step:e})}},{key:"onAssetChange",value:function(e){this.setState({selectedAsset:e})}},{key:"render",value:function(){var e=this,t=h.ChainStore.getAccount(this.props.currentAccount),a=!(!t||"string"==typeof t),n=this.state.step,o=window.innerWidth<=800,i=this.state.step>0,u=h.ChainStore.getAsset(this.state.selectedAsset),p=this.steps,d=null;if(n<p.length)try{p[n].has_legend&&(d=(d=s.a.translate("showcases.borrow.steps_"+p[n].key+".text_legend")).split("\n").map((function(e){return e.split(":")})))}catch(e){d=s.a.translate("showcases.borrow.steps_"+p[n].key+".text_legend")}var m=null;return n>=p.length&&(m=r.a.createElement(c.Card,null,r.a.createElement("div",{className:"center-content"},r.a.createElement(l.a,{content:"showcases.borrow.choose",component:"h4"})),r.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},r.a.createElement("div",null,r.a.createElement(b.a,{style:{width:"12rem",marginBottom:"1rem"},assets:["1.3.113","1.3.120","1.3.121","1.3.1325","1.3.105","1.3.106","1.3.103"],value:this.state.selectedAsset,onChange:this.onAssetChange.bind(this)}),r.a.createElement(c.Tooltip,{title:s.a.translate("showcases.borrow.borrow_tooltip"),placement:"bottom"},r.a.createElement(c.Button,{type:"primary",style:{width:"12rem"},disabled:null===this.state.selectedAsset||!a||"1.2.3"===t.get("id"),onClick:this.showBorrowModal},r.a.createElement(l.a,{content:"exchange.borrow"}))))))),r.a.createElement("div",{style:{align:"center",display:"flex",paddingTop:"1rem",justifyContent:"center"},onKeyDown:this.onKeyDown.bind(this)},r.a.createElement(c.Card,{style:{borderRadius:"50px",width:"70%",maxWidth:"70rem",paddingTop:"1rem",paddingBottom:"1rem"}},r.a.createElement("div",{style:{display:"flex",justifyContent:"center"}},r.a.createElement(l.a,{component:"h1",content:null!=m?"showcases.borrow.now_ready":"showcases.borrow.title_long"})),i&&(o?n<this.steps.length?r.a.createElement(r.a.Fragment,null,n+". ",r.a.createElement(l.a,{content:"showcases.borrow.steps_"+p[n].key+".title"})):null:r.a.createElement(c.Steps,{progressDot:!0,current:n-1},p.map((function(e,t){return 0==t?null:r.a.createElement(c.Steps.Step,{key:e.key,title:s.a.translate("showcases.borrow.steps_"+e.key+".title")})})))),r.a.createElement("div",{style:{paddingTop:"1rem",paddingBottom:"1rem"}},null!=m&&m,null==m&&r.a.createElement(c.Card,{onKeyDown:this.onKeyDown.bind(this)},!!p[n].icon&&r.a.createElement(g.a,{name:"steps[current].icon"}),r.a.createElement(l.a,{component:"h2",content:"showcases.borrow.steps_"+p[n].key+".title_within"}),r.a.createElement(l.a,{component:"p",content:"showcases.borrow.steps_"+p[n].key+".text"}),!!p[n].has_legend&&r.a.createElement(r.a.Fragment,null,d.map((function(e,t){return r.a.createElement("p",{key:"borrow_subp_"+t},r.a.createElement("strong",null,e[0]),": ",e[1])}))))),r.a.createElement("div",{className:"steps-action"},n<p.length&&r.a.createElement(c.Tooltip,{title:0==n?s.a.translate("showcases.borrow.navigate_with_keys"):null},r.a.createElement(c.Button,{type:"primary",onClick:function(){return e.next()},tabIndex:"0",ref:"next",onKeyDown:this.onKeyDown.bind(this)},0==n&&r.a.createElement(l.a,{content:"showcases.borrow.get_started"}),n>0&&n<p.length-1&&r.a.createElement(l.a,{content:"showcases.borrow.next"}),n===p.length-1&&r.a.createElement(l.a,{content:"showcases.borrow.do_it"}))),n>0&&r.a.createElement(c.Button,{style:{marginLeft:8},onClick:function(){return e.prev()},ref:"previous",onKeyDown:this.onKeyDown.bind(this)},r.a.createElement(l.a,{content:"showcases.borrow.previous"})))),a&&!!u&&r.a.createElement(f.a,{visible:this.state.isBorrowBaseModalVisible,hideModal:this.hideBorrowModal,quoteAssetObj:u.get("id"),backingAssetObj:u.getIn(["bitasset","options","short_backing_asset"]),accountObj:t}))}},{key:"componentDidMount",value:function(){this.focusDiv()}},{key:"componentDidUpdate",value:function(){this.focusDiv()}},{key:"focusDiv",value:function(){var e=this.state.step,t=this.steps;e<t.length&&this.refs.next?y.findDOMNode(this.refs.next).focus():e==t.length&&this.refs.previous&&y.findDOMNode(this.refs.previous).focus()}},{key:"onKeyDown",value:function(e){39===e.keyCode||"ArrowRight"==e.key?(e.preventDefault(),e.stopPropagation(),this.next()):37!==e.keyCode&&"ArrowLeft"!=e.key||(e.preventDefault(),e.stopPropagation(),this.prev())}}]),t}(n.Component);v=p()(v,50,{leading:!1}),t.default=Object(d.a)(v,{listenTo:function(){return[_.a]},getProps:function(){return{currentAccount:_.a.getState().currentAccount||_.a.getState().passwordAccount}}})},2333:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(21),s=a(574),i=a(119),l=a(775);var c=function(e,t,a){return null==e?e:Object(l.a)(e,t,a)},u=a(5),p=a.n(u),d=a(206),h=a(2),m=a.n(h),f=a(22),_=a(424),g=a(97),b=a(367),y=a.n(b),w=a(30),v=a(6),E=a(4),k=a(778),C=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var S=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={showModal:!1,current_asset:v.ChainStore.assets_by_symbol.get(e.fee_asset)||"1.3.0"},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),C(t,[{key:"shouldComponentUpdate",value:function(){return!0}},{key:"render",value:function(){var e=this,t=v.ChainStore.getAsset(this.state.current_asset);return r.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"}},r.a.createElement(m.a,{component:"span",content:"settings.current_fee_asset",style:{marginRight:"10px"}}),t?r.a.createElement(g.a,{name:t.get("symbol")}):null,r.a.createElement(E.Button,{style:{margin:"15px"},key:"open_change_fee_asset",type:"secondary",onClick:function(){e.setState({showModal:!0})}},p.a.translate("settings.change_default_fee_asset")),this.state.showModal&&r.a.createElement(k.a,{key:"change_fee_asset_modal",className:"modal",show:this.state.showModal,current_asset:this.state.current_asset,displayFees:!1,forceDefault:!0,onChange:function(t){e.setState({current_asset:t})},close:function(){e.setState({showModal:!1})}}))}}]),t}(r.a.Component),O=Object(w.a)(S,{listenTo:function(){return[o.a]},getProps:function(e){return{fee_asset:o.a.getState().settings.get("fee_asset")}}}),x=a(828),A=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var j=E.Form.Item,N=E.Select.Option,M=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={message:null,isGatewaySelectorModalVisible:!1,isGatewaySelectorModalRendered:!1},e.handleNotificationChange=e.handleNotificationChange.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),A(t,[{key:"hideGatewaySelectorModal",value:function(){this.setState({isGatewaySelectorModalVisible:!1})}},{key:"showGatewaySelectorModal",value:function(){this.setState({isGatewaySelectorModalRendered:!0,isGatewaySelectorModalVisible:!0})}},{key:"_setMessage",value:function(e){var t=this;this.setState({message:p.a.translate(e)}),this.timer=setTimeout((function(){t.setState({message:null})}),4e3)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer)}},{key:"handleNotificationChange",value:function(e){var t=this;return function(a){t.props.onNotificationChange(e,!!a.target.checked)}}},{key:"shouldComponentUpdate",value:function(e,t,a){return"filteredServiceProviders"!==e.setting||t.isGatewaySelectorModalVisible!==this.state.isGatewaySelectorModalVisible}},{key:"render",value:function(){var e=this.props,t=e.defaults,a=e.setting,n=void 0,o=void 0,s=void 0,i=e.settings.get(a),l=null;switch(a){case"locale":o=i,n=t.map((function(e){var t="languages."+e,a=p.a.translate(t);return r.a.createElement(N,{key:e,value:e},a)}));break;case"themes":o=i,n=t.map((function(e){var t="settings."+e,a=p.a.translate(t);return r.a.createElement(N,{key:e,value:e},a)}));break;case"browser_notifications":o=i,l=r.a.createElement("div",{className:"settings--notifications"},r.a.createElement("div",{className:"settings--notifications--group"},r.a.createElement("div",{className:"settings--notifications--item"},r.a.createElement(E.Checkbox,{id:"browser_notifications.allow",checked:!!o.allow,onChange:this.handleNotificationChange("allow")},p.a.translate("settings.browser_notifications_allow"))),r.a.createElement("div",{className:"settings--notifications--group"},r.a.createElement("div",{className:"settings--notifications--item"},r.a.createElement(E.Checkbox,{id:"browser_notifications.additional.transferToMe",disabled:!o.allow,checked:!!o.additional.transferToMe,onChange:this.handleNotificationChange("additional.transferToMe")},p.a.translate("settings.browser_notifications_additional_transfer_to_me"))))),!!o.allow&&y.a.needsPermission&&r.a.createElement("a",{href:"https://goo.gl/zZ7NHY",target:"_blank",rel:"noopener noreferrer",className:"external-link"},r.a.createElement(m.a,{component:"div",className:"settings--notifications--no-browser-support",content:"settings.browser_notifications_disabled_by_browser_notify"})));break;case"fee_asset":n=null,o=!0,l=r.a.createElement(O,{key:"fee_asset_component"});break;case"filteredServiceProviders":n=null,o=!0,l=r.a.createElement(r.a.Fragment,null,r.a.createElement(E.Button,{onClick:this.showGatewaySelectorModal.bind(this)},"Choose external Service Providers"),this.state.isGatewaySelectorModalRendered&&r.a.createElement(x.a,{visible:this.state.isGatewaySelectorModalVisible,hideModal:this.hideGatewaySelectorModal.bind(this)}));break;case"defaultMarkets":n=null,o=null;break;case"walletLockTimeout":o=i,s=r.a.createElement(E.Input,{type:"text",className:"settings--input",value:i,onChange:this.props.onChange.bind(this,a)});break;default:"number"==typeof i?o=t[i]:"boolean"==typeof i?o=i?t[0]:t[1]:"string"==typeof i&&(o=i),t?n=t.map((function(e){var t=e.translate?p.a.translate("settings."+e.translate):e;"unit"!==a&&"fee_asset"!==a||(t=r.a.createElement(g.a,{name:e}));var n=e.translate?e.translate:e;return r.a.createElement(N,{value:e.translate?e.translate:e,key:n},t)})):s=r.a.createElement("input",{className:"settings-input",type:"text",defaultValue:o,onBlur:this.props.onChange.bind(this,a)})}if("number"!=typeof o&&!o&&!n)return null;o&&o.translate&&(o=o.translate);return r.a.createElement("section",{className:"no-border-bottom"},r.a.createElement((function(e){var t=e.noHeader,a=e.setting,n=e.children;return r.a.createElement(r.a.Fragment,null,t&&n||r.a.createElement(j,{label:p.a.translate("settings."+a)},n))}),{noHeader:!1,setting:a},n?r.a.createElement("ul",{className:"unstyled-list"},r.a.createElement("li",{className:"with-dropdown"},void 0,r.a.createElement(E.Select,{value:o,className:"settings--select",onChange:this.props.onChange.bind(this,a)},n),void 0)):null,s?r.a.createElement("ul",{className:"unstyled-list"},r.a.createElement("li",null,s)):null,l||null),r.a.createElement("div",{className:"facolor-success"},this.state.message))}}]),t}(r.a.Component),T=a(102),P=a(23),I=a(42),B=a(16),D=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var R=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),D(t,[{key:"shouldComponentUpdate",value:function(e){return!B.a.are_equal_shallow(e.myAccounts,this.props.myAccounts)||e.hiddenAccounts!==this.props.hiddenAccounts}},{key:"onToggleHide",value:function(e,t,a){a.preventDefault(),I.a.toggleHideAccount(e,t)}},{key:"render",value:function(){var e=this,t=this.props,a=t.myAccounts,n=t.hiddenAccounts,o=n.toArray().concat(a).sort();return o.length?r.a.createElement("table",{className:"table"},r.a.createElement("tbody",null,o.map((function(t){var a=n.has(t),o=r.a.createElement("a",{onClick:a?e.onToggleHide.bind(e,t,!1):e.onToggleHide.bind(e,t,!0)},r.a.createElement(m.a,{content:"account."+(a?"unignore":"ignore")}));return r.a.createElement("tr",{key:t},r.a.createElement("td",null,t),r.a.createElement("td",null,r.a.createElement(T.a,{to:"/account/"+t+"/permissions"},r.a.createElement(m.a,{content:"settings.view_keys"}))),r.a.createElement("td",null,o))})))):r.a.createElement("div",null,r.a.createElement(m.a,{content:"settings.no_accounts"}))}}]),t}(r.a.Component),F=R=Object(w.a)(R,{listenTo:function(){return[P.a]},getProps:function(){return{myAccounts:P.a.getMyAccounts(),hiddenAccounts:P.a.getState().myHiddenAccounts}}}),z=a(2308),V=a(2068),L=a(20),W=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var H=E.Form.Item,U=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={lookupActive:!1,resetMessage:null},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),W(t,[{key:"onLookup",value:function(){this.setState({lookupActive:!0})}},{key:"onResetBrainkeySequence",value:function(){L.a.resetBrainKeySequence(),this.setState({resetMessage:p.a.translate("wallet.brainkey_reset_success")})}},{key:"render",value:function(){var e=this.state.lookupActive;return this.props.deprecated?r.a.createElement("div",null,r.a.createElement(z.ChangeActiveWallet,null),r.a.createElement(z.WalletDelete,null)):r.a.createElement("div",null,r.a.createElement(z.ChangeActiveWallet,null),r.a.createElement(z.WalletDelete,null),r.a.createElement(H,{label:p.a.translate("wallet.balance_claims"),className:"no-offset",style:{padding:"15px 0"}},r.a.createElement("div",{style:{paddingBottom:10}},r.a.createElement(m.a,{content:"settings.lookup_text"}),":"),r.a.createElement(E.Button,{onClick:this.onLookup.bind(this)},r.a.createElement(m.a,{content:"wallet.balance_claim_lookup"}))),e?r.a.createElement(V.a,null):null,r.a.createElement(H,{label:p.a.translate("wallet.brainkey_seq_reset"),className:"no-offset",style:{paddingBottom:"15px"}},r.a.createElement("div",{style:{paddingBottom:10}},r.a.createElement("p",null,r.a.createElement(m.a,{unsafe:!0,content:"wallet.brainkey_seq_reset_text"})),r.a.createElement(E.Button,{onClick:this.onResetBrainkeySequence.bind(this)},r.a.createElement(m.a,{content:"wallet.brainkey_seq_reset_button"})),this.state.resetMessage?r.a.createElement("p",{style:{paddingTop:10},className:"facolor-success"},this.state.resetMessage):null)))}}]),t}(r.a.Component),q=a(2130),J=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var G=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),J(t,[{key:"render",value:function(){return r.a.createElement(q.a,null)}}]),t}(r.a.Component),K=a(374),Z=a(2087),Y=a(605),Q=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var X=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state={json:null,error:null},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),Q(t,[{key:"upload",value:function(e){var t=this;this.setState({error:!1,json:null});var a=e.target.files[0],n=new FileReader;n.onload=function(e){var a=e.target.result;try{var n=JSON.parse(a);for(var r in n){var o=n[r],s=o.quote,i=o.base;if(!s||!i)throw new Error("Cannot parse json data.")}t.setState({json:n})}catch(e){t.setState({error:!0})}},n.readAsText(a)}},{key:"finish",value:function(){var e=this.state.json;for(var t in f.a.clearStarredMarkets(),e){var a=e[t],n=a.quote,r=a.base;f.a.addStarMarket(n,r)}E.Notification.success({message:p()("settings.backup_favorites_success")})}},{key:"render",value:function(){var e=this.state;return r.a.createElement("div",null,r.a.createElement("input",{type:"file",id:"file_input",accept:".json",style:{border:"solid",marginBottom:15},onChange:this.upload.bind(this)}),e.error&&r.a.createElement("h5",null,r.a.createElement(m.a,{content:"settings.backup_favorites_error"})),e.json&&r.a.createElement("p",null,r.a.createElement(E.Button,{type:"primary",onClick:this.finish.bind(this)},r.a.createElement(m.a,{content:"settings.backup_favorites_finish"}))))}}]),t}(r.a.Component),$=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var ee=E.Select.Option,te=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={restoreType:0,types:["backup","key","legacy","brainkey","favorites"]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),$(t,[{key:"_setWalletMode",value:function(){f.a.changeSetting({setting:"passwordLogin",value:!1})}},{key:"_changeType",value:function(e){this.setState({restoreType:this.state.types.indexOf(e)})}},{key:"render",value:function(){if(this.props.passwordLogin)return r.a.createElement("div",null,r.a.createElement(m.a,{content:"settings.wallet_required",component:"h4"}),r.a.createElement("p",{className:"dark-text-color"},r.a.createElement(m.a,{content:"settings.wallet_required_text"}),":"),r.a.createElement(E.Button,{type:"primary",className:"button",onClick:this._setWalletMode},r.a.createElement(m.a,{content:"settings.enable_wallet"})));var e=this.state,t=e.types,a=e.restoreType,n=t.map((function(e){return r.a.createElement(ee,{key:e,value:e},p.a.translate("settings.backup_"+e)," ")})),o=void 0;switch(t[a]){case"backup":o=r.a.createElement("div",null,r.a.createElement(K.b,null));break;case"brainkey":o=r.a.createElement("div",null,r.a.createElement("p",{style:{maxWidth:"40rem",paddingBottom:10}},r.a.createElement(m.a,{content:"settings.restore_brainkey_text"})),r.a.createElement(Y.a,{nested:!0}));break;case"favorites":o=r.a.createElement("div",null,r.a.createElement(X,null));break;default:o=r.a.createElement(Z.a,{privateKey:1===a})}return r.a.createElement("div",null,r.a.createElement(E.Select,{onChange:this._changeType.bind(this),className:"bts-select",value:t[a]},n),o)}}]),t}(r.a.Component),ae=a(105),ne=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var re=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={message:null},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),ne(t,[{key:"_setMessage",value:function(e){var t=this;this.setState({message:p.a.translate(e)}),this.timer=setTimeout((function(){t.setState({message:null})}),4e3)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer)}},{key:"render",value:function(){var e=this;return r.a.createElement("section",{className:"no-border-bottom"},r.a.createElement("header",null,r.a.createElement(m.a,{component:"span",style:{fontWeight:"normal",fontFamily:"Roboto-Medium, arial, sans-serif",fontStyle:"normal"},content:"settings.reset_text_description",generalName:p.a.translate("settings.general"),with:{generalName:p.a.translate("settings.general"),accessName:p.a.translate("settings.access"),faucetName:p.a.translate("settings.faucet_address")}})),r.a.createElement(E.Button,{type:"primary",style:{height:60,width:"100%",marginTop:"30px"},onClick:function(){f.a.clearSettings().then((function(){e._setMessage("settings.restore_default_success"),setTimeout((function(){Object(ae.a)(!1)}),50)}))}},p.a.translate("settings.reset")),r.a.createElement("div",{className:"facolor-success",style:{marginTop:"20px",height:"18px"}},this.state.message))}}]),t}(r.a.Component),oe=a(2129),se=a(415),ie=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var le=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),ie(t,[{key:"makeBackup",value:function(){var e=this.props.starredMarkets.toJS(),t=new Blob([JSON.stringify(e)],{type:"application/json; charset=us-ascii"});Object(se.saveAs)(t,"favorites.json")}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("p",null,r.a.createElement(m.a,{content:"settings.backup_favoritestext"})),r.a.createElement(E.Button,{type:"primary",onClick:this.makeBackup.bind(this)},r.a.createElement(m.a,{content:"settings.backup_favoritesbtn"})))}}]),t}(r.a.Component),ce=Object(w.a)(le,{listenTo:function(){return[o.a]},getProps:function(){return{starredMarkets:o.a.getState().starredMarkets}}}),ue=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var pe=E.Select.Option,de=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={restoreType:0,types:["backup","brainkey","favorites"]},e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),ue(t,[{key:"_changeType",value:function(e){this.setState({restoreType:this.state.types.indexOf(e)})}},{key:"render",value:function(){var e=this.state,t=e.types,a=e.restoreType,n=t.map((function(e){return r.a.createElement(pe,{key:e,value:e},p.a.translate("settings.backupcreate_"+e)," ")})),o=void 0;switch(t[a]){case"backup":o=r.a.createElement(K.a,null);break;case"brainkey":o=r.a.createElement(oe.a,null);break;case"favorites":o=r.a.createElement(ce,null)}return r.a.createElement("div",null,r.a.createElement(E.Select,{onChange:this._changeType.bind(this),className:"bts-select",value:t[a],style:{marginBottom:"16px"}},n),o)}}]),t}(r.a.Component),he=a(429),me=a(36),fe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},_e=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var ge=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),n=a._getMenuEntries(e),r=0,o=e.match.params.tab?n.indexOf(e.match.params.tab):e.viewSettings.get("activeSetting",0);o>=0&&(r=o);var s=["locale","unit","fee_asset","filteredServiceProviders","browser_notifications","showSettles","walletLockTimeout","themes","showAssetPercent","viewOnlyMode","showProposedTx"];return Object(me.b)().length>1&&s.push("passwordLogin"),s.push("reset"),a.state={isAddNodeModalVisible:!1,isRemoveNodeModalVisible:!1,removeNode:{name:null,url:null},apiServer:e.settings.get("apiServer"),activeSetting:r,menuEntries:n,settingEntries:{general:s,access:["apiServer","faucet_address"]}},a.showAddNodeModal=a.showAddNodeModal.bind(a),a.hideAddNodeModal=a.hideAddNodeModal.bind(a),a.showRemoveNodeModal=a.showRemoveNodeModal.bind(a),a.hideRemoveNodeModal=a.hideRemoveNodeModal.bind(a),a._handleNotificationChange=a._handleNotificationChange.bind(a),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),_e(t,[{key:"componentDidUpdate",value:function(e){e.match.params.tab!==this.props.match.params.tab&&this.props.match.params.tab&&this._onChangeMenu(this.props.match.params.tab)}},{key:"componentWillReceiveProps",value:function(e){if(e.settings.get("passwordLogin")!==this.props.settings.get("passwordLogin")){var t=this._getMenuEntries(this.props),a=this._getMenuEntries(e),n=t[this.state.activeSetting],r=a.indexOf(n),o=a[r];this.setState({menuEntries:a}),r&&r!==this.state.activeSetting?this.setState({activeSetting:a.indexOf(n)}):(!o||this.state.activeSetting>a.length-1)&&this.setState({activeSetting:0})}}},{key:"showAddNodeModal",value:function(){this.setState({isAddNodeModalVisible:!0})}},{key:"hideAddNodeModal",value:function(){this.setState({isAddNodeModalVisible:!1})}},{key:"showRemoveNodeModal",value:function(e,t){this.setState({isRemoveNodeModalVisible:!0,removeNode:{url:e,name:t}})}},{key:"hideRemoveNodeModal",value:function(){this.setState({isRemoveNodeModalVisible:!1,removeNode:{url:null,name:null}})}},{key:"_getMenuEntries",value:function(e){if(e.deprecated)return["wallet","backup"];var t=[];return t.push("general"),e.settings.get("passwordLogin")||t.push("wallet"),t.push("accounts"),e.settings.get("passwordLogin")||t.push("password"),e.settings.get("passwordLogin")||t.push("backup"),e.settings.get("passwordLogin")||t.push("restore"),t.push("access"),Object(me.i)().show&&t.push("faucet_address"),t.push("reset"),t}},{key:"triggerModal",value:function(e){for(var t,a=arguments.length,n=Array(a>1?a-1:0),r=1;r<a;r++)n[r-1]=arguments[r];(t=this.refs.ws_modal).show.apply(t,[e].concat(n))}},{key:"_handleNotificationChange",value:function(e,t){var a=c(this.props.settings.get("browser_notifications"),e,t);f.a.changeSetting({setting:"browser_notifications",value:a})}},{key:"_handleSettingsEntryChange",value:function(e,t){t.target?this._onChangeSetting(e,t):this._onChangeSetting(e,{target:{value:t}})}},{key:"_onChangeSetting",value:function(e,t){t.preventDefault&&t.preventDefault();var a=this.props.defaults,n=null;function r(e,t){if(!t)return e;if(!t[0].translate)return t.indexOf(e);for(var a=0;a<t.length;a++)if(p.a.translate("settings."+t[a].translate)===e)return a}switch(e){case"locale":var o=p.a.getLocale();t.target.value!==o&&(d.a.switchLocale(t.target.value),f.a.changeSetting({setting:"locale",value:t.target.value}));break;case"themes":f.a.changeSetting({setting:"themes",value:t.target.value});break;case"defaultMarkets":break;case"walletLockTimeout":var s=parseInt(t.target.value,10);isNaN(s)&&(s=0),isNaN(s)||"number"!=typeof s||f.a.changeSetting({setting:"walletLockTimeout",value:s});break;case"inverseMarket":case"confirmMarketOrder":n=0===r(t.target.value,a[e]);break;case"apiServer":f.a.changeSetting({setting:"apiServer",value:t.target.value}),this.setState({apiServer:t.target.value});break;case"showProposedTx":case"showSettles":case"showAssetPercent":case"passwordLogin":case"viewOnlyMode":var i=a[e][0];i.translate&&(i=i.translate),f.a.changeSetting({setting:e,value:t.target.value===i});break;case"filteredServiceProviders":break;case"fee_asset":case"unit":var l=a.unit,c=r(t.target.value,l);f.a.changeSetting({setting:e,value:l[c]});break;default:n=r(t.target.value,a[e])}null!==n&&f.a.changeSetting({setting:e,value:n})}},{key:"onReset",value:function(){f.a.clearSettings()}},{key:"_redirectToEntry",value:function(e){this.props.history.push("/settings/"+e)}},{key:"_onChangeMenu",value:function(e){var t=this.state.menuEntries.indexOf(e);this.setState({activeSetting:t}),f.a.changeViewSetting({activeSetting:t})}},{key:"render",value:function(){var e=this,t=this.props,a=t.settings,n=t.defaults,o=this.state,s=o.menuEntries,i=o.activeSetting,l=o.settingEntries,c=void 0,u=s[i]||s[0];switch(u){case"accounts":c=r.a.createElement(F,null);break;case"wallet":c=r.a.createElement(U,this.props);break;case"password":c=r.a.createElement(G,null);break;case"backup":c=r.a.createElement(de,null);break;case"restore":c=r.a.createElement(te,{passwordLogin:this.props.settings.get("passwordLogin")});break;case"access":c=r.a.createElement(he.a,{faucet:a.get("faucet_address"),nodes:n.apiServer,onChange:this._onChangeSetting.bind(this),showAddNodeModal:this.showAddNodeModal,showRemoveNodeModal:this.showRemoveNodeModal});break;case"faucet_address":c=r.a.createElement(E.Input,{disabled:!Object(me.i)().editable,type:"text",defaultValue:a.get("faucet_address"),onChange:Object(me.i)().editable?this._onChangeSetting.bind(this,"faucet_address"):null});break;case"reset":c=r.a.createElement(re,null);break;default:c=l[u].map((function(t){return r.a.createElement(M,fe({key:t,setting:t,settings:a,defaults:n["fee_asset"===t?"unit":t],onChange:e._handleSettingsEntryChange.bind(e),onNotificationChange:e._handleNotificationChange,locales:e.props.localesObject},e.state))}))}return r.a.createElement(E.Form,{layout:"vertical"},r.a.createElement("div",{className:this.props.deprecated?"":"grid-block settings-container"},r.a.createElement("div",{className:"grid-block main-content margin-block wrap"},r.a.createElement("div",{className:"grid-content shrink settings-menu",style:{paddingRight:"2rem"}},r.a.createElement(m.a,{style:{paddingBottom:10,paddingLeft:10},component:"h3",content:"header.settings",className:"panel-bg-color"}),r.a.createElement("ul",null,s.map((function(t,a){return r.a.createElement("li",{className:a===i?"active":"",onClick:e._redirectToEntry.bind(e,t),key:t},r.a.createElement(m.a,{content:"settings."+t}))})))),r.a.createElement("div",{className:"grid-content",style:{height:"100%"}},r.a.createElement("div",{className:"grid-block small-12 no-margin vertical",style:{maxWidth:1e3}},r.a.createElement(m.a,{component:"h3",content:"settings."+s[i]}),"access"!=u&&r.a.createElement(m.a,{unsafe:!0,style:{paddingTop:5,marginBottom:30},content:"settings."+s[i]+"_text",className:"panel-bg-color"}),c))),r.a.createElement(_.a,{removeNode:this.state.removeNode,isAddNodeModalVisible:this.state.isAddNodeModalVisible,isRemoveNodeModalVisible:this.state.isRemoveNodeModalVisible,onAddNodeClose:this.hideAddNodeModal,onRemoveNodeClose:this.hideRemoveNodeModal,apis:n.apiServer,api:n.apiServer.filter((function(t){return t.url===e.state.apiServer})).reduce((function(e,t){return t&&t.url}),null),changeConnection:function(t){e.setState({apiServer:t})}})))}}]),t}(r.a.Component),be=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var ye=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),be(t,[{key:"render",value:function(){return r.a.createElement(i.a,{stores:[o.a],inject:{settings:function(){return o.a.getState().settings},viewSettings:function(){return o.a.getState().viewSettings},defaults:function(){return o.a.getState().defaults},localesObject:function(){return s.a.getState().localesObject},apiLatencies:function(){return o.a.getState().apiLatencies}}},r.a.createElement(ge,this.props))}}]),t}(r.a.Component);t.default=ye},2337:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(15),s=a(4),i=a(5),l=a.n(i),c=a(6),u=a(16),p=a(606),d=a(2),h=a.n(d),m=a(2020),f=(a(35),a(2026)),_=(a(9),a(127),a(1)),g=a.n(_),b=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var w=function(e){function t(){var e,a,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var r=arguments.length,o=Array(r),s=0;s<r;s++)o[s]=arguments[s];return a=n=y(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(o))),n.onInputChange=function(e){var t=n.props,a=t.onChange,r=t.periodType;a&&a({amount:n.getNumericEventValue(e),type:r})},n.onTypeChange=function(e){var t=n.props,a=t.onChange,r=t.inputValue;a&&a({amount:r,type:e})},y(n,a)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),b(t,[{key:"getNumericEventValue",value:function(e){return""==e.target.value||null==e.target.value||e.target.value<0?"":0===e.target.value?0:parseFloat(e.target.value)==e.target.value?e.target.value.trim():parseFloat(e.target.value.trim().replace(/[^\d.-]/g,""))||0}},{key:"render",value:function(){var e=this.props,t=e.inputValue,a=e.values,n=e.entries,o=e.periodType,s=e.tabIndex,i=e.placeholder,l=e.disabled,c=e.scroll_length;return r.a.createElement("div",{className:"amount-selector",style:this.props.style},r.a.createElement(h.a,{className:"left-label",component:"label",content:this.props.label}),r.a.createElement("div",{className:"inline-label input-wrapper"},r.a.createElement("span",{className:"input-addon-before"},"Each"),r.a.createElement("input",{disabled:l,type:"number",value:t||"",placeholder:i,onChange:this.onInputChange,tabIndex:s,style:{paddingLeft:"70px"}}),r.a.createElement("div",{className:"form-label select floating-dropdown"},r.a.createElement(f.a,{entries:n,values:a,value:o&&o.name,onChange:this.onTypeChange,scroll_length:c}))))}}]),t}(r.a.Component);w.propTypes={label:g.a.string,placeholder:g.a.string,onChange:g.a.func,tabIndex:g.a.number,error:g.a.string,scroll_length:g.a.number},w.defaultProps={disabled:!1,tabIndex:0};var v=w,E=a(372),k=a(23),C=a(282),S=a(76),O=a(40),x=a(212),A=a(371),j=a(30),N=a(21),M=a(827),T=a(243),P=a(32),I=a.n(P),B=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var D=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.onSubmit=function(e){e.preventDefault();var t=a.state,n=t.from_account,r=t.to_account,o=t.amount,s=t.asset,i=t.asset_id,l=t.fee_asset_id,c=t.period,p=t.num_of_periods,d=t.period_start_time,h=t.permissionId,m=a.props.operation.type;"create"===m?T.a.createWithdrawPermission(n,r,i,u.a.convert_typed_to_satoshi(o,s),c.type.seconds*Number(c.amount),p,d.valueOf(),l).then((function(e){a.props.hideModal()})).catch((function(e){console.error(e)})):"update"===m&&T.a.updateWithdrawPermission(h,n,r,i,u.a.convert_typed_to_satoshi(o,s),c.type.seconds*Number(c.amount),p,d.valueOf(),l).then((function(e){a.props.hideModal()})).catch((function(e){console.error(e)}))},a.onToAccountChanged=function(e){a.setState({to_account:e,error:null})},a.onAmountChanged=function(e){var t=e.amount,n=e.asset;n&&a.setState({amount:t,asset:n,asset_id:n.get("id"),error:null,maxAmount:!1},a._checkBalance)},a.toChanged=function(e){a.setState({to_name:e,error:null})},a.onNumOfPeriodsChanged=function(e){var t=parseInt(e.target.value,10);!Object(p.a)(t)&&"number"==typeof t&&t>=0&&a.setState({num_of_periods:t})},a.onPeriodChanged=function(e){var t=e.amount,n=e.type;a.setState({period:{amount:t,type:n}})},a.onStartDateChanged=function(e){e?a.setState({period_start_time:e}):a.setState({period_start_time:null})},a.state=a.getInitialState(e),a.onTrxIncluded=a.onTrxIncluded.bind(a),a._checkBalance=a._checkBalance.bind(a),a._isMounted=!1,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),B(t,[{key:"getInitialState",value:function(){return{to_name:"",from_account:null,to_account:null,amount:"",asset_id:null,asset:null,error:null,fee_asset_id:c.ChainStore.assets_by_symbol.get(this.props.fee_asset_symbol)||"1.3.0",feeAmount:new O.a({amount:0}),feeStatus:{},maxAmount:!1,num_of_periods:"",period:{amount:"",type:{seconds:604800,name:"Week"}},period_start_time:I()().add("seconds",120),permissionId:"",balanceError:!1}}},{key:"componentDidMount",value:function(){this._isMounted=!0}},{key:"componentDidUpdate",value:function(e,t){var a=this.props,n=a.operation,r=a.currentAccount;if(r===e.currentAccount&&null!=this.state.from_account||this.setState({from_account:c.ChainStore.getAccount(r)}),n&&"update"===n.type&&n.payload.id!==t.permissionId){var o=c.ChainStore.getAccount(n.payload.authorized_account);if(o&&o.get){for(var s=I.a.utc(n.payload.period_start_time).valueOf(),i=(I.a.utc(n.payload.expiration).valueOf()-s)/(1e3*n.payload.withdrawal_period_sec),l=[{seconds:604800,name:"Week"},{seconds:86400,name:"Day"},{seconds:3600,name:"Hour"},{seconds:60,name:"Minute"}],p=void 0,d=void 0,h=void 0,m=0;m<l.length;m++)if(n.payload.withdrawal_period_sec>=l[m].seconds){var f=l[m];d=f.name,p=f.seconds,h=Math.round(n.payload.withdrawal_period_sec/f.seconds);break}var _=c.ChainStore.getAsset(n.payload.withdrawal_limit.asset_id);this.setState({to_account:o,to_name:o.get("name"),asset:_,permissionId:n.payload.id,amount:u.a.convert_satoshi_to_typed(n.payload.withdrawal_limit.amount,_),asset_id:n.payload.withdrawal_limit.asset_id,num_of_periods:i,period:{amount:h,type:{seconds:p,name:d}},period_start_time:I.a.utc(n.payload.period_start_time)})}}}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"_checkBalance",value:function(){var e=this.state,t=e.feeAmount,a=e.amount,n=e.from_account,r=e.asset;if(r&&n){var o=n.getIn(["balances",r.get("id")]),s=n.getIn(["balances",t.asset_id]);if(r&&n){if(!o)return this.setState({balanceError:!0});var i=c.ChainStore.getObject(o),l=s?c.ChainStore.getObject(s):null;if(l&&0!==l.get("balance")||this.setState({fee_asset_id:this.state.fee_asset_id}),i&&t){if(!a)return this.setState({balanceError:!1});var u=Object(x.a)(a,r,t,i);null!==u&&this.setState({balanceError:!u})}}}}},{key:"_setTotal",value:function(e,t){var a=this.state.feeAmount,n=c.ChainStore.getObject(t),r=c.ChainStore.getObject(e),o=new O.a({amount:n.get("balance"),asset_id:r.get("id"),precision:r.get("precision")});n&&(a.asset_id===o.asset_id&&o.minus(a),this.setState({maxAmount:!0,amount:o.getAmount({real:!0})},this._checkBalance))}},{key:"_getAvailableAssets",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state,t=e.from_account,a=[],n=[];if(!t||!t.get("balances"))return{asset_types:a,fee_asset_types:n};var r=e.from_account.get("balances").toJS();for(var o in a=Object.keys(r).sort(u.a.sortID),n=Object.keys(r).sort(u.a.sortID),r){var s=c.ChainStore.getObject(r[o]);s&&0===s.get("balance")&&(a.splice(a.indexOf(o),1),-1!==n.indexOf(o)&&n.splice(n.indexOf(o),1))}return{asset_types:a,fee_asset_types:n}}},{key:"onFeeChanged",value:function(e){this.setState({fee_asset_id:e.asset_id,error:null})}},{key:"onTrxIncluded",value:function(e){e.included&&e.broadcasted_transaction?(S.a.unlisten(this.onTrxIncluded),S.a.reset()):e.closed&&(S.a.unlisten(this.onTrxIncluded),S.a.reset())}},{key:"onDatepickerRef",value:function(e){e&&e.picker.input&&(e.picker.input.readOnly=!1)}},{key:"render",value:function(){var e=this,t=this.state,a=t.from_account,n=t.to_account,o=t.asset,i=t.asset_id,u=t.amount,d=t.to_name,f=t.fee_asset_id,_=t.balanceError,g=t.num_of_periods,b=t.period,y=t.period_start_time,w=this.props.operation,k=this._getAvailableAssets().asset_types,S=null,O=this.state.feeAmount.getAmount({real:!0});if(a&&a.get("balances")){var x=a.get("balances").toJS(),j=this.state.balanceError?"has-error":"";if(1===k.length&&(o=c.ChainStore.getAsset(k[0])),k.length>0){var N=o?o.get("id"):k[0],T=f;S=r.a.createElement("span",null,r.a.createElement(h.a,{component:"span",content:"transfer.available"}),":"," ",r.a.createElement("span",{className:j,style:{borderBottom:"#A09F9F 1px dotted",cursor:"pointer"},onClick:this._setTotal.bind(this,N,x[N],O,T)},r.a.createElement(A.a,{balance:x[N]}))),T==N&&this.state.balanceError&&(balance_fee=r.a.createElement("span",null,r.a.createElement("span",{className:j},r.a.createElement(h.a,{content:"transfer.errors.insufficient"}))))}else S=r.a.createElement("span",null,r.a.createElement("span",{className:j},r.a.createElement(h.a,{content:"transfer.errors.noFunds"}))),balance_fee=r.a.createElement("span",null,r.a.createElement("span",{className:j},r.a.createElement(h.a,{content:"transfer.errors.noFunds"})))}var P=parseFloat(String.prototype.replace.call(u,/,/g,"")),B=P&&!Object(p.a)(P),D=!a||!n||!B||!o||_||a.get("id")==n.get("id")||!b.amount||!g||!y;return r.a.createElement(s.Modal,{title:w&&"create"===w.type?l.a.translate("showcases.direct_debit.create_new_mandate"):l.a.translate("showcases.direct_debit.update_mandate"),visible:this.props.isModalVisible,overlay:!0,onCancel:this.props.hideModal,footer:[r.a.createElement(s.Button,{key:"send",disabled:D,onClick:D?null:this.onSubmit.bind(this)},w&&"create"===w.type?l.a.translate("showcases.direct_debit.create"):l.a.translate("showcases.direct_debit.update")),r.a.createElement(s.Button,{key:"Cancel",onClick:this.props.hideModal},r.a.createElement(h.a,{component:"span",content:"transfer.cancel"}))]},r.a.createElement("div",{className:"grid-block vertical no-overflow"},r.a.createElement(s.Form,{className:"full-width",layout:"vertical"},r.a.createElement("div",null,r.a.createElement(s.Tooltip,{title:l.a.translate("showcases.direct_debit.tooltip.authorized_account"),mouseEnterDelay:.5},r.a.createElement("div",{className:"content-block"},r.a.createElement(C.a,{label:"showcases.direct_debit.authorized_account",accountName:d,account:n,onChange:this.toChanged.bind(this),onAccountChanged:this.onToAccountChanged,size:60,typeahead:!0,hideImage:!0})))),r.a.createElement(s.Tooltip,{title:l.a.translate("showcases.direct_debit.tooltip.limit_per_period"),mouseEnterDelay:.5},r.a.createElement("div",{className:"content-block transfer-input"},r.a.createElement(m.a,{label:"showcases.direct_debit.limit_per_period",amount:u,onChange:this.onAmountChanged,asset:k.length>0&&o?o.get("id"):i||k[0],assets:k,display_balance:S,allowNaN:!0}))),r.a.createElement(s.Tooltip,{title:l.a.translate("showcases.direct_debit.tooltip.period"),mouseEnterDelay:.5},r.a.createElement("div",{className:"content-block transfer-input"},r.a.createElement(v,{label:"showcases.direct_debit.period",inputValue:b.amount,entries:["Minute","Hour","Day","Week"],values:{Minute:{seconds:60,name:"Minute"},Hour:{seconds:3600,name:"Hour"},Day:{seconds:86400,name:"Day"},Week:{seconds:604800,name:"Week"}},periodType:b.type,onChange:this.onPeriodChanged}))),r.a.createElement(s.Tooltip,{title:l.a.translate("showcases.direct_debit.tooltip.num_of_periods"),mouseEnterDelay:.5},r.a.createElement("div",{className:"content-block transfer-input"},r.a.createElement("label",{className:"left-label"},l.a.translate("showcases.direct_debit.num_of_periods")),r.a.createElement("input",{type:"number",value:g,onChange:this.onNumOfPeriodsChanged}))),r.a.createElement("div",{className:"content-block transfer-input"},r.a.createElement("label",{className:"left-label"},l.a.translate("showcases.direct_debit.start_date")),r.a.createElement(s.Tooltip,{title:l.a.translate("showcases.direct_debit.tooltip.start_time"),mouseEnterDelay:.5},r.a.createElement(M.a,{value:y,showToday:!1,showTime:!0,placeholder:"",onChange:this.onStartDateChanged,className:"date-picker-width100",style:{width:"100%"},ref:function(t){return e.onDatepickerRef(t)},disabledDate:function(e){return e&&e<I()().add(2,"minutes")}}))),r.a.createElement("div",{className:"content-block transfer-input"},r.a.createElement("div",{className:"no-margin no-padding"},r.a.createElement(E.a,{account:a,transaction:{type:w&&"update"===w.type?"withdraw_permission_update":"withdraw_permission_create",options:["price_per_kbyte"],data:{type:"memo",content:null}},onChange:this.onFeeChanged.bind(this)}))))))}}]),t}(r.a.Component),R=Object(j.a)(D,{listenTo:function(){return[k.a,N.a]},getProps:function(){return{currentAccount:k.a.getState().currentAccount,passwordAccount:k.a.getState().passwordAccount,fee_asset_symbol:N.a.getState().settings.get("fee_asset")}}}),F=a(2316),z=a(182),V=a(2030),L=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},W=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();var H=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.showModal=function(e){return function(){a.setState({isModalVisible:!0,operationData:e})}},a.hideModal=function(){a.setState({isModalVisible:!1,operation:null})},a.showClaimModal=function(e){return function(){a.setState({isClaimModalVisible:!0,operationClaimData:e})}},a.hideClaimModal=function(){a.setState({isClaimModalVisible:!1})},a._onFilter=function(e){e.preventDefault(),a.setState({filterString:e.target.value.toLowerCase()})},a.handleDeleteProposal=function(e){console.log("delete permissin"),T.a.deleteWithdrawPermission(e.id,e.withdraw_from_account,e.authorized_account).then((function(){})).catch((function(e){a.setState({errorMessage:e.toString()}),console.error(e)}))},a.state={isModalVisible:!1,isClaimModalVisible:!1,filterString:"",operationData:"",operationClaimData:"",withdraw_permission_list:[]},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),W(t,[{key:"_update",value:function(){var e=this,t=this.props.currentAccount;Object(V.b)(t)&&Promise.all([o.Apis.instance().db_api().exec("get_withdraw_permissions_by_giver",[t.get("id"),"1.12.0",100]),o.Apis.instance().db_api().exec("get_withdraw_permissions_by_recipient",[t.get("id"),"1.12.0",100])]).then((function(t){var a=[];(a=(a=a.concat(t[0])).concat(t[1])).forEach((function(e){try{c.ChainStore.getAccount(e.authorized_account,!1),c.ChainStore.getAccount(e.withdraw_from_account,!1)}catch(e){}})),e.setState({withdraw_permission_list:a})}))}},{key:"componentDidMount",value:function(){this._update()}},{key:"componentWillReceiveProps",value:function(){this._update()}},{key:"render",value:function(){var e=this,t=this.state,a=t.isModalVisible,n=t.isClaimModalVisible,o=t.withdraw_permission_list,i=t.operationData,p=t.operationClaimData,d=t.filterString,h=this.props.currentAccount,m=null;o.length&&(m=o.map((function(e){var t=c.ChainStore.getObject(e.withdrawal_limit.asset_id,!1),a=c.ChainStore.getAccountName(e.authorized_account),n=c.ChainStore.getAccountName(e.withdraw_from_account),o=new Date(e.period_start_time+"Z").getTime(),s=(new Date).getTime()-o,i="",p=1e3*e.withdrawal_period_sec;s<0?console.log("first period is not started"):i=o+p*Math.ceil(s/p);return{key:e.id,id:e.id,type:e.authorized_account==h.get("id")?"payee":"payer",authorized:a,from:n,to:a,limit:r.a.createElement("span",null,u.a.get_asset_amount(e.withdrawal_limit.amount,t)+" ",r.a.createElement(z.a,{asset:e.withdrawal_limit.asset_id})),until:i?l.a.localize(new Date(i),{type:"date",format:"full"}):l.a.translate("showcases.direct_debit.first_period_not_started"),expires:l.a.localize(new Date(e.expiration+"Z"),{type:"date",format:"full"}),claimed:0==e.claimed_this_period?"-":r.a.createElement("span",null,u.a.get_asset_amount(e.claimed_this_period,t)+" ",r.a.createElement(z.a,{asset:e.withdrawal_limit.asset_id})),rawData:L({},e)}}))).length&&m.filter((function(e){return e.authorized&&-1!==e.authorized.indexOf(d)}));var f=[{title:"#",dataIndex:"id",key:"id",sorter:function(e,t){return e.id>t.id?1:e.id<t.id?-1:0}},{title:"From",dataIndex:"from",key:"from",sorter:function(e,t){return e.from>t.from?1:e.from<t.from?-1:0}},{title:"To",dataIndex:"to",key:"to",sorter:function(e,t){return e.to>t.to?1:e.to<t.to?-1:0}},{title:l.a.translate("showcases.direct_debit.current_period_expires"),dataIndex:"until",key:"until",sorter:function(e,t){return e.until>t.until?1:e.until<t.until?-1:0}},{title:"Limit",dataIndex:"limit",key:"limit",sorter:function(e,t){return e.rawData.withdrawal_limit.amount-t.rawData.withdrawal_limit.amount}},{title:"Claimed",dataIndex:"claimed",key:"claimed",sorter:function(e,t){var a=e.rawData.claimed_this_period;return e.rawData.claimed_this_period-a}},{title:l.a.translate("showcases.direct_debit.expires"),dataIndex:"expires",key:"expires",sorter:function(e,t){return e.expires>t.expires?1:e.expires<t.expires?-1:0}},{title:"Actions",dataIndex:"action",key:"action",render:function(t,a){return a.type?"payer"===a.type?r.a.createElement("span",null,r.a.createElement(s.Button,{style:{marginRight:"10px"},onClick:function(){return e.handleDeleteProposal(a.rawData)}},l.a.translate("showcases.direct_debit.delete")),r.a.createElement(s.Button,{onClick:e.showModal({type:"update",payload:a.rawData})},l.a.translate("showcases.direct_debit.update"))):r.a.createElement("span",{onClick:e.showClaimModal({type:"claim",payload:a.rawData})},r.a.createElement(s.Button,null,l.a.translate("showcases.direct_debit.claim"))):null}}];return r.a.createElement("div",{className:"direct-debit-view"},r.a.createElement(s.Card,{className:"direct-debit-table-card"},r.a.createElement(s.Row,null,r.a.createElement(s.Col,{span:24,style:{padding:"10px"}},r.a.createElement("div",{style:{marginBottom:"30px"}},r.a.createElement(s.Input,{className:"direct-debit-table__filter-input",placeholder:l.a.translate("explorer.witnesses.filter_by_name"),onChange:this._onFilter,style:{width:"200px",marginRight:"30px"},addonAfter:r.a.createElement(s.Icon,{type:"search"})}),r.a.createElement(s.Button,{onClick:this.showModal({type:"create",payload:null}),style:{marginRight:"30px"}},l.a.translate("showcases.direct_debit.create_new_mandate")),!!this.state.errorMessage&&r.a.createElement("span",{className:"red"},this.state.errorMessage)),r.a.createElement(s.Table,{columns:f,dataSource:m,pagination:!1,className:"direct-debit-table"}))),a?r.a.createElement(R,{isModalVisible:a,hideModal:this.hideModal,operation:i}):null,n?r.a.createElement(F.a,{isModalVisible:n,hideModal:this.hideClaimModal,operation:p}):null))}}]),t}(n.Component);H=Object(V.a)(H);t.default=H},2341:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(4),s=a(5),i=a.n(s),l=a(6),c=a(16),u=a(606),p=a(2),d=a.n(p),h=a(593),m=a(3),f=a.n(m),_=a(282),g=a(23),b=a(76),y=a(40),w=a(212),v=a(371),E=a(168),k=a(30),C=a(21),S=a(32),O=a.n(S),x=a(2313),A=(a(2314),a(44)),j=a(1),N=a.n(j),M=a(2030),T=a(372),P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function B(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function R(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var F=function(){return new y.a({amount:0,asset_id:"1.3.0"})},z=function(e){function t(e){B(this,t);var a=D(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.state=a.getInitialState(),a.hasRandomHash=!1,a}return R(t,e),I(t,[{key:"getInitialState",value:function(){return{stage:1,preimage_hash_calculated:null,ciphers:["sha256","ripemd160"]}}},{key:"componentDidMount",value:function(){this.props.preimage_hash||this.hasRandomHash||this.generateRandom({target:{}})}},{key:"componentDidUpdate",value:function(e,t){e.preimage_hash===this.props.preimage_hash||this.props.preimage_hash||(this.hasRandomHash=!1),this.props.preimage_hash||this.hasRandomHash||this.generateRandom({target:{}})}},{key:"onClick",value:function(e){var t=this,a=!1;this.state.stage!==e.target.value&&1==e.target.value&&(a=!0),this.setState({stage:e.target.value},(function(){return a?t.generateRandom():null}))}},{key:"onSizeChanged",value:function(e){this.props.onAction({preimage_size:e.target.value?parseInt(e.target.value):null})}},{key:"onHashChanged",value:function(e){this.props.onAction({preimage_hash:e.target.value})}},{key:"onInputChanged",value:function(e){var t=this.props,a=t.preimage,n=t.preimage_cipher;if(n||(n="sha256"),e.target?(a=e.target.value,this.hashingInProgress=!1):n=e,2==this.state.stage)this.props.onAction({preimage_cipher:n});else{var r=x.a.calculateHash(a,n).hash;"create"!==this.props.type?(this.props.onAction({preimage:a,preimage_cipher:n,preimage_size:a.length}),this.setState({preimage_hash_calculated:r})):this.props.onAction({preimage:a,preimage_cipher:n,preimage_hash:r,preimage_size:a.length})}}},{key:"generateRandom",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{target:{}};this.hasRandomHash=!0,e.target.value=l.key.get_random_key().toWif().substr(10,30),this.onInputChanged(e)}},{key:"render",value:function(){var e=r.a.createElement(r.a.Fragment,null,i.a.translate(this.props.label),"create"==this.props.type&&r.a.createElement(o.Radio.Group,{value:this.state.stage,onChange:this.onClick.bind(this),style:{marginBottom:"7px",marginLeft:"24px"}},r.a.createElement(o.Radio,{value:1},r.a.createElement(d.a,{content:"showcases.htlc.first_stage"})),r.a.createElement(o.Radio,{value:2},r.a.createElement(d.a,{content:"showcases.htlc.second_stage"})),r.a.createElement(o.Radio,{value:3},r.a.createElement(d.a,{content:"showcases.htlc.custom"})))),t="create"!==this.props.type&&null!==this.state.preimage_hash_calculated?this.state.preimage_hash_calculated==this.props.preimage_hash:null;return r.a.createElement(o.Form.Item,{label:e},r.a.createElement("span",null,i.a.translate("showcases.htlc.preimage_has_been_created")),r.a.createElement(o.Input.Group,{className:"content-block transfer-input preimage-row"},r.a.createElement(o.Tooltip,{title:i.a.translate("create"!==this.props.type?"showcases.htlc.tooltip.enter_preimage":"showcases.htlc.tooltip.preimage_random"),mouseEnterDelay:.5},r.a.createElement(o.Input,{style:{width:"60%",color:null==t?void 0:t?"green":"red"},name:"preimage",id:"preimage",type:"text",onChange:this.onInputChanged.bind(this),value:2==this.state.stage?"":this.props.preimage,placeholder:i.a.translate(this.props.hash?"showcases.htlc.enter_secret_preimage":"showcases.htlc.preimage"),disabled:"create"===this.props.type&&(1==this.state.stage||2==this.state.stage)})),r.a.createElement(o.Select,{optionLabelProp:"value",style:{width:"19.5%"},onChange:this.onInputChanged.bind(this),value:this.props.preimage_cipher},this.state.ciphers.map((function(e){return r.a.createElement(o.Select.Option,{key:e,value:e},e)}))),r.a.createElement(o.Tooltip,{title:i.a.translate("showcases.htlc.tooltip.new_random"),mouseEnterDelay:.5},r.a.createElement(o.Button,{type:"primary",icon:"deployment-unit",style:{verticalAlign:"top"},onClick:this.generateRandom.bind(this)})),r.a.createElement("div",{style:{float:"right"}},r.a.createElement(E.a,{dataPlace:"top",text:"preimage: "+this.props.preimage+" hash type: "+this.props.preimage_cipher}))),r.a.createElement(o.Input.Group,{className:"content-block transfer-input preimage-row"},r.a.createElement(o.Tooltip,{title:i.a.translate("showcases.htlc.tooltip.preimage_hash"),mouseEnterDelay:.5},r.a.createElement(o.Input,{style:{width:"78%"},name:"hash",id:"hash",type:"text",onChange:this.onHashChanged.bind(this),value:this.props.preimage_hash||"",placeholder:i.a.translate("showcases.htlc.hash"),disabled:1==this.state.stage})),r.a.createElement(o.Tooltip,{title:i.a.translate("showcases.htlc.tooltip.preimage_size"),mouseEnterDelay:.5},r.a.createElement(o.Input,{style:{width:"53px",marginRight:"0.2rem"},name:"size",id:"size",type:"text",onChange:this.onSizeChanged.bind(this),value:this.props.preimage_size||"",placeholder:i.a.translate("showcases.htlc.size"),disabled:1==this.state.stage})),r.a.createElement("div",{style:{float:"right"}},r.a.createElement(E.a,{dataPlace:"top",text:"hash: "+this.props.preimage_hash+" preimage size: "+this.props.preimage_size}))))}}]),t}(r.a.Component);z.propTypes={preimage_hash:N.a.string,preimage_size:N.a.number,preimage:N.a.string,preimage_cipher:N.a.string};var V=function(e){function t(e){B(this,t);var a=D(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.onSubmit=function(e){e.preventDefault();var t=a.state,n=t.from_account,r=t.to_account,o=t.amount,s=t.asset,i=t.asset_id,l=t.preimage,u=t.preimage_size,p=t.preimage_hash,d=t.preimage_cipher,h=t.claim_period,m=t.feeAmount,f=a.props.operation.type;"create"===f?x.a.create({from_account_id:n.get("id"),to_account_id:r.get("id"),asset_id:i,amount:c.a.convert_typed_to_satoshi(o,s),lock_time:h,preimage:l,preimage_size:u,preimage_hash:p,preimage_cipher:d,fee_asset:m.asset_id}).then((function(e){a.props.hideModal()})).catch((function(e){console.error(e)})):"redeem"===f?x.a.redeem({htlc_id:a.props.operation.payload.id,user_id:r.get("id"),preimage:l}).then((function(e){a.props.hideModal()})).catch((function(e){console.error(e)})):"extend"===f&&x.a.extend({htlc_id:a.props.operation.payload.id,user_id:n.get("id"),seconds_to_add:h}).then((function(e){a.props.hideModal()})).catch((function(e){console.error(e)})),a.props.hideModal()},a.onToAccountChanged=function(e){a.setState({to_account:e,error:null})},a.onAmountChanged=function(e){var t=e.amount,n=e.asset;n&&("object"!==(void 0===n?"undefined":P(n))&&(n=l.ChainStore.getAsset(n)),a.setState({amount:t,asset:n,asset_id:n.get("id"),error:null,maxAmount:!1},a._checkBalance))},a.toChanged=function(e){a.setState({to_name:e,error:null})},a.onExpirationDateChanged=function(e){if(e){var t=a.state.period_start_time,n=e.valueOf(),r=t.valueOf(),o=Math.floor((n-r)/1e3);a.setState({claim_period:o,period:null,expirationDate:e})}else a.setState({claim_period:0,period:null,expirationDate:null})},a.setPeriod=function(e){var t=O()().add(e,"day"),n="one_day",r=60*e*60*24;switch(e){case 1:n="one_day";break;case 2:n="two_days";break;case 7:n="one_week"}a.setState({claim_period:r,period:n,expirationDate:t})},a.state=a.getInitialState(e),a.onTrxIncluded=a.onTrxIncluded.bind(a),a._checkBalance=a._checkBalance.bind(a),a}return R(t,e),I(t,[{key:"getInitialState",value:function(){var e=O()().add("seconds",120);return{from_name:"",to_name:"",from_account:null,to_account:null,amount:"",asset_id:null,asset:null,error:null,feeAmount:F(),maxAmount:!1,num_of_periods:"",period_start_time:e,htlcId:"",balanceError:!1,preimage:null,preimage_cipher:null,preimage_hash:null,preimage_size:null,claim_period:86400,period:"one_day",expirationDate:O()().add("seconds",180).add(1,"day")}}},{key:"shouldComponentUpdate",value:function(e,t,a){return!(e.fromAccount&&!Object(M.b)(e.fromAccount))}},{key:"_syncOperation",value:function(e){if(e&&e.payload&&"create"!==e.type){var t=e.payload.transfer.to,a=e.payload.transfer.from,n={amount:e.payload.transfer.amount,asset_id:e.payload.transfer.asset_id},r=new Date(e.payload.conditions.time_lock.expiration),o=l.ChainStore.getAccount(t),s=l.ChainStore.getAccount(a);if(o&&s&&o.get&&s.get){var i=l.ChainStore.getAsset(n.asset_id,!1);this.setState({to_account:o,to_name:o.get("name"),from_account:s,from_name:s.get("name"),asset:i,amount:c.a.convert_satoshi_to_typed(n.amount,i),asset_id:n.asset_id,period_start_time:r,htlcId:e.payload.id,preimage_hash:e.payload.conditions.hash_lock.preimage_hash[1],preimage_size:e.payload.conditions.hash_lock.preimage_hash[0],expirationDate:O()(new Date(c.a.makeISODateString(e.payload.conditions.time_lock.expiration))),period:null})}else this.setState({htlcId:e.payload.id,preimage_hash:e.payload.conditions.hash_lock.preimage_hash[1],preimage_size:e.payload.conditions.hash_lock.preimage_hash[0],expirationDate:O()(new Date(c.a.makeISODateString(e.payload.conditions.time_lock.expiration))),period:null})}else this.setState({htlcId:null,preimage_hash:null,preimage_size:null})}},{key:"componentDidMount",value:function(){this._syncOperation(this.props.operation)}},{key:"componentDidUpdate",value:function(e,t){var a=this.props.operation;this.props.fromAccount===e.fromAccount&&null!=this.state.from_account||this.setState({from_account:this.props.fromAccount,from_name:this.props.fromAccount.get("name")}),e.operation!==this.props.operation&&this._syncOperation(a)}},{key:"_checkBalance",value:function(){var e=this.state,t=e.feeAmount,a=e.amount,n=e.from_account,r=e.asset;if(r&&n){var o=n.getIn(["balances",r.get("id")]),s=n.getIn(["balances",t.asset_id]);if(r&&n){if(!o)return this.setState({balanceError:!0});var i=l.ChainStore.getObject(o),c=s?l.ChainStore.getObject(s):null;if(c&&0!==c.get("balance")||this.setState({feeAmount:F()}),i&&t){if(!a)return this.setState({balanceError:!1});var u=Object(w.a)(a,r,t,i);null!==u&&this.setState({balanceError:!u})}}}}},{key:"_setTotal",value:function(e,t){var a=this.state.feeAmount,n=l.ChainStore.getObject(t),r=l.ChainStore.getObject(e),o=new y.a({amount:n.get("balance"),asset_id:r.get("id"),precision:r.get("precision")});n&&(a.asset_id===o.asset_id&&o.minus(a),this.setState({maxAmount:!0,amount:o.getAmount({real:!0})},this._checkBalance))}},{key:"_getAvailableAssets",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state,t=e.from_account,a=e.from_error,n=[];if(!t||!t.get("balances")||a)return{asset_types:n};var r=e.from_account.get("balances").toJS();for(var o in n=Object.keys(r).sort(c.a.sortID),r){var s=l.ChainStore.getObject(r[o]);s&&0===s.get("balance")&&n.splice(n.indexOf(o),1)}return{asset_types:n}}},{key:"onFeeChanged",value:function(e){e&&this.setState({feeAmount:e,error:null},this._checkBalance)}},{key:"onTrxIncluded",value:function(e){e.included&&e.broadcasted_transaction?(b.a.unlisten(this.onTrxIncluded),b.a.reset()):e.closed&&(b.a.unlisten(this.onTrxIncluded),b.a.reset())}},{key:"onDatepickerRef",value:function(e){e&&e.picker.input&&(e.picker.input.readOnly=!1)}},{key:"onPreimageChanged",value:function(e){var t=e.preimage,a=e.preimage_cipher,n=e.preimage_hash,r=e.preimage_size,o={};void 0!==t&&(o.preimage=t),void 0!==a&&(o.preimage_cipher=a),void 0!==n&&(o.preimage_hash=n),void 0!==r&&(o.preimage_size=r),this.setState(o)}},{key:"render",value:function(){var e=this,t=this.state,a=t.from_account,n=t.to_account,s=t.asset,c=t.asset_id,p=t.feeAmount,m=t.amount,b=t.from_name,y=t.to_name,w=t.balanceError,E=t.preimage,k=t.preimage_cipher,C=t.claim_period,S=t.preimage_hash,O=t.preimage_size,x=t.period_start_time,A=t.expirationDate,j=g.a.isMyAccount(a)||b===this.props.passwordAccount,N=!(!a||j),M=this.props.operation,P=M&&"extend"===M.type,I=M&&"redeem"===M.type,B=this._getAvailableAssets().asset_types,D=null;if(a&&a.get("balances")&&!N){var R=a.get("balances").toJS(),F=this.state.balanceError?"has-error":"";if(1===B.length&&(s=l.ChainStore.getAsset(B[0])),B.length>0){var V=s?s.get("id"):B[0];D=r.a.createElement("span",null,r.a.createElement(d.a,{component:"span",content:"transfer.available"}),":"," ",r.a.createElement("span",{className:F,style:{borderBottom:"#A09F9F 1px dotted",cursor:"pointer"},onClick:this._setTotal.bind(this,V,R[V],p.getAmount({real:!0}),p.asset_id)},r.a.createElement(v.a,{balance:R[V]})))}else D=r.a.createElement("span",null,r.a.createElement("span",{className:F},r.a.createElement(d.a,{content:"transfer.errors.noFunds"})))}var L=parseFloat(String.prototype.replace.call(m,/,/g,"")),W=L&&!Object(u.a)(L),H=!a||!n||!W||!s||w||a.get("id")==n.get("id")||!(k&&E||S)||!C,U=M&&"create"===M.type?i.a.translate("showcases.htlc.create_htlc"):P?i.a.translate("showcases.htlc.extend_htlc"):i.a.translate("showcases.htlc.redeem_htlc"),q=M&&"create"===M.type?i.a.translate("showcases.direct_debit.create"):i.a.translate("showcases.direct_debit.update"),J=r.a.createElement("div",{className:"form-input-header--label"},i.a.translate("showcases.htlc.expiration_date"),r.a.createElement("div",{className:"form-input-header--right"},r.a.createElement("span",{className:f()("period-row",{"is-active":"one_day"===this.state.period}),onClick:function(){return e.setPeriod(1)}},i.a.translate("showcases.htlc.expiration_period.one_day")),r.a.createElement("span",{className:f()("period-row",{"is-active":"two_days"===this.state.period}),onClick:function(){return e.setPeriod(2)}},i.a.translate("showcases.htlc.expiration_period.two_days")),r.a.createElement("span",{className:f()("period-row",{"is-active":"one_week"===this.state.period}),onClick:function(){return e.setPeriod(7)}},i.a.translate("showcases.htlc.expiration_period.one_week"))));return r.a.createElement(o.Modal,{title:U,visible:this.props.isModalVisible,overlay:!0,onCancel:this.props.hideModal,footer:[r.a.createElement(o.Button,{key:"send",disabled:H,onClick:H?null:this.onSubmit.bind(this)},q),r.a.createElement(o.Button,{key:"Cancel",onClick:this.props.hideModal},r.a.createElement(d.a,{component:"span",content:"transfer.cancel"}))]},r.a.createElement("div",{className:"grid-block vertical no-overflow"},r.a.createElement(o.Form,{className:"full-width",layout:"vertical"},r.a.createElement(_.a,{label:"showcases.htlc.sender",accountName:b,account:a,size:60,typeahead:!0,hideImage:!0,disabled:!0}),r.a.createElement(_.a,{label:"showcases.htlc.recipient",accountName:y,account:n,onChange:this.toChanged.bind(this),onAccountChanged:this.onToAccountChanged,size:60,typeahead:!0,hideImage:!0,disabled:P||I}),I?null:r.a.createElement(h.a,{label:"showcases.htlc.amount",amount:m,onChange:this.onAmountChanged.bind(this),asset:B.length>0&&s?s.get("id"):c||B[0],assets:B,display_balance:P||I?void 0:D,allowNaN:!0,disabled:P||I,selectDisabled:P||I}),P?r.a.createElement(o.Form.Item,{label:i.a.translate("showcases.htlc.preimage")},r.a.createElement(o.Input,{type:"text",value:S||"",placeholder:i.a.translate("showcases.htlc.hash"),readOnly:!0,disabled:!0})):r.a.createElement(z,{ref:function(t){return e.preimage=t},label:"showcases.htlc.preimage",onAction:this.onPreimageChanged.bind(this),preimage_hash:S,preimage_size:O,preimage:E,preimage_cipher:k,type:M&&M.type?M.type:"create"}),I?null:r.a.createElement("div",null,r.a.createElement(o.Form.Item,{label:J,validateStatus:"",className:"form-input-header"},r.a.createElement(o.DatePicker,{showToday:!0,showTime:!0,placeholder:"",onChange:this.onExpirationDateChanged,className:"date-picker-width100",style:{width:"100%"},ref:function(t){return e.onDatepickerRef(t)},disabledDate:function(e){return e&&e<x},value:A})),r.a.createElement("div",{className:"content-block transfer-input"},r.a.createElement("div",{className:"no-margin no-padding"},r.a.createElement(T.a,{account:a,transaction:{type:"htlc_create",options:["price_per_kbyte"],data:{type:"memo",content:null}},onChange:this.onFeeChanged.bind(this)})))))))}}]),t}(r.a.Component);V.propTypes={isModalVisible:N.a.bool.isRequired,hideModal:N.a.func.isRequired,fromAccount:A.a.ChainObject.isRequired,operation:N.a.object};var L=Object(k.a)(V,{listenTo:function(){return[C.a]},getProps:function(e){return{fee_asset_symbol:C.a.getState().settings.get("fee_asset")}}}),W=a(182),H=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},U=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}();function q(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,a){return function n(r,o){try{var s=t[r](o),i=s.value}catch(e){return void a(e)}if(!s.done)return Promise.resolve(i).then((function(e){n("next",e)}),(function(e){n("throw",e)}));e(i)}("next")}))}}var J=function(e){function t(e){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.showModal=function(e){return q(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.payload){t.next=7;break}return t.next=3,Object(l.FetchChainObjects)(l.ChainStore.getAccount,[e.payload.transfer.to],void 0,{});case 3:return t.next=5,Object(l.FetchChainObjects)(l.ChainStore.getAccount,[e.payload.transfer.from],void 0,{});case 5:return t.next=7,Object(l.FetchChainObjects)(l.ChainStore.getAsset,[e.payload.transfer.asset_id]);case 7:n.setState({isModalVisible:!0,operationData:e});case 8:case"end":return t.stop()}}),t,a)})))},n.hideModal=function(){n.setState({isModalVisible:!1,operation:null})},n._onFilter=function(e){e.preventDefault(),n.setState({filterString:e.target.value.toLowerCase()})},n.state={isModalVisible:!1,filterString:"",operationData:void 0,htlc_list:[],tableIsLoading:!1},n.hasLoadedOnce=null,n}var a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),U(t,[{key:"shouldComponentUpdate",value:function(e,t){return this.props.currentAccount!==e.currentAccount||JSON.stringify(this.state.htlc_list)!==JSON.stringify(t.htlc_list)||this.state.isModalVisible!==t.isModalVisible||this.state.tableIsLoading!==t.tableIsLoading||this.state.filterString!==t.filterString}},{key:"_update",value:(a=q(regeneratorRuntime.mark((function e(){var t,a,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=this.props.currentAccount).get("id"),this.hasLoadedOnce=t.get("id"),this.setState({tableIsLoading:!0}),a=this.props.currentAccount.get("htlcs_from").toJS()||[],n=this.props.currentAccount.get("htlcs_to").toJS()||[],this.setState({htlc_list:a.concat(n).map((function(e){return l.ChainStore.getObject(e)})).map((function(e){return e.toJS?e.toJS():void 0})),tableIsLoading:!1});case 8:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"componentDidMount",value:function(){this._update()}},{key:"componentDidUpdate",value:function(e){this._update()}},{key:"render",value:function(){var e=this,t=this.state,a=t.isModalVisible,n=t.htlc_list,s=t.operationData,u=t.filterString,p=this.props.currentAccount,d=null;n.length&&(d=n.map((function(e){var t=e.transfer.to,a=e.transfer.from,n={amount:e.transfer.amount,asset_id:e.transfer.asset_id},s=e.conditions.time_lock.expiration,u=l.ChainStore.getAsset(n.asset_id,!1),d=l.ChainStore.getAccountName(t)||t,h=l.ChainStore.getAccountName(a)||a;return{key:e.id,id:e.id,type:t==p.get("id")?"payee":"payer",from:h,to:d,amount:r.a.createElement("span",null,u?c.a.get_asset_amount(n.amount,u)+" ":null,r.a.createElement(W.a,{asset:n.asset_id})),hash:r.a.createElement(o.Tooltip,{title:i.a.translate("htlc.preimage_hash_explanation")},r.a.createElement("span",null,"("+e.conditions.hash_lock.preimage_size+","+e.conditions.hash_lock.preimage_hash[0]+"): "+e.conditions.hash_lock.preimage_hash[1])),expires:s,rawData:H({},e)}}))).length&&d.filter((function(e){return e.to&&-1!==e.to.indexOf(u)}));var h=[{title:"#",dataIndex:"id",key:"id",sorter:function(e,t){return e.id>t.id?1:e.id<t.id?-1:0}},{title:i.a.translate("showcases.htlc.from"),dataIndex:"from",key:"from",sorter:function(e,t){return e.from>t.from?1:e.from<t.from?-1:0}},{title:i.a.translate("showcases.htlc.to"),dataIndex:"to",key:"to",sorter:function(e,t){return e.to>t.to?1:e.to<t.to?-1:0}},{title:i.a.translate("showcases.htlc.amount"),dataIndex:"amount",key:"amount",sorter:function(e,t){return e.rawData.op[1].amount.amount-t.rawData.op[1].amount.amount}},{title:i.a.translate("showcases.htlc.hash"),dataIndex:"hash",key:"hash"},{title:i.a.translate("showcases.htlc.expires"),dataIndex:"expires",key:"expires",sorter:function(e,t){return e.expires>t.expires?1:e.expires<t.expires?-1:0},render:function(e,t){return i.a.localize(new Date(c.a.makeISODateString(e)),{type:"date",format:"full"})}},{title:i.a.translate("showcases.htlc.actions"),dataIndex:"action",key:"action",render:function(t,a){return a.type?"payer"===a.type?r.a.createElement("span",null,r.a.createElement(o.Button,{style:{marginRight:"10px"},onClick:e.showModal({type:"extend",payload:a.rawData})},i.a.translate("showcases.htlc.extend"))):r.a.createElement("span",{onClick:e.showModal({type:"redeem",payload:a.rawData})},r.a.createElement(o.Button,null,i.a.translate("showcases.htlc.redeem"))):null}}];return r.a.createElement("div",{className:"direct-debit-view"},r.a.createElement(o.Card,{className:"direct-debit-table-card"},r.a.createElement(o.Row,null,r.a.createElement(o.Col,{span:24,style:{padding:"10px"}},r.a.createElement("div",{style:{marginBottom:"30px"}},r.a.createElement(o.Input,{className:"direct-debit-table__filter-input",placeholder:i.a.translate("explorer.witnesses.filter_by_name"),onChange:this._onFilter,style:{width:"200px",marginRight:"30px"},addonAfter:r.a.createElement(o.Icon,{type:"search"})}),r.a.createElement(o.Button,{onClick:this.showModal({type:"create",payload:null}),style:{marginRight:"30px"}},i.a.translate("showcases.htlc.create_htlc")),!!this.state.errorMessage&&r.a.createElement("span",{className:"red"},this.state.errorMessage)),r.a.createElement(o.Table,{columns:h,dataSource:d,pagination:!1,className:"direct-debit-table",loading:this.state.tableIsLoading}))),a?r.a.createElement(L,{isModalVisible:a,hideModal:this.hideModal,operation:s,fromAccount:this.props.currentAccount}):null))}}]),t}(n.Component);J=Object(M.a)(J);t.default=J}}]);
//# sourceMappingURL=settings.js.map
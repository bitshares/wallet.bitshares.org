(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{1776:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(1798),s=n.n(o),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var c=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={animateEnter:!1},e.timer=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.a.Component),i(t,[{key:"componentDidMount",value:function(){this.enableAnimation()}},{key:"resetAnimation",value:function(){this.setState({animateEnter:!1}),this.enableAnimation()}},{key:"enableAnimation",value:function(){var e=this;this.timer=setTimeout(function(){e.timer&&e.setState({animateEnter:!0})},2e3)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timer),this.timer=null}},{key:"render",value:function(){return this.props.children?r.a.createElement(s.a,{className:this.props.className,component:this.props.component,transitionName:this.props.transitionName,transitionEnterTimeout:this.props.enterTimeout,transitionEnter:this.state.animateEnter,transitionLeave:!1},this.props.children):r.a.createElement(this.props.component)}}]),t}();c.defaultProps={component:"span",enterTimeout:2e3},t.a=c},1783:function(e,t,n){"use strict";n.d(t,"a",function(){return I}),n.d(t,"b",function(){return T});var a=n(0),r=n.n(a),o=n(3),s=n.n(o),i=n(320),c=n(498),l=n(37),u=n(43),m=n(14),f=n(9),h=n(1776),p=n(1780),d=n.n(p),b=n(16),g=n.n(b),v=n(18),_=n(7),y=n.n(_),E=n(1),k=n.n(E),w=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function S(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var O=f.c.operations,C={textAlign:"left"},j={textAlign:"right"};function N(e,t){return t.block_num===e.block_num?t.virtual_op-e.virtual_op:t.block_num-e.block_num}function F(e){return e?'"'+e.textContent.replace(/[\s\t\r\n]/gi," ")+'"':""}var I=function(e){function t(e){A(this,t);var n=x(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.state={limit:e.limit||20,csvExport:!1,headerHeight:85,filter:"all"},n}return S(t,r.a.Component),w(t,[{key:"componentDidMount",value:function(){if(!this.props.fullHeight){var e=this.refs.transactions;d.a.initialize(e),this._setHeaderHeight()}}},{key:"_setHeaderHeight",value:function(){var e=this.refs.header.offsetHeight;e!==this.state.headerHeight&&this.setState({headerHeight:e})}},{key:"shouldComponentUpdate",value:function(e,t){if(!m.a.are_equal_shallow(this.props.accountsList,e.accountsList))return!0;if(this.props.maxHeight!==e.maxHeight)return!0;if(this.state.headerHeight!==t.headerHeight)return!0;if(this.state.filter!==t.filter)return!0;if(this.props.customFilter&&(!m.a.are_equal_shallow(this.props.customFilter.fields,e.customFilter.fields)||!m.a.are_equal_shallow(this.props.customFilter.values,e.customFilter.values)))return!0;if(this.props.maxHeight!==e.maxHeight)return!0;if(t.limit!==this.state.limit||t.csvExport!==this.state.csvExport)return!0;for(var n=0;n<e.accountsList.length;++n){var a=e.accountsList[n],r=this.props.accountsList[n];if(a&&r&&a.get("history")!==r.get("history"))return!0}return!1}},{key:"componentDidUpdate",value:function(){if(this.state.csvExport){this.state.csvExport=!1;var e=document.getElementById("csv_export_container").childNodes,t="",n=!0,a=!1,r=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var c=o.value.childNodes;""!==t&&(t+="\n"),t+=[F(c[0]),F(c[1]),F(c[2]),F(c[3])].join(",")}}catch(e){a=!0,r=e}finally{try{!n&&s.return&&s.return()}finally{if(a)throw r}}var l=new Blob([t],{type:"text/csv;charset=utf-8"}),u=new Date;Object(i.saveAs)(l,"btshist-"+u.getFullYear()+"-"+("0"+(u.getMonth()+1)).slice(-2)+"-"+("0"+u.getDate()).slice(-2)+"-"+("0"+u.getHours()).slice(-2)+("0"+u.getMinutes()).slice(-2)+".csv")}if(!this.props.fullHeight){var m=this.refs.transactions;d.a.update(m),this._setHeaderHeight()}}},{key:"_onIncreaseLimit",value:function(){this.setState({limit:this.state.limit+30})}},{key:"_getHistory",value:function(e,t,n){var a=[],r=new Set,o=!0,s=!1,i=void 0;try{for(var c,l=e[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var u=c.value;if(u){var m=u.get("history");m&&(a=a.concat(m.toJS().filter(function(e){return!r.has(e.id)&&r.add(e.id)})))}}}catch(e){s=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(s)throw i}}return t&&(a=a.filter(function(e){return e.op[0]===O[t]})),n&&(a=a.filter(function(e){return n.fields.reduce(function(t,a){switch(a){case"asset_id":return t&&e.op[1].amount[a]===n.values[a];default:return t&&e.op[1][a]===n.values[a]}},!0)})),a}},{key:"_downloadCSV",value:function(){this.setState({csvExport:!0})}},{key:"_onChangeFilter",value:function(e){this.setState({filter:e.target.value})}},{key:"render",value:function(){var e=this.props,t=e.accountsList,n=e.compactView,a=e.filter,o=e.customFilter,i=e.style,l=e.maxHeight,u=this.state,m=u.limit,f=u.headerHeight,p=1===t.length&&t[0]?t[0].get("id"):null,d=this._getHistory(t,this.props.showFilters&&"all"!==this.state.filter?this.state.filter:a,o).sort(N),b=d.length;i=i||{width:"100%",height:"100%"};var _=null;_=["all","transfer","limit_order_create","limit_order_cancel","fill_order","account_create","account_update","asset_create","witness_withdraw_pay","vesting_balance_withdraw"].map(function(e){return r.a.createElement("option",{value:e,key:e},g.a.translate("transaction.trxTypes."+e))});var E=d.length?d.slice(0,m).map(function(e){return r.a.createElement(c.a,{includeOperationId:!0,operationId:e.id,style:C,key:e.id,op:e.op,result:e.result,txIndex:e.trx_in_block,block:e.block_num,current:p,hideFee:!0,inverted:!1,hideOpLabel:n,fullDate:!0})}):[r.a.createElement("tr",{key:"no_recent"},r.a.createElement("td",{colSpan:n?"2":"3"},r.a.createElement(s.a,{content:"operation.no_recent"})))];return E.push(r.a.createElement("tr",{className:"total-value",key:"total_value"},r.a.createElement("td",{className:"column-hide-tiny"}),r.a.createElement("td",{style:j},b>0?r.a.createElement("span",null,r.a.createElement("a",{className:"inline-block",onClick:this._downloadCSV.bind(this),"data-tip":g.a.translate("transaction.csv_tip"),"data-place":"bottom"},r.a.createElement(v.a,{name:"excel",title:"icons.excel",className:"icon-14px"}))):null),r.a.createElement("td",{style:{textAlign:"center"}}," ",this.props.showMore&&b>this.props.limit||m<b?r.a.createElement("a",{onClick:this._onIncreaseLimit.bind(this)},r.a.createElement(v.a,{name:"chevron-down",title:"icons.chevron_down.transactions",className:"icon-14px"})):null))),r.a.createElement("div",{className:"recent-transactions no-overflow",style:i},r.a.createElement("div",{className:"generic-bordered-box"},this.props.dashboard?null:r.a.createElement("div",{ref:"header"},r.a.createElement("div",{className:"block-content-header"},r.a.createElement("span",null,this.props.title?this.props.title:r.a.createElement(s.a,{content:"account.recent"})))),r.a.createElement("div",{className:"header-selector"},r.a.createElement("div",{className:"selector"},r.a.createElement("div",{className:y()("inline-block")},this.props.showFilters?r.a.createElement("select",{"data-place":"left","data-tip":g.a.translate("tooltip.filter_ops"),style:{paddingTop:5,width:"auto"},className:"bts-select no-margin",value:this.state.filter,onChange:this._onChangeFilter.bind(this)},_):null))),r.a.createElement("div",{className:"box-content grid-block no-margin",style:this.props.fullHeight?null:{maxHeight:l-f},ref:"transactions"},r.a.createElement("table",{className:"table table-striped "+(n?"compact":"")+(this.props.dashboard?" dashboard-table table-hover":"")},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"column-hide-tiny",style:C},r.a.createElement(s.a,{content:"account.transactions.id"})),r.a.createElement("th",{className:"column-hide-tiny",style:C},r.a.createElement(s.a,{content:"account.transactions.type"})),r.a.createElement("th",{style:C},r.a.createElement(s.a,{content:"account.transactions.info"})),r.a.createElement("th",{style:C},r.a.createElement(s.a,{content:"account.transactions.time"})))),r.a.createElement(h.a,{component:"tbody",transitionName:"newrow"},E))),b>0&&this.state.csvExport&&r.a.createElement("div",{id:"csv_export_container",style:{display:"none"}},r.a.createElement("div",null,r.a.createElement("div",null,"DATE"),r.a.createElement("div",null,"OPERATION"),r.a.createElement("div",null,"MEMO"),r.a.createElement("div",null,"AMOUNT")),d.map(function(e){return r.a.createElement(c.a,{key:e.id,op:e.op,result:e.result,block:e.block_num,inverted:!1,csvExportMode:!0})}))))}}]),t}();I.propTypes={accountsList:l.a.ChainAccountsList.isRequired,compactView:k.a.bool,limit:k.a.number,maxHeight:k.a.number,fullHeight:k.a.bool,showFilters:k.a.bool},I.defaultProps={limit:25,maxHeight:500,fullHeight:!1,showFilters:!1},I=Object(u.a)(I);var T=function(e){function t(){return A(this,t),x(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return S(t,r.a.Component),w(t,[{key:"render",value:function(){return r.a.createElement("span",{className:"wrapper"},this.props.children(this.props))}}]),t}();T.propTypes={asset:l.a.ChainAsset.isRequired,to:l.a.ChainAccount.isRequired,fromAccount:l.a.ChainAccount.isRequired},T.defaultProps={asset:"1.3.0"},T=Object(u.a)(T)},1989:function(e,t,n){"use strict";var a=new RegExp("%[a-f0-9]{2}","gi"),r=new RegExp("(%[a-f0-9]{2})+","gi");function o(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),a=e.slice(t);return Array.prototype.concat.call([],o(n),o(a))}function s(e){try{return decodeURIComponent(e)}catch(r){for(var t=e.match(a),n=1;n<t.length;n++)t=(e=o(t,n).join("")).match(a);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},n=r.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var a=s(n[0]);a!==n[0]&&(t[n[0]]=a)}n=r.exec(e)}t["%C2"]="�";for(var o=Object.keys(t),i=0;i<o.length;i++){var c=o[i];e=e.replace(new RegExp(c,"g"),t[c])}return e}(e)}}},1990:function(e,t,n){"use strict";e.exports=(e=>encodeURIComponent(e).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},1991:function(e,t,n){"use strict";const a=n(1990),r=n(1989);function o(e,t){return t.encode?t.strict?a(e):encodeURIComponent(e):e}function s(e,t){return t.decode?r(e):e}function i(e){const t=e.indexOf("?");return-1===t?"":e.slice(t+1)}function c(e,t){const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,a)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===a[e]&&(a[e]={}),a[e][t[1]]=n):a[e]=n};case"bracket":return(e,n,a)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==a[e]?a[e]=[].concat(a[e],n):a[e]=[n]:a[e]=n};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t=Object.assign({decode:!0,arrayFormat:"none"},t)),a=Object.create(null);if("string"!=typeof e)return a;if(!(e=e.trim().replace(/^[?#&]/,"")))return a;for(const r of e.split("&")){let[e,o]=r.replace(/\+/g," ").split("=");o=void 0===o?null:s(o,t),n(s(e,t),o,a)}return Object.keys(a).sort().reduce((e,t)=>{const n=a[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(n):e[t]=n,e},Object.create(null))}t.extract=i,t.parse=c,t.stringify=((e,t)=>{!1===(t=Object.assign({encode:!0,strict:!0,arrayFormat:"none"},t)).sort&&(t.sort=(()=>{}));const n=function(e){switch(e.arrayFormat){case"index":return(t,n,a)=>null===n?[o(t,e),"[",a,"]"].join(""):[o(t,e),"[",o(a,e),"]=",o(n,e)].join("");case"bracket":return(t,n)=>null===n?[o(t,e),"[]"].join(""):[o(t,e),"[]=",o(n,e)].join("");default:return(t,n)=>null===n?o(t,e):[o(t,e),"=",o(n,e)].join("")}}(t);return e?Object.keys(e).sort(t.sort).map(a=>{const r=e[a];if(void 0===r)return"";if(null===r)return o(a,t);if(Array.isArray(r)){const e=[];for(const t of r.slice())void 0!==t&&e.push(n(a,t,e.length));return e.join("&")}return o(a,t)+"="+o(r,t)}).filter(e=>e.length>0).join("&"):""}),t.parseUrl=((e,t)=>({url:e.split("?")[0]||"",query:c(i(e),t)}))},2077:function(e,t,n){"use strict";n.r(t),function(e){var a=n(518),r=n(289),o=n(0),s=n.n(o),i=n(317),c=n(45),l=n(3),u=n.n(l),m=n(191),f=n(239),h=n(26),p=n(288),d=n(14),b=n(16),g=n.n(b),v=n(91),_=n(1783),y=n(11),E=n.n(y),k=n(9),w=n(34),A=n(132),x=n(7),S=n.n(x),O=n(31),C=n(1991),j=n.n(C),N=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();var F=function(t){function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e)),a=n.getInitialState(),o=j.a.parse(e.location.search)||{};o.from&&(a.from_name=o.from,k.b.getAccount(o.from)),o.to&&(a.to_name=o.to,k.b.getAccount(o.to)),o.amount&&(a.amount=o.amount),o.asset&&(a.asset_id=o.asset,a.asset=k.b.getAsset(o.asset)),o.memo&&(a.memo=o.memo);var s=h.a.getState().currentAccount;return a.from_name||(a.from_name=s),t.state=a,t.onTrxIncluded=t.onTrxIncluded.bind(t),t._updateFee=Object(r.a)(t._updateFee.bind(t),250),t._checkFeeStatus=t._checkFeeStatus.bind(t),t._checkBalance=t._checkBalance.bind(t),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(n,s.a.Component),N(n,[{key:"componentWillMount",value:function(){this.nestedRef=null,this._updateFee(),this._checkFeeStatus()}},{key:"shouldComponentUpdate",value:function(e,t){var n=this._getAvailableAssets().asset_types,a=this._getAvailableAssets(t).asset_types;if(1===a.length){var r=k.b.getAsset(a[0]);1!==n.length&&this.onAmountChanged({amount:t.amount,asset:r}),a[0]!==this.state.fee_asset_id&&r&&this.state.fee_asset_id!==a[0]&&this.setState({feeAsset:r,fee_asset_id:a[0]})}return!0}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.currentAccount!==this.state.from_name&&e.currentAccount!==this.props.currentAccount&&this.setState({from_name:e.currentAccount,from_account:k.b.getAccount(e.currentAccount),feeStatus:{},fee_asset_id:"1.3.0",feeAmount:new O.a({amount:0})},function(){t._updateFee(),t._checkFeeStatus(k.b.getAccount(e.currentAccount))})}},{key:"_checkBalance",value:function(){var e=this.state,t=e.feeAmount,n=e.amount,a=e.from_account,r=e.asset;if(r&&a){var o=a.getIn(["balances",r.get("id")]),s=a.getIn(["balances",t.asset_id]);if(r&&a){if(!o)return this.setState({balanceError:!0});var i=k.b.getObject(o),c=s?k.b.getObject(s):null;if(c&&0!==c.get("balance")||this.setState({fee_asset_id:"1.3.0"},this._updateFee),i&&t){var l=Object(A.a)(n,r,t,i);null!==l&&this.setState({balanceError:!l})}}}}},{key:"_checkFeeStatus",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.from_account;if(t){var n=Object.keys(t.get("balances").toJS()).sort(d.a.sortID),a={},r=[];n.forEach(function(n){r.push(Object(A.b)({accountID:t.get("id"),feeID:n,options:["price_per_kbyte"],data:{type:"memo",content:e.state.memo}}))}),Promise.all(r).then(function(t){n.forEach(function(e,n){a[e]=t[n]}),d.a.are_equal_shallow(e.state.feeStatus,a)||e.setState({feeStatus:a}),e._checkBalance()}).catch(function(e){console.error(e)})}}},{key:"_updateFee",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state,n=t.fee_asset_id,a=t.from_account,r=t.asset_id,o=this._getAvailableAssets(t).fee_asset_types;if(1===o.length&&o[0]!==n&&(n=o[0]),!a)return null;Object(A.b)({accountID:a.get("id"),feeID:n,options:["price_per_kbyte"],data:{type:"memo",content:t.memo}}).then(function(t){var n=t.fee,o=t.hasBalance,s=t.hasPoolBalance;return Object(A.d)(a,n).then(function(t){return t?e.setState({fee_asset_id:r},e._updateFee):e.setState({feeAmount:n,fee_asset_id:n.asset_id,hasBalance:o,hasPoolBalance:s,error:!o||!s})})})}},{key:"fromChanged",value:function(e){e||this.setState({from_account:null}),this.setState({from_name:e,error:null,propose:!1,propose_account:""})}},{key:"toChanged",value:function(e){this.setState({to_name:e,error:null})}},{key:"onFromAccountChanged",value:function(e){var t=this;this.setState({from_account:e,error:null},function(){t._updateFee(),t._checkFeeStatus()})}},{key:"onToAccountChanged",value:function(e){this.setState({to_account:e,error:null})}},{key:"onAmountChanged",value:function(e){var t=e.amount,n=e.asset;n&&this.setState({amount:t,asset:n,asset_id:n.get("id"),error:null},this._checkBalance)}},{key:"onFeeChanged",value:function(e){var t=e.asset;this.setState({feeAsset:t,fee_asset_id:t.get("id"),error:null},this._updateFee)}},{key:"onMemoChanged",value:function(e){this.setState({memo:e.target.value},this._updateFee)}},{key:"onTrxIncluded",value:function(e){e.included&&e.broadcasted_transaction?(v.a.unlisten(this.onTrxIncluded),v.a.reset()):e.closed&&(v.a.unlisten(this.onTrxIncluded),v.a.reset())}},{key:"onPropose",value:function(e,t){t.preventDefault(),this.setState({propose:e,propose_account:null})}},{key:"onProposeAccount",value:function(e){this.setState({propose_account:e})}},{key:"resetForm",value:function(){this.setState({memo:"",to_name:"",amount:""})}},{key:"onSubmit",value:function(t){var n=this;t.preventDefault(),this.setState({error:null});var a=this.state,r=a.asset,o=a.amount,s=new O.a({real:o,asset_id:r.get("id"),precision:r.get("precision")});c.a.transfer(this.state.from_account.get("id"),this.state.to_account.get("id"),s.getAmount(),r.get("id"),this.state.memo?new e(this.state.memo,"utf-8"):this.state.memo,this.state.propose?this.state.propose_account:null,this.state.feeAsset?this.state.feeAsset.get("id"):"1.3.0").then(function(){n.resetForm.call(n),v.a.unlisten(n.onTrxIncluded),v.a.listen(n.onTrxIncluded)}).catch(function(e){var t=e.message?e.message.split("\n")[1]||e.message:null;console.log("error: ",e,t),n.setState({error:t})})}},{key:"setNestedRef",value:function(e){this.nestedRef=e}},{key:"_setTotal",value:function(e,t){var n=this.state.feeAmount,a=k.b.getObject(t),r=k.b.getObject(e),o=new O.a({amount:a.get("balance"),asset_id:r.get("id"),precision:r.get("precision")});a&&(n.asset_id===o.asset_id&&o.minus(n),this.setState({amount:o.getAmount({real:!0})},this._checkBalance))}},{key:"_getAvailableAssets",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state,t=this.state.feeStatus;var n=e.from_account,a=e.from_error,r=[],o=[];if(!n||!n.get("balances")||a)return{asset_types:r,fee_asset_types:o};var s=e.from_account.get("balances").toJS();for(var i in r=Object.keys(s).sort(d.a.sortID),o=Object.keys(s).sort(d.a.sortID),s){var c=k.b.getObject(s[i]);c&&0===c.get("balance")&&(r.splice(r.indexOf(i),1),-1!==o.indexOf(i)&&o.splice(o.indexOf(i),1))}return{asset_types:r,fee_asset_types:o=o.filter(function(e){return function(e){return void 0===t[e]||t[e]&&t[e].hasPoolBalance}(e)&&function(e){return void 0===t[e]||t[e]&&t[e].hasBalance}(e)})}}},{key:"render",value:function(){var e=null,t=this.state,n=t.propose,r=t.from_account,o=t.to_account,c=t.asset,l=t.asset_id,d=t.propose_account,b=t.feeAmount,v=t.amount,y=t.error,w=t.to_name,A=t.from_name,x=t.memo,O=t.feeAsset,C=t.fee_asset_id,j=t.balanceError,N=h.a.isMyAccount(r)||A===this.props.passwordAccount;!r||N||n||(e=s.a.createElement("span",null,g.a.translate("account.errors.not_yours")," (",s.a.createElement("a",{onClick:this.onPropose.bind(this,!0)},g.a.translate("propose")),")"));var F=this._getAvailableAssets(),I=F.asset_types,T=F.fee_asset_types,H=null,P=this.state.feeAmount.getAmount({real:!0});if(r&&r.get("balances")&&!e){var R=r.get("balances").toJS();if(1===I.length&&(c=k.b.getAsset(I[0])),I.length>0){var B=c?c.get("id"):I[0],D=O?O.get("id"):"1.3.0";H=s.a.createElement("span",{style:{borderBottom:"#A09F9F 1px dotted",cursor:"pointer"},onClick:this._setTotal.bind(this,B,R[B],P,D)},s.a.createElement(u.a,{component:"span",content:"transfer.available"}),":"," ",s.a.createElement(i.a,{balance:R[B]}))}else H="No funds"}var L=n&&!d,M=parseFloat(String.prototype.replace.call(v,/,/g,"")),U=M&&!Object(a.a)(M),q=o&&o.get("name")===w,J=!r||!q||!U||!c||e||L||j,V=E.a.Set();V=V.add(r);var $=1;return s.a.createElement("div",{className:"grid-block vertical"},s.a.createElement("div",{className:"grid-block shrink vertical medium-horizontal",style:{paddingTop:"2rem"}},s.a.createElement("form",{style:{paddingBottom:20,overflow:"visible"},className:"grid-content small-12 medium-6 large-5 large-offset-1 full-width-content",onSubmit:this.onSubmit.bind(this),noValidate:!0},s.a.createElement(u.a,{content:"transfer.header",component:"h2"}),s.a.createElement("div",{className:"content-block"},s.a.createElement(f.a,{label:"transfer.from",ref:"from",accountName:A,onChange:this.fromChanged.bind(this),onAccountChanged:this.onFromAccountChanged.bind(this),account:r,size:60,error:e,typeahead:!0,tabIndex:$++})),s.a.createElement("div",{className:"content-block"},s.a.createElement(f.a,{label:"transfer.to",ref:"to",accountName:w,onChange:this.toChanged.bind(this),onAccountChanged:this.onToAccountChanged.bind(this),account:o,size:60,tabIndex:$++,typeahead:!0})),s.a.createElement("div",{className:"content-block transfer-input"},s.a.createElement(p.a,{label:"transfer.amount",amount:v,onChange:this.onAmountChanged.bind(this),asset:I.length>0&&c?c.get("id"):l||I[0],assets:I,display_balance:H,tabIndex:$++}),this.state.balanceError?s.a.createElement("p",{className:"has-error no-margin",style:{paddingTop:10}},s.a.createElement(u.a,{content:"transfer.errors.insufficient"})):null),s.a.createElement("div",{className:"content-block transfer-input"},x&&x.length?s.a.createElement("label",{className:"right-label"},x.length):null,s.a.createElement(u.a,{className:"left-label tooltip",component:"label",content:"transfer.memo","data-place":"top","data-tip":g.a.translate("tooltip.memo_tip")}),s.a.createElement("textarea",{style:{marginBottom:0},rows:"3",value:x,tabIndex:$++,onChange:this.onMemoChanged.bind(this)}),this.state.propose?s.a.createElement("div",{className:"error-area",style:{position:"absolute"}},s.a.createElement(u.a,{content:"transfer.warn_name_unable_read_memo",name:this.state.from_name})):null),s.a.createElement("div",{className:"content-block transfer-input fee-row"+(this.state.propose?" proposal":"")},s.a.createElement(p.a,{refCallback:this.setNestedRef.bind(this),label:"transfer.fee",disabled:!0,amount:P,onChange:this.onFeeChanged.bind(this),asset:T.length&&b?b.asset_id:1===T.length?T[0]:C||T[0],assets:T,tabIndex:$++,error:!1===this.state.hasPoolBalance?"transfer.errors.insufficient":null}),n?s.a.createElement("button",{className:S()("button float-right no-margin",{disabled:J}),type:"submit",value:"Submit",tabIndex:$++},s.a.createElement(u.a,{component:"span",content:"propose"})):s.a.createElement("button",{className:S()("button float-right no-margin",{disabled:J}),type:"submit",value:"Submit",tabIndex:$++},s.a.createElement(u.a,{component:"span",content:"transfer.send"}))),n?s.a.createElement("div",{className:"full-width-content form-group transfer-input"},s.a.createElement("label",{className:"left-label"},s.a.createElement(u.a,{content:"account.propose_from"})),s.a.createElement(m.a,{account_names:h.a.getMyAccounts(),onChange:this.onProposeAccount.bind(this),tabIndex:$++})):null,y?s.a.createElement("div",{className:"content-block has-error"},y):null,s.a.createElement("div",null,n?s.a.createElement("span",null,s.a.createElement("button",{className:" button",onClick:this.onPropose.bind(this,!1),tabIndex:$++},s.a.createElement(u.a,{component:"span",content:"cancel"}))):null)),s.a.createElement("div",{className:"grid-content small-12 medium-6 large-4 large-offset-1 right-column"},s.a.createElement("div",{className:"grid-content no-padding"},s.a.createElement(_.a,{accountsList:V,limit:25,compactView:!0,filter:"transfer",fullHeight:!0}))),s.a.createElement("div",{className:"grid-content medium-6 large-4"})))}}],[{key:"getInitialState",value:function(){return{from_name:"",to_name:"",from_account:null,to_account:null,amount:"",asset_id:null,asset:null,memo:"",error:null,propose:!1,propose_account:"",feeAsset:null,fee_asset_id:"1.3.0",feeAmount:new O.a({amount:0}),feeStatus:{}}}}]),n}();t.default=Object(w.connect)(F,{listenTo:function(){return[h.a]},getProps:function(){return{currentAccount:h.a.getState().currentAccount,passwordAccount:h.a.getState().passwordAccount,contactsList:h.a.getState().accountContacts}}})}.call(this,n(106).Buffer)}}]);